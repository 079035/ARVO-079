# -*- coding: utf-8 -*-
"""Untitled2.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1QNQTaLl0715VMaimEu6W207-yQpgHfpc
"""

meta = {'envoy': 15, 'serenity': 45, 'php-src': 40, 'selinux': 36, 'imagemagick': 265, 'libraw': 47, 'c-blosc2': 70, 'ghostpdl': 134, 'h2o': 5, 'lcms': 38, 'fluent-bit': 46, 'openthread': 61, 'duckdb': 9, 'gpac': 7, 'freetype2': 14, 'swift-nio': 1, 'htslib': 8, 'hunspell': 35, 'libexif': 11, 'harfbuzz': 139, 'binutils-gdb': 97, 'grok': 22, 'lwan': 17, 'wireshark': 71, 'flatbuffers': 10, 'libreoffice': 38, 'freeradius-server': 7, 'sleuthkit': 7, 'ndpi': 128, 'c-ares': 8, 'libavc': 28, 'pcl': 25, 'libxml2': 64, 'openh264': 49, 'irssi': 3, 'aom': 18, 'unrar': 20, 'tint': 6, 'libpcap': 34, 'tmux': 1, 'yara': 31, 'unicorn': 17, 'wolfssl': 25, 'libjpeg-turbo.dev': 3, 'vlc': 5, 'libhevc': 17, 'wolfmqtt': 35, 'elfutils': 10, 'matio': 14, 'samba': 4, 'libwebp': 1, 'net-snmp': 13, 'libdwarf': 21, 'openssl': 7, 'resiprocate': 1, 'tinygltf': 4, 'libgit2': 11, 'wasm3': 39, 'ffmpeg': 58, 'pcre2': 2, 'radare2': 25, 'ots': 4, 'botan': 3, 'librawspeed': 57, 'libmpeg2': 6, 'systemd': 5, 'libspng': 6, 'coturn': 1, 'libredwg': 15, 'oniguruma': 11, 'capstonenext': 25, 'opensc': 73, 'flac': 14, 'openvswitch': 24, 'adhd': 9, 'libbpf': 3, 'openexr': 14, 'libzmq': 5, 'md4c': 4, 'bitcoin-core': 5, 'expat': 4, 'c-blosc': 3, 'binutils-preconditions': 6, 'simdjson': 7, 'usrsctp': 9, 'opus': 2, 'open62541': 15, 'icu': 5, 'zstd': 12, 'h3': 4, 'scapy': 2, 'curl': 16, 'mosquitto': 6, 'hermes': 2, 'leptonica': 2, 'swift-protobuf': 9, 'arrow': 13, 'bloaty': 3, 'libsrtp': 1, 'libhtp': 5, 'assimp': 35, 'lua': 4, 'hdf5': 7, 'hostap': 12, 'kamailio': 8, 'file': 23, 'ntopng': 2, 'espeak-ng': 14, 'MapServer': 6, 'libtpms': 1, 'upb': 3, 'gdbm': 1, 'perfetto': 11, 'libcoap': 4, 'mongoose': 6, 'libxslt': 19, 'libplist': 10, 'moddable': 6, 'libzip': 1, 'libarchive': 21, 'trafficserver': 2, 'mruby': 2, 'mdbtools': 8, 'draco': 8, 'libucl': 9, 'opensips': 8, 'tidy-html5': 1, 'readstat': 6, 'libheif': 8, 'exiv2': 7, 'tpm2': 3, 'janus-gateway': 1, 'e2fsprogs': 1, 'boringssl': 5, 'qpid-proton': 2, 'faad2': 6, 'krb5': 5, 'gstreamer': 2, 'grpc': 2, 're2': 1, 'libsndfile': 10, 'miniz': 5, 'muparser': 6, 'libssh2': 3, 'haproxy': 3, 'sudo': 6, 'fmt': 4, 'wavpack': 4, 'hiredis': 1, 'kimageformats': 11, 'alembic': 3, 'llvm-project': 11, 'cyclonedds': 5, 'qpdf': 6, 'clamav': 1, 'libvpx': 4, 'hoextdown': 1, 'fwupd': 1, 'dnsmasq': 8, 'json-c': 1, 'open5gs': 1, 'nestegg': 1, 'jsoncons': 3, 'rdkit': 3, 'pygments': 4, 'lz4': 4, 'libjpeg-turbo': 4, 'cups': 1, 'libusb': 1, 'util-linux': 3, 'fribidi': 2, 'immer': 2, 'mbedtls': 1, 'geos': 2, 'ada-url': 1, 'tcmalloc': 2, 'arduinojson': 1, 'wpantund': 2, 'Simd': 1, 'json': 2, 'python-library-fuzzers': 3, 'jsoncpp': 2, 'relic': 3, 'openjpeg': 2, 'p11-kit': 3, 'glog': 3, 'pjsip': 4, 'lxc': 7, 'astc-encoder': 1, 'tinyxml2': 1, 'librabbitmq': 1, 'gpsd': 1, 'capstonemaster': 1, 'opencv': 2, 'fio': 2, 'stb': 1, 'dawn': 1, 'libvips': 1, 'aac': 4, 'libass': 2, 'libgd': 1, 'libical': 1, 'node': 1, 'libsass': 4, 'libiec61850': 2, 'glib': 1, 'libwebsockets': 1, 'FreeRDP': 1, 'firebase-ios-sdk': 1, 'cryptofuzz': 1, 'qt': 1}
meta = dict(sorted(meta.items(), key=lambda item: item[1]))
total = sum(meta.values())
labels = []
sizes = []
keys = list(meta.keys())[-10:]
keys = keys[::-1]

for key in keys:
    labels.append(key)
    sizes.append(meta[key])
labels = labels + ["Other Projects"]
sizes  = sizes + [total-sum(sizes)]

distr = [size/sum(sizes) for size in sizes]

distributions = [round(num * 100, 2) for num in distr]

import pandas as pd
import matplotlib.pyplot as plt

data = {"Project": labels, "# Vulnerabilities": sizes, "% of Dataset": distributions}

df = pd.DataFrame(data)

fig, ax = plt.subplots()
ax.axis('off')

table = ax.table(cellText=df.values, colLabels=df.columns, cellLoc='center', loc='center', colColours=['#f5f5f5']*len(df.columns))


table.auto_set_font_size(False)
table.set_fontsize(10)
table.scale(1.2, 1.2)

plt.savefig("Distri_table.pdf", bbox_inches='tight')

plt.show()

labels = ['C++','C','Rust','Python','Swift','Others']
sizes = [171, 50,3, 2, 2, 3]

distr = [size/sum(sizes) for size in sizes]

distributions = [round(num * 100, 2) for num in distr]

import pandas as pd
import matplotlib.pyplot as plt


data = {"Language": labels, "# Vulnerabilities": sizes, "% of Dataset": distributions}


df = pd.DataFrame(data)

fig, ax = plt.subplots()
ax.axis('off')


table = ax.table(cellText=df.values, colLabels=df.columns, cellLoc='center', loc='center', colColours=['#f5f5f5']*len(df.columns))


table.auto_set_font_size(False)
table.set_fontsize(10)
table.scale(1.2, 1.2)

plt.savefig("Distri_language.pdf", bbox_inches='tight')

plt.show()