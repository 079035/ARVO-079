From 36c2d1dbbb3503614ed5e339ad365411535c6d24 Mon Sep 17 00:00:00 2001
From: Niels Baggesen <nba@users.sourceforge.net>
Date: Thu, 9 Mar 2023 15:15:14 +0100
Subject: [PATCH] Change "#if HAVE_XXX" into "#ifdef HAVE_XXX"

This fixes a bunch of -Wundef warnings.

[ bvanassche: changed patch subject / restored consistency of the MSVC config
  header files ]
---
 agent/agent_handler.c                         |   2 +-
 agent/agent_index.c                           |   6 +-
 agent/agent_read_config.c                     |  10 +-
 agent/agent_registry.c                        |   6 +-
 agent/agent_sysORTable.c                      |   4 +-
 agent/agent_trap.c                            |   8 +-
 agent/auto_nlist.c                            |   8 +-
 agent/helpers/cache_handler.c                 |   2 +-
 agent/helpers/instance.c                      |   2 +-
 agent/helpers/null.c                          |   2 +-
 agent/helpers/old_api.c                       |   8 +-
 agent/helpers/row_merge.c                     |   2 +-
 agent/helpers/scalar.c                        |   2 +-
 agent/helpers/scalar_group.c                  |   2 +-
 agent/helpers/table.c                         |   2 +-
 agent/helpers/table_array.c                   |   2 +-
 agent/helpers/table_container.c               |   2 +-
 agent/helpers/table_data.c                    |   2 +-
 agent/helpers/table_dataset.c                 |   2 +-
 agent/helpers/table_iterator.c                |   2 +-
 agent/helpers/table_row.c                     |   2 +-
 agent/helpers/table_tdata.c                   |   2 +-
 agent/kernel.c                                |  12 +-
 agent/mib_modules.c                           |   8 +-
 agent/mibgroup/Rmon/alarm.c                   |   6 +-
 agent/mibgroup/Rmon/event.c                   |   6 +-
 agent/mibgroup/Rmon/history.c                 |   6 +-
 agent/mibgroup/Rmon/statistics.c              |   4 +-
 agent/mibgroup/agentx/agentx_config.c         |   2 +-
 agent/mibgroup/agentx/client.c                |   8 +-
 agent/mibgroup/agentx/master.c                |   4 +-
 agent/mibgroup/agentx/master_admin.c          |   2 +-
 agent/mibgroup/agentx/protocol.c              |   8 +-
 agent/mibgroup/agentx/subagent.c              |   4 +-
 agent/mibgroup/deliver/deliverByNotify.h      |   2 +-
 .../disman/expression/expErrorTable.c         |   4 +-
 .../disman/expression/expExpressionTable.c    |   4 +-
 .../disman/expression/expObjectTable.c        |   4 +-
 .../disman/expression/expValueTable.c         |   4 +-
 agent/mibgroup/disman/mteObjectsTable.c       |   4 +-
 .../mibgroup/disman/mteTriggerBooleanTable.c  |   4 +-
 agent/mibgroup/disman/mteTriggerDeltaTable.c  |   4 +-
 .../disman/mteTriggerExistenceTable.c         |   4 +-
 agent/mibgroup/disman/mteTriggerTable.c       |   4 +-
 .../disman/mteTriggerThresholdTable.c         |   4 +-
 .../mibgroup/disman/nslookup/lookupCtlTable.c |   6 +-
 agent/mibgroup/disman/ping/pingCtlTable.c     |   6 +-
 .../disman/traceroute/traceRouteHopsTable.c   |   4 +-
 .../traceroute/traceRouteProbeHistoryTable.c  |   4 +-
 .../traceroute/traceRouteResultsTable.c       |   4 +-
 .../data_access/dot3stats_linux.c             |   2 +-
 .../dot3StatsTable_data_access.c              |   2 +-
 agent/mibgroup/examples/example.c             |   4 +-
 agent/mibgroup/examples/ucdDemoPublic.c       |   6 +-
 .../mibgroup/hardware/fsys/fsys_getfsstats.c  |   6 +-
 agent/mibgroup/hardware/fsys/fsys_mntctl.c    |   8 +-
 agent/mibgroup/hardware/fsys/fsys_mntent.c    |  12 +-
 .../mibgroup/hardware/memory/memory_darwin.c  |   4 +-
 .../mibgroup/hardware/memory/memory_freebsd.c |   2 +-
 agent/mibgroup/hardware/memory/memory_irix.c  |   6 +-
 .../mibgroup/hardware/memory/memory_netbsd.c  |   2 +-
 agent/mibgroup/header_complex.c               |   4 +-
 agent/mibgroup/host/data_access/swinst_rpm.c  |  10 +-
 agent/mibgroup/host/data_access/swrun_kinfo.c |   2 +-
 agent/mibgroup/host/hr_device.c               |   8 +-
 agent/mibgroup/host/hr_disk.c                 |  10 +-
 agent/mibgroup/host/hr_filesys.c              |  24 ++--
 agent/mibgroup/host/hr_network.c              |   2 +-
 agent/mibgroup/host/hr_other.c                |   2 +-
 agent/mibgroup/host/hr_partition.c            |   4 +-
 agent/mibgroup/host/hr_print.c                |   2 +-
 agent/mibgroup/host/hr_proc.c                 |   4 +-
 agent/mibgroup/host/hr_storage.c              |  58 ++++-----
 agent/mibgroup/host/hr_swinst.c               |  16 +--
 agent/mibgroup/host/hr_swrun.c                |  64 +++++-----
 agent/mibgroup/host/hr_system.c               |  20 +--
 agent/mibgroup/host/hrh_filesys.c             |   4 +-
 agent/mibgroup/host/hrh_storage.c             |  12 +-
 .../if-mib/data_access/interface_linux.c      |   2 +-
 .../if-mib/data_access/interface_openbsd.c    |   2 +-
 .../if-mib/data_access/interface_sysctl.c     |   2 +-
 .../ip-forward-mib/data_access/route_ioctl.c  |  22 ++--
 .../mibgroup/ip-mib/data_access/arp_netlink.c |   2 +-
 .../ip-mib/data_access/systemstats_sysctl.c   |   8 +-
 agent/mibgroup/mibII/data_access/at_hpux.c    |  28 ++---
 agent/mibgroup/mibII/data_access/at_sysctl.c  |  12 +-
 agent/mibgroup/mibII/data_access/at_unix.c    |   2 +-
 agent/mibgroup/mibII/interfaces.c             | 118 +++++++++---------
 agent/mibgroup/mibII/ip.c                     |  20 +--
 agent/mibgroup/mibII/ipAddr.c                 |   8 +-
 agent/mibgroup/mibII/ipv6.c                   |   4 +-
 agent/mibgroup/mibII/kernel_linux.c           |   4 +-
 agent/mibgroup/mibII/mibII_common.h           |   8 +-
 agent/mibgroup/mibII/mta_sendmail.c           |   6 +-
 agent/mibgroup/mibII/route_headers.h          |  12 +-
 agent/mibgroup/mibII/route_write.c            |  10 +-
 agent/mibgroup/mibII/system_mib.c             |   6 +-
 agent/mibgroup/mibII/tcp.c                    |   4 +-
 agent/mibgroup/mibII/tcpTable.c               |   2 +-
 agent/mibgroup/mibII/udp.c                    |   6 +-
 agent/mibgroup/mibII/vacm_conf.c              |   8 +-
 agent/mibgroup/mibII/vacm_context.c           |   2 +-
 agent/mibgroup/mibII/vacm_vars.c              |  10 +-
 agent/mibgroup/mibII/var_route.c              |  28 ++---
 agent/mibgroup/mibincl.h                      |   6 +-
 agent/mibgroup/misc/ipfwacc.c                 |   2 +-
 .../snmpNotifyFilterProfileTable.c            |   4 +-
 .../snmpNotifyFilterProfileTable_data.c       |   4 +-
 agent/mibgroup/notification/snmpNotifyTable.c |   4 +-
 .../notification/snmpNotifyTable_data.c       |   4 +-
 .../rmon-mib/data_access/etherstats_linux.c   |   2 +-
 .../etherStatsTable_data_access.c             |   2 +-
 agent/mibgroup/smux/smux.c                    |   8 +-
 agent/mibgroup/smux/snmp_bgp.c                |  14 +--
 agent/mibgroup/smux/snmp_ospf.c               |  14 +--
 agent/mibgroup/smux/snmp_rip2.c               |  14 +--
 agent/mibgroup/snmpv3/usmUser.c               |   2 +-
 agent/mibgroup/target/snmpTargetAddrEntry.c   |   2 +-
 .../target/snmpTargetAddrEntry_data.c         |   2 +-
 agent/mibgroup/target/snmpTargetParamsEntry.c |   2 +-
 .../target/snmpTargetParamsEntry_data.c       |   2 +-
 agent/mibgroup/target/target.c                |   2 +-
 agent/mibgroup/target/target_counters.c       |   2 +-
 .../tcp-mib/data_access/tcpConn_freebsd4.c    |   8 +-
 .../tcp-mib/data_access/tcpConn_netbsd.c      |   8 +-
 .../tcp-mib/data_access/tcpConn_openbsd.c     |  12 +-
 agent/mibgroup/testhandler.c                  |   2 +-
 agent/mibgroup/ucd-snmp/disk_hw.c             |  12 +-
 agent/mibgroup/ucd-snmp/diskio.c              |  24 ++--
 agent/mibgroup/ucd-snmp/dlmod.c               |   4 +-
 agent/mibgroup/ucd-snmp/errormib.c            |  20 +--
 agent/mibgroup/ucd-snmp/extensible.c          |  18 +--
 agent/mibgroup/ucd-snmp/file.c                |   6 +-
 agent/mibgroup/ucd-snmp/hpux.c                |   6 +-
 agent/mibgroup/ucd-snmp/loadave.c             |  18 +--
 agent/mibgroup/ucd-snmp/memory_aix4.c         |   4 +-
 agent/mibgroup/ucd-snmp/memory_darwin7.c      |   6 +-
 agent/mibgroup/ucd-snmp/memory_freebsd2.c     |   4 +-
 agent/mibgroup/ucd-snmp/memory_hpux.c         |   4 +-
 agent/mibgroup/ucd-snmp/memory_netbsd1.c      |   2 +-
 agent/mibgroup/ucd-snmp/memory_solaris2.c     |   4 +-
 agent/mibgroup/ucd-snmp/pass.c                |   6 +-
 agent/mibgroup/ucd-snmp/pass_common.c         |   2 +-
 agent/mibgroup/ucd-snmp/pass_persist.c        |   6 +-
 agent/mibgroup/ucd-snmp/proc.c                |  10 +-
 agent/mibgroup/ucd-snmp/proxy.c               |   4 +-
 agent/mibgroup/ucd-snmp/versioninfo.c         |   4 +-
 agent/mibgroup/ucd-snmp/vmstat_bsdi4.c        |   4 +-
 agent/mibgroup/ucd-snmp/vmstat_darwin7.c      |   6 +-
 agent/mibgroup/ucd-snmp/vmstat_freebsd2.c     |   6 +-
 agent/mibgroup/ucd-snmp/vmstat_linux.c        |  44 +++----
 agent/mibgroup/ucd-snmp/vmstat_netbsd1.c      |   4 +-
 .../data_access/udp_endpoint_freebsd4.c       |   4 +-
 .../udp-mib/data_access/udp_endpoint_netbsd.c |   4 +-
 .../data_access/udp_endpoint_openbsd.c        |   8 +-
 agent/mibgroup/util_funcs.c                   |  16 +--
 agent/mibgroup/util_funcs/Exit.c              |   2 +-
 .../mibgroup/util_funcs/get_pid_from_inode.h  |   2 +-
 agent/mibgroup/util_funcs/restart.c           |   8 +-
 agent/mibgroup/utilities/execute.c            |  10 +-
 agent/netsnmp_close_fds.c                     |   4 +-
 agent/snmp_agent.c                            |   6 +-
 agent/snmp_vars.c                             |   8 +-
 agent/snmpd.c                                 |  26 ++--
 apps/encode_keychange.c                       |   4 +-
 apps/snmpbulkget.c                            |   8 +-
 apps/snmpbulkwalk.c                           |   8 +-
 apps/snmpdelta.c                              |   8 +-
 apps/snmpdf.c                                 |   8 +-
 apps/snmpget.c                                |   8 +-
 apps/snmpgetnext.c                            |   8 +-
 apps/snmpnetstat/if.c                         |   2 +-
 apps/snmpnetstat/inet.c                       |   2 +-
 apps/snmpnetstat/inet6.c                      |   4 +-
 apps/snmpnetstat/inetx.c                      |   4 +-
 apps/snmpnetstat/main.c                       |   2 +-
 apps/snmpnetstat/route.c                      |   4 +-
 apps/snmpnetstat/routex.c                     |   4 +-
 apps/snmpnetstat/winstub.c                    |   4 +-
 apps/snmpping.c                               |   2 +-
 apps/snmpps.c                                 |   4 +-
 apps/snmpset.c                                |   8 +-
 apps/snmpstatus.c                             |   8 +-
 apps/snmptable.c                              |   8 +-
 apps/snmptest.c                               |   8 +-
 apps/snmptls.c                                |   2 +-
 apps/snmptranslate.c                          |   6 +-
 apps/snmptrap.c                               |   8 +-
 apps/snmptrapd.c                              |  32 ++---
 apps/snmptrapd_auth.c                         |   2 +-
 apps/snmptrapd_handlers.c                     |   6 +-
 apps/snmptrapd_log.c                          |  10 +-
 apps/snmptrapd_sql.c                          |  14 +--
 apps/snmpusm.c                                |   8 +-
 apps/snmpvacm.c                               |   8 +-
 apps/snmpwalk.c                               |   8 +-
 apps/sshtosnmp.c                              |   2 +-
 configure.d/config_os_headers                 |  70 +++++------
 configure.d/config_os_misc4                   |  14 +--
 configure.d/config_os_struct_members          |  52 ++++----
 include/net-snmp/library/libsnmp.h            |  16 +--
 include/net-snmp/library/snmpAAL5PVCDomain.h  |   2 +-
 include/net-snmp/library/snmpDTLSUDPDomain.h  |   2 +-
 include/net-snmp/library/snmpIPXDomain.h      |   2 +-
 include/net-snmp/library/snmpSSHDomain.h      |   2 +-
 include/net-snmp/library/snmpTLSTCPDomain.h   |   2 +-
 .../net-snmp/library/snmpUDPsharedDomain.h    |   4 +-
 include/net-snmp/library/snmpUnixDomain.h     |   4 +-
 include/net-snmp/library/snmp_alarm.h         |   2 +-
 include/net-snmp/net-snmp-includes.h          |   2 +-
 include/net-snmp/system/dynix.h               |   2 +-
 include/net-snmp/utilities.h                  |   2 +-
 snmplib/asn1.c                                |   2 +-
 snmplib/callback.c                            |   6 +-
 snmplib/cert_util.c                           |   8 +-
 snmplib/container_binary_array.c              |   6 +-
 snmplib/container_iterator.c                  |   6 +-
 snmplib/container_list_ssll.c                 |   6 +-
 snmplib/container_null.c                      |   6 +-
 snmplib/default_store.c                       |   8 +-
 snmplib/dir_utils.c                           |  12 +-
 snmplib/file_utils.c                          |   8 +-
 snmplib/gettimeofday.c                        |   2 +-
 snmplib/inet_ntop.c                           |   2 +-
 snmplib/inet_pton.c                           |   2 +-
 snmplib/int64.c                               |   2 +-
 snmplib/keytools.c                            |  10 +-
 snmplib/lcd_time.c                            |   6 +-
 snmplib/md5.c                                 |   4 +-
 snmplib/mib.c                                 |  10 +-
 snmplib/parse.c                               |  14 +--
 snmplib/read_config.c                         |  12 +-
 snmplib/scapi.c                               |   8 +-
 snmplib/snmp-tc.c                             |   8 +-
 snmplib/snmp_alarm.c                          |   8 +-
 snmplib/snmp_api.c                            |  12 +-
 snmplib/snmp_auth.c                           |   8 +-
 snmplib/snmp_client.c                         |  10 +-
 snmplib/snmp_debug.c                          |   6 +-
 snmplib/snmp_enum.c                           |   2 +-
 snmplib/snmp_logging.c                        |  10 +-
 snmplib/snmp_parse_args.c                     |  10 +-
 snmplib/snmp_secmod.c                         |   6 +-
 snmplib/snmp_transport.c                      |  10 +-
 snmplib/snmpksm.c                             |   8 +-
 snmplib/snmpusm.c                             |   6 +-
 snmplib/snmpv3.c                              |   8 +-
 snmplib/snprintf.c                            |   2 +-
 snmplib/strlcat.c                             |   2 +-
 snmplib/strlcpy.c                             |   2 +-
 snmplib/strtol.c                              |   4 +-
 snmplib/strtoul.c                             |   4 +-
 snmplib/system.c                              |  26 ++--
 snmplib/text_utils.c                          |  10 +-
 snmplib/tools.c                               |   6 +-
 snmplib/transports/snmpAAL5PVCDomain.c        |   8 +-
 snmplib/transports/snmpAliasDomain.c          |   6 +-
 snmplib/transports/snmpCallbackDomain.c       |   8 +-
 snmplib/transports/snmpDTLSUDPDomain.c        |  16 +--
 snmplib/transports/snmpIPXDomain.c            |  10 +-
 snmplib/transports/snmpIPv4BaseDomain.c       |   4 +-
 snmplib/transports/snmpIPv6BaseDomain.c       |  12 +-
 snmplib/transports/snmpSSHDomain.c            |  16 +--
 snmplib/transports/snmpSTDDomain.c            |   6 +-
 snmplib/transports/snmpSocketBaseDomain.c     |   8 +-
 snmplib/transports/snmpTCPBaseDomain.c        |   6 +-
 snmplib/transports/snmpTCPDomain.c            |   6 +-
 snmplib/transports/snmpTCPIPv6Domain.c        |   8 +-
 snmplib/transports/snmpTLSBaseDomain.c        |  10 +-
 snmplib/transports/snmpTLSTCPDomain.c         |  18 +--
 snmplib/transports/snmpUDPBaseDomain.c        |   4 +-
 snmplib/transports/snmpUDPDomain.c            |   6 +-
 snmplib/transports/snmpUDPIPv4BaseDomain.c    |   4 +-
 snmplib/transports/snmpUDPIPv6Domain.c        |  14 +--
 snmplib/transports/snmpUDPsharedDomain.c      |  12 +-
 snmplib/transports/snmpUnixDomain.c           |   8 +-
 snmplib/vacm.c                                |   8 +-
 testing/fulltests/snmpv3/T010scapitest_capp.c |   2 +-
 .../fulltests/snmpv3/T040keymanagetest_capp.c |   2 +-
 testing/fulltests/snmpv3/T050etimetest_capp.c |   2 +-
 win32/mib_module_includes.h                   |   2 +-
 win32/net-snmp/agent/mib_module_config.h      |   2 +-
 win32/net-snmp/net-snmp-config.h              |   2 +-
 win32/net-snmp/net-snmp-config.h.in           |   2 +-
 284 files changed, 1110 insertions(+), 1110 deletions(-)

diff --git a/agent/agent_handler.c b/agent/agent_handler.c
index 769701fdfd..cba644a17e 100644
--- a/agent/agent_handler.c
+++ b/agent/agent_handler.c
@@ -18,7 +18,7 @@
 
 #include <sys/types.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
 
diff --git a/agent/agent_index.c b/agent/agent_index.c
index 7885bf1864..8444a79f0f 100644
--- a/agent/agent_index.c
+++ b/agent/agent_index.c
@@ -10,16 +10,16 @@
 #include <net-snmp/net-snmp-config.h>
 #include <net-snmp/net-snmp-features.h>
 #include <signal.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 #include <sys/types.h>
 #include <stdio.h>
 #include <fcntl.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/agent/agent_read_config.c b/agent/agent_read_config.c
index 5265c7b069..7fc8ea617f 100644
--- a/agent/agent_read_config.c
+++ b/agent/agent_read_config.c
@@ -10,15 +10,15 @@
 #include <net-snmp/net-snmp-config.h>
 #include <net-snmp/net-snmp-features.h>
 
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #else
 #include <sys/types.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -27,7 +27,7 @@
 #include <ctype.h>
 #include <errno.h>
 
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -88,7 +88,7 @@
 #include <inet/mib2.h>
 #endif
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #ifdef HAVE_PWD_H
diff --git a/agent/agent_registry.c b/agent/agent_registry.c
index cbd5460cd5..fc9d4087a9 100644
--- a/agent/agent_registry.c
+++ b/agent/agent_registry.c
@@ -30,16 +30,16 @@
 #include <net-snmp/net-snmp-features.h>
 
 #include <signal.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 #include <sys/types.h>
 #include <stdio.h>
 #include <fcntl.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/agent/agent_sysORTable.c b/agent/agent_sysORTable.c
index f6280609db..b11037a53d 100644
--- a/agent/agent_sysORTable.c
+++ b/agent/agent_sysORTable.c
@@ -1,8 +1,8 @@
 #include <net-snmp/net-snmp-config.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/agent_trap.c b/agent/agent_trap.c
index 6492234f01..6fe15d22dd 100644
--- a/agent/agent_trap.c
+++ b/agent/agent_trap.c
@@ -25,21 +25,21 @@
 #include <net-snmp/net-snmp-config.h>
 #include <net-snmp/net-snmp-features.h>
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #ifdef HAVE_NETDB_H
 #include <netdb.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/agent/auto_nlist.c b/agent/auto_nlist.c
index 2cdf3a85f9..42a98b9410 100644
--- a/agent/auto_nlist.c
+++ b/agent/auto_nlist.c
@@ -1,20 +1,20 @@
 #include <net-snmp/net-snmp-config.h>
 
 #ifdef NETSNMP_CAN_USE_NLIST
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 #include <stdio.h>
 #include <errno.h>
 #include <fcntl.h>
 #include <netinet/in.h>
-#if HAVE_KVM_H
+#ifdef HAVE_KVM_H
 #include <kvm.h>
 #elif defined(HAVE_NLIST_H)
 #include <nlist.h>
@@ -146,7 +146,7 @@ static void
 init_nlist(struct nlist nl[])
 {
     int             ret;
-#if HAVE_KVM_OPENFILES
+#ifdef HAVE_KVM_OPENFILES
     kvm_t          *kernel;
     char            kvm_errbuf[4096];
 
diff --git a/agent/helpers/cache_handler.c b/agent/helpers/cache_handler.c
index 2a3dab5d48..2c007a88da 100644
--- a/agent/helpers/cache_handler.c
+++ b/agent/helpers/cache_handler.c
@@ -16,7 +16,7 @@
 #include <net-snmp/net-snmp-config.h>
 #include <net-snmp/net-snmp-features.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/helpers/instance.c b/agent/helpers/instance.c
index 053dfdfba0..4afa723f88 100644
--- a/agent/helpers/instance.c
+++ b/agent/helpers/instance.c
@@ -22,7 +22,7 @@
 #include <net-snmp/agent/instance.h>
 
 #include <stdlib.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/helpers/null.c b/agent/helpers/null.c
index 879ad16e03..1b4b4552d0 100644
--- a/agent/helpers/null.c
+++ b/agent/helpers/null.c
@@ -15,7 +15,7 @@
 
 #include <net-snmp/agent/null.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/helpers/old_api.c b/agent/helpers/old_api.c
index 007f2bc757..6c0f02a1de 100644
--- a/agent/helpers/old_api.c
+++ b/agent/helpers/old_api.c
@@ -15,7 +15,7 @@
 
 #include <net-snmp/agent/old_api.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -270,7 +270,7 @@ netsnmp_old_api_helper(netsnmp_mib_handler *handler,
                        netsnmp_request_info *requests)
 {
 
-#if MIB_CLIENTS_ARE_EVIL
+#ifdef MIB_CLIENTS_ARE_EVIL
     oid             save[MAX_OID_LEN];
     size_t          savelen = 0;
 #endif
@@ -308,7 +308,7 @@ netsnmp_old_api_helper(netsnmp_mib_handler *handler,
 
     for (; requests; requests = requests->next) {
 
-#if MIB_CLIENTS_ARE_EVIL
+#ifdef MIB_CLIENTS_ARE_EVIL
         savelen = requests->requestvb->name_length;
         memcpy(save, requests->requestvb->name, savelen * sizeof(oid));
 #endif
@@ -361,7 +361,7 @@ netsnmp_old_api_helper(netsnmp_mib_handler *handler,
                 /*
                  * no result returned 
                  */
-#if MIB_CLIENTS_ARE_EVIL
+#ifdef MIB_CLIENTS_ARE_EVIL
                 if (access == NULL) {
                     if (netsnmp_oid_equals(requests->requestvb->name,
                                          requests->requestvb->name_length,
diff --git a/agent/helpers/row_merge.c b/agent/helpers/row_merge.c
index 2a4066ffd9..4b4641885b 100644
--- a/agent/helpers/row_merge.c
+++ b/agent/helpers/row_merge.c
@@ -19,7 +19,7 @@
 
 #include <stdint.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/helpers/scalar.c b/agent/helpers/scalar.c
index 63aeb379e3..1f197fc794 100644
--- a/agent/helpers/scalar.c
+++ b/agent/helpers/scalar.c
@@ -21,7 +21,7 @@
 #include <net-snmp/agent/scalar.h>
 
 #include <stdlib.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/helpers/scalar_group.c b/agent/helpers/scalar_group.c
index 6133c3c039..fc10f4be78 100644
--- a/agent/helpers/scalar_group.c
+++ b/agent/helpers/scalar_group.c
@@ -17,7 +17,7 @@
 #include <net-snmp/agent/scalar_group.h>
 
 #include <stdlib.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/helpers/table.c b/agent/helpers/table.c
index f357b84f7a..c9b11dd71a 100644
--- a/agent/helpers/table.c
+++ b/agent/helpers/table.c
@@ -36,7 +36,7 @@
 netsnmp_feature_require(oid_stash);
 #endif /* !NETSNMP_NO_WRITE_SUPPORT */
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/helpers/table_array.c b/agent/helpers/table_array.c
index b0a6e6f4e6..2c044e284a 100644
--- a/agent/helpers/table_array.c
+++ b/agent/helpers/table_array.c
@@ -20,7 +20,7 @@
 
 #include <net-snmp/agent/table_array.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/helpers/table_container.c b/agent/helpers/table_container.c
index 97b1489b27..edd67a8b6d 100644
--- a/agent/helpers/table_container.c
+++ b/agent/helpers/table_container.c
@@ -20,7 +20,7 @@
 
 #include <net-snmp/agent/table_container.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/helpers/table_data.c b/agent/helpers/table_data.c
index b3d7e88c33..19c7285407 100644
--- a/agent/helpers/table_data.c
+++ b/agent/helpers/table_data.c
@@ -17,7 +17,7 @@
 
 #include <net-snmp/agent/table_data.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/helpers/table_dataset.c b/agent/helpers/table_dataset.c
index 1020232173..7aef147a57 100644
--- a/agent/helpers/table_dataset.c
+++ b/agent/helpers/table_dataset.c
@@ -18,7 +18,7 @@
 
 #include <net-snmp/agent/table_dataset.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/helpers/table_iterator.c b/agent/helpers/table_iterator.c
index 79784296e0..c6a5a6eced 100644
--- a/agent/helpers/table_iterator.c
+++ b/agent/helpers/table_iterator.c
@@ -95,7 +95,7 @@
 
 #include <net-snmp/agent/table_iterator.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/helpers/table_row.c b/agent/helpers/table_row.c
index 8778ee0c09..b465750d5c 100644
--- a/agent/helpers/table_row.c
+++ b/agent/helpers/table_row.c
@@ -17,7 +17,7 @@
 #include <net-snmp/net-snmp-config.h>
 #include <net-snmp/net-snmp-features.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/helpers/table_tdata.c b/agent/helpers/table_tdata.c
index e87a3c9f7b..8677967cd6 100644
--- a/agent/helpers/table_tdata.c
+++ b/agent/helpers/table_tdata.c
@@ -17,7 +17,7 @@
 
 #include <net-snmp/agent/table_tdata.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/kernel.c b/agent/kernel.c
index 66037306bc..9a6d22592c 100644
--- a/agent/kernel.c
+++ b/agent/kernel.c
@@ -18,18 +18,18 @@
 #include <net-snmp/net-snmp-config.h>
 
 #include <sys/types.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include <stdio.h>
 #include <errno.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
-#if HAVE_FCNTL_H
+#ifdef HAVE_FCNTL_H
 #include <fcntl.h>
 #endif
 #ifdef HAVE_NETINET_IN_H
@@ -57,7 +57,7 @@ init_kmem(const char *file)
 {
     int res = TRUE;
 
-#if HAVE_KVM_OPENFILES
+#ifdef HAVE_KVM_OPENFILES
     char            err[4096];
 
     kd = kvm_openfiles(NULL, NULL, NULL, O_RDONLY, err);
@@ -105,7 +105,7 @@ klookup(unsigned long off, void *target, size_t siz)
         return 0;
     result = kvm_read(kd, off, target, siz);
     if (result != siz) {
-#if HAVE_KVM_OPENFILES
+#ifdef HAVE_KVM_OPENFILES
         snmp_log(LOG_ERR, "kvm_read(*, %lx, %p, %x) = %d: %s\n", off,
                  target, (unsigned) siz, result, kvm_geterr(kd));
 #else
diff --git a/agent/mib_modules.c b/agent/mib_modules.c
index 095262e9a4..061d2b1046 100644
--- a/agent/mib_modules.c
+++ b/agent/mib_modules.c
@@ -4,19 +4,19 @@
 
 #include <net-snmp/agent/mib_module_config.h>
 #include <net-snmp/net-snmp-config.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include <sys/types.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/agent/mibgroup/Rmon/alarm.c b/agent/mibgroup/Rmon/alarm.c
index f5ef4ccc49..97763ae8c7 100644
--- a/agent/mibgroup/Rmon/alarm.c
+++ b/agent/mibgroup/Rmon/alarm.c
@@ -20,13 +20,13 @@
 
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/agent/mibgroup/Rmon/event.c b/agent/mibgroup/Rmon/event.c
index bd76eb810c..5fbb01fa3a 100644
--- a/agent/mibgroup/Rmon/event.c
+++ b/agent/mibgroup/Rmon/event.c
@@ -21,10 +21,10 @@
 #include <net-snmp/net-snmp-config.h>
 #include <net-snmp/net-snmp-features.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -34,7 +34,7 @@
 #  include <time.h>
 # endif
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include <ctype.h>
diff --git a/agent/mibgroup/Rmon/history.c b/agent/mibgroup/Rmon/history.c
index 16bdf59e7d..cee8c2a711 100644
--- a/agent/mibgroup/Rmon/history.c
+++ b/agent/mibgroup/Rmon/history.c
@@ -20,10 +20,10 @@
 
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -33,7 +33,7 @@
 #  include <time.h>
 # endif
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/agent/mibgroup/Rmon/statistics.c b/agent/mibgroup/Rmon/statistics.c
index 8d89ae177d..bb2bcece51 100644
--- a/agent/mibgroup/Rmon/statistics.c
+++ b/agent/mibgroup/Rmon/statistics.c
@@ -23,7 +23,7 @@
 #ifdef HAVE_STDLIB
 #include <stdlib.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -33,7 +33,7 @@
 #  include <time.h>
 # endif
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/agent/mibgroup/agentx/agentx_config.c b/agent/mibgroup/agentx/agentx_config.c
index b39443cdae..4d5f02373b 100644
--- a/agent/mibgroup/agentx/agentx_config.c
+++ b/agent/mibgroup/agentx/agentx_config.c
@@ -9,7 +9,7 @@
 #ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/agentx/client.c b/agent/mibgroup/agentx/client.c
index 03ebfad980..a50638faf9 100644
--- a/agent/mibgroup/agentx/client.c
+++ b/agent/mibgroup/agentx/client.c
@@ -7,19 +7,19 @@
 
 #include <stdio.h>
 #include <errno.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include <sys/types.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/agent/mibgroup/agentx/master.c b/agent/mibgroup/agentx/master.c
index 995f701f75..ed7ecd1530 100644
--- a/agent/mibgroup/agentx/master.c
+++ b/agent/mibgroup/agentx/master.c
@@ -24,7 +24,7 @@
 #ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -37,7 +37,7 @@
 #endif
 #include <errno.h>
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #ifdef HAVE_SYS_STAT_H
diff --git a/agent/mibgroup/agentx/master_admin.c b/agent/mibgroup/agentx/master_admin.c
index b46ae71e0e..5392604d0a 100644
--- a/agent/mibgroup/agentx/master_admin.c
+++ b/agent/mibgroup/agentx/master_admin.c
@@ -13,7 +13,7 @@
 #ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/agent/mibgroup/agentx/protocol.c b/agent/mibgroup/agentx/protocol.c
index 9ce7b70f49..53491a4948 100644
--- a/agent/mibgroup/agentx/protocol.c
+++ b/agent/mibgroup/agentx/protocol.c
@@ -14,19 +14,19 @@
 #include <limits.h>
 #include <stdio.h>
 #include <errno.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include <sys/types.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/agent/mibgroup/agentx/subagent.c b/agent/mibgroup/agentx/subagent.c
index b945ab122c..1dd1cd654b 100644
--- a/agent/mibgroup/agentx/subagent.c
+++ b/agent/mibgroup/agentx/subagent.c
@@ -8,7 +8,7 @@
 #ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -21,7 +21,7 @@
 #ifdef HAVE_SYS_SOCKET_H
 #include <sys/socket.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/deliver/deliverByNotify.h b/agent/mibgroup/deliver/deliverByNotify.h
index 292c366e2f..b243cafa5a 100644
--- a/agent/mibgroup/deliver/deliverByNotify.h
+++ b/agent/mibgroup/deliver/deliverByNotify.h
@@ -1,7 +1,7 @@
 #ifndef DELIVERBYNOTIFY_H
 #define DELIVERBYNOTIFY_H 1
 
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/agent/mibgroup/disman/expression/expErrorTable.c b/agent/mibgroup/disman/expression/expErrorTable.c
index 5ef1ef684d..0231d64787 100644
--- a/agent/mibgroup/disman/expression/expErrorTable.c
+++ b/agent/mibgroup/disman/expression/expErrorTable.c
@@ -22,10 +22,10 @@
  * This should always be included first before anything else 
  */
 #include <net-snmp/net-snmp-config.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/disman/expression/expExpressionTable.c b/agent/mibgroup/disman/expression/expExpressionTable.c
index e8669b2ba5..b7dde9cb00 100644
--- a/agent/mibgroup/disman/expression/expExpressionTable.c
+++ b/agent/mibgroup/disman/expression/expExpressionTable.c
@@ -22,10 +22,10 @@
  */
 #include <net-snmp/net-snmp-config.h>
 #include <net-snmp/net-snmp-features.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/disman/expression/expObjectTable.c b/agent/mibgroup/disman/expression/expObjectTable.c
index c1b93e32b8..d9dead8ba5 100644
--- a/agent/mibgroup/disman/expression/expObjectTable.c
+++ b/agent/mibgroup/disman/expression/expObjectTable.c
@@ -23,10 +23,10 @@
  */
 #include <net-snmp/net-snmp-config.h>
 #include <net-snmp/net-snmp-features.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/disman/expression/expValueTable.c b/agent/mibgroup/disman/expression/expValueTable.c
index 2463bd4b34..1228a5f1cb 100644
--- a/agent/mibgroup/disman/expression/expValueTable.c
+++ b/agent/mibgroup/disman/expression/expValueTable.c
@@ -23,13 +23,13 @@
  */
 #include <net-snmp/net-snmp-config.h>
 #include <ctype.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 
 #include <stdio.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/disman/mteObjectsTable.c b/agent/mibgroup/disman/mteObjectsTable.c
index 79d0e3016e..945aaf23bd 100644
--- a/agent/mibgroup/disman/mteObjectsTable.c
+++ b/agent/mibgroup/disman/mteObjectsTable.c
@@ -9,10 +9,10 @@
  */
 #include <net-snmp/net-snmp-config.h>
 #include <net-snmp/net-snmp-features.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/disman/mteTriggerBooleanTable.c b/agent/mibgroup/disman/mteTriggerBooleanTable.c
index fccc7adfe4..732a279a31 100644
--- a/agent/mibgroup/disman/mteTriggerBooleanTable.c
+++ b/agent/mibgroup/disman/mteTriggerBooleanTable.c
@@ -8,10 +8,10 @@
  * This should always be included first before anything else 
  */
 #include <net-snmp/net-snmp-config.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/disman/mteTriggerDeltaTable.c b/agent/mibgroup/disman/mteTriggerDeltaTable.c
index f5f2fe7014..c7bdd77c1b 100644
--- a/agent/mibgroup/disman/mteTriggerDeltaTable.c
+++ b/agent/mibgroup/disman/mteTriggerDeltaTable.c
@@ -8,10 +8,10 @@
  * This should always be included first before anything else 
  */
 #include <net-snmp/net-snmp-config.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/disman/mteTriggerExistenceTable.c b/agent/mibgroup/disman/mteTriggerExistenceTable.c
index 18b578c424..30ffac4e88 100644
--- a/agent/mibgroup/disman/mteTriggerExistenceTable.c
+++ b/agent/mibgroup/disman/mteTriggerExistenceTable.c
@@ -8,10 +8,10 @@
  * This should always be included first before anything else 
  */
 #include <net-snmp/net-snmp-config.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/disman/mteTriggerTable.c b/agent/mibgroup/disman/mteTriggerTable.c
index 6d088979d2..684cd6bfe0 100644
--- a/agent/mibgroup/disman/mteTriggerTable.c
+++ b/agent/mibgroup/disman/mteTriggerTable.c
@@ -9,10 +9,10 @@
  */
 #include <net-snmp/net-snmp-config.h>
 #include <net-snmp/net-snmp-features.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/disman/mteTriggerThresholdTable.c b/agent/mibgroup/disman/mteTriggerThresholdTable.c
index ca0efa9458..ed86300cb1 100644
--- a/agent/mibgroup/disman/mteTriggerThresholdTable.c
+++ b/agent/mibgroup/disman/mteTriggerThresholdTable.c
@@ -8,10 +8,10 @@
  * This should always be included first before anything else 
  */
 #include <net-snmp/net-snmp-config.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/disman/nslookup/lookupCtlTable.c b/agent/mibgroup/disman/nslookup/lookupCtlTable.c
index c58043769d..c05a783f78 100644
--- a/agent/mibgroup/disman/nslookup/lookupCtlTable.c
+++ b/agent/mibgroup/disman/nslookup/lookupCtlTable.c
@@ -579,7 +579,7 @@ run_lookup(struct lookupTable_data *item)
 
     else if (addressType == INETADDRESSTYPE_DNS) {
         struct hostent *lookup;
-#if HAVE_GETADDRINFO
+#ifdef HAVE_GETADDRINFO
         int             res;
         struct addrinfo *ais;
         struct addrinfo hints = { 0, AF_INET6, SOCK_DGRAM };
@@ -626,7 +626,7 @@ run_lookup(struct lookupTable_data *item)
             }
         }
 
-#if HAVE_GETADDRINFO
+#ifdef HAVE_GETADDRINFO
         netsnmp_get_monotonic_clock(&tpstart);
         res = netsnmp_getaddrinfo(address, NULL, &hints, &ais);
         netsnmp_get_monotonic_clock(&tpend);
@@ -676,7 +676,7 @@ run_lookup(struct lookupTable_data *item)
             }
             freeaddrinfo(ais);
         }
-#elif HAVE_GETHOSTBYNAME2
+#elif defined(HAVE_GETHOSTBYNAME2)
         netsnmp_get_monotonic_clock(&tpstart);
         lookup = gethostbyname2(address, AF_INET6);
         netsnmp_get_monotonic_clock(&tpend);
diff --git a/agent/mibgroup/disman/ping/pingCtlTable.c b/agent/mibgroup/disman/ping/pingCtlTable.c
index 9aada1d3d5..79373d91e7 100644
--- a/agent/mibgroup/disman/ping/pingCtlTable.c
+++ b/agent/mibgroup/disman/ping/pingCtlTable.c
@@ -21,10 +21,10 @@
 #include <net-snmp/net-snmp-includes.h>
 #include <net-snmp/agent/net-snmp-agent-includes.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -1128,7 +1128,7 @@ Host_serv(const char *host, const char *serv, int family, int socktype)
     hints.ai_socktype = socktype;       /* 0, SOCK_STREAM, SOCK_DGRAM, etc. */
 
     if ((n = netsnmp_getaddrinfo(host, serv, &hints, &res)) != 0) {
-#if HAVE_GAI_STRERROR
+#ifdef HAVE_GAI_STRERROR
         snmp_log(LOG_ERR, "host_serv error for %s, %s: %s",
                  (host == NULL) ? "(no hostname)" : host,
                  (serv == NULL) ? "(no service name)" : serv,
diff --git a/agent/mibgroup/disman/traceroute/traceRouteHopsTable.c b/agent/mibgroup/disman/traceroute/traceRouteHopsTable.c
index 19d9211fdf..b6e2d39831 100644
--- a/agent/mibgroup/disman/traceroute/traceRouteHopsTable.c
+++ b/agent/mibgroup/disman/traceroute/traceRouteHopsTable.c
@@ -12,10 +12,10 @@
  */
 
 #include <net-snmp/net-snmp-config.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/disman/traceroute/traceRouteProbeHistoryTable.c b/agent/mibgroup/disman/traceroute/traceRouteProbeHistoryTable.c
index 70107e94ef..489acfca5f 100644
--- a/agent/mibgroup/disman/traceroute/traceRouteProbeHistoryTable.c
+++ b/agent/mibgroup/disman/traceroute/traceRouteProbeHistoryTable.c
@@ -11,10 +11,10 @@
  *Date:2004.8.20
  */
 #include <net-snmp/net-snmp-config.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/disman/traceroute/traceRouteResultsTable.c b/agent/mibgroup/disman/traceroute/traceRouteResultsTable.c
index 78a11ed6fd..116623cea5 100644
--- a/agent/mibgroup/disman/traceroute/traceRouteResultsTable.c
+++ b/agent/mibgroup/disman/traceroute/traceRouteResultsTable.c
@@ -20,10 +20,10 @@
 #include <net-snmp/net-snmp-config.h>
 #include <net-snmp/net-snmp-features.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/etherlike-mib/data_access/dot3stats_linux.c b/agent/mibgroup/etherlike-mib/data_access/dot3stats_linux.c
index 03f5411f4a..ce02419f58 100644
--- a/agent/mibgroup/etherlike-mib/data_access/dot3stats_linux.c
+++ b/agent/mibgroup/etherlike-mib/data_access/dot3stats_linux.c
@@ -7,7 +7,7 @@
 #include <net-snmp/agent/net-snmp-agent-includes.h>
 #include <net-snmp/data_access/interface.h>
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/agent/mibgroup/etherlike-mib/dot3StatsTable/dot3StatsTable_data_access.c b/agent/mibgroup/etherlike-mib/dot3StatsTable/dot3StatsTable_data_access.c
index cb60f6bb04..5afce2b2c8 100644
--- a/agent/mibgroup/etherlike-mib/dot3StatsTable/dot3StatsTable_data_access.c
+++ b/agent/mibgroup/etherlike-mib/dot3StatsTable/dot3StatsTable_data_access.c
@@ -12,7 +12,7 @@
 #include <net-snmp/net-snmp-includes.h>
 #include <net-snmp/agent/net-snmp-agent-includes.h>
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/agent/mibgroup/examples/example.c b/agent/mibgroup/examples/example.c
index 8e4bb23f60..b4be6712cf 100644
--- a/agent/mibgroup/examples/example.c
+++ b/agent/mibgroup/examples/example.c
@@ -7,10 +7,10 @@
  * include important headers 
  */
 #include <net-snmp/net-snmp-config.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/examples/ucdDemoPublic.c b/agent/mibgroup/examples/ucdDemoPublic.c
index be11ad7972..90909712c5 100644
--- a/agent/mibgroup/examples/ucdDemoPublic.c
+++ b/agent/mibgroup/examples/ucdDemoPublic.c
@@ -3,16 +3,16 @@
  */
 
 #include <net-snmp/net-snmp-config.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
 
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/agent/mibgroup/hardware/fsys/fsys_getfsstats.c b/agent/mibgroup/hardware/fsys/fsys_getfsstats.c
index 7324a2227c..3f21f6b485 100644
--- a/agent/mibgroup/hardware/fsys/fsys_getfsstats.c
+++ b/agent/mibgroup/hardware/fsys/fsys_getfsstats.c
@@ -5,13 +5,13 @@
 #include "hardware/fsys/hw_fsys.h"
 #include "hardware/fsys/hw_fsys_private.h"
 
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
-#if HAVE_SYS_MOUNT_H
+#ifdef HAVE_SYS_MOUNT_H
 #include <sys/mount.h>
 #endif
-#if HAVE_SYS_STATVFS_H
+#ifdef HAVE_SYS_STATVFS_H
 #include <sys/statvfs.h>
 #endif
 
diff --git a/agent/mibgroup/hardware/fsys/fsys_mntctl.c b/agent/mibgroup/hardware/fsys/fsys_mntctl.c
index 782c8edd28..2267244d6b 100644
--- a/agent/mibgroup/hardware/fsys/fsys_mntctl.c
+++ b/agent/mibgroup/hardware/fsys/fsys_mntctl.c
@@ -4,16 +4,16 @@
 #include <net-snmp/agent/hardware/fsys.h>
 
 #include <stdio.h>
-#if HAVE_SYS_MNTCTL_H
+#ifdef HAVE_SYS_MNTCTL_H
 #include <sys/mntctl.h>
 #endif
-#if HAVE_SYS_VMOUNT_H
+#ifdef HAVE_SYS_VMOUNT_H
 #include <sys/vmount.h>
 #endif
-#if HAVE_SYS_STATFS_H
+#ifdef HAVE_SYS_STATFS_H
 #include <sys/statfs.h>
 #endif
-#if HAVE_SYS_STATVFS_H
+#ifdef HAVE_SYS_STATVFS_H
 #include <sys/statvfs.h>
 #endif
 
diff --git a/agent/mibgroup/hardware/fsys/fsys_mntent.c b/agent/mibgroup/hardware/fsys/fsys_mntent.c
index 0e5aa8f5c7..c6e6d43a6e 100644
--- a/agent/mibgroup/hardware/fsys/fsys_mntent.c
+++ b/agent/mibgroup/hardware/fsys/fsys_mntent.c
@@ -6,25 +6,25 @@
 #include "hardware/fsys/hw_fsys_private.h"
 
 #include <stdio.h>
-#if HAVE_MNTENT_H
+#ifdef HAVE_MNTENT_H
 #include <mntent.h>
 #endif
 #ifdef HAVE_SYS_MNTTAB_H
 #include <sys/mnttab.h>
 #endif
-#if HAVE_SYS_VFS_H
+#ifdef HAVE_SYS_VFS_H
 #include <sys/vfs.h>
 #endif
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
-#if HAVE_SYS_MOUNT_H
+#ifdef HAVE_SYS_MOUNT_H
 #include <sys/mount.h>
 #endif
-#if HAVE_SYS_STATFS_H
+#ifdef HAVE_SYS_STATFS_H
 #include <sys/statfs.h>
 #endif
-#if HAVE_SYS_STATVFS_H
+#ifdef HAVE_SYS_STATVFS_H
 #include <sys/statvfs.h>
 #endif
 
diff --git a/agent/mibgroup/hardware/memory/memory_darwin.c b/agent/mibgroup/hardware/memory/memory_darwin.c
index 7277f60f72..12e35e7d93 100644
--- a/agent/mibgroup/hardware/memory/memory_darwin.c
+++ b/agent/mibgroup/hardware/memory/memory_darwin.c
@@ -80,11 +80,11 @@ int pages_swapped(void) {
 
                 /* Get memory region. */
                 count = VM_REGION_EXTENDED_INFO_COUNT; 
-#if HAVE_VM_REGION_64
+#ifdef HAVE_VM_REGION_64
                 ret = vm_region_64(tasks[j], &address, &size,
                                  VM_REGION_EXTENDED_INFO, (void *)&info, &count,
                                  &object_name);
-#elif HAVE_VM_REGION
+#elif defined(HAVE_VM_REGION)
                 ret = vm_region(tasks[j], &address, &size,
                               VM_REGION_EXTENDED_INFO, (void *)&info, &count,
                               &object_name);
diff --git a/agent/mibgroup/hardware/memory/memory_freebsd.c b/agent/mibgroup/hardware/memory/memory_freebsd.c
index cdb0e69e7c..f5edff3a88 100644
--- a/agent/mibgroup/hardware/memory/memory_freebsd.c
+++ b/agent/mibgroup/hardware/memory/memory_freebsd.c
@@ -12,7 +12,7 @@
 #include <sys/vmmeter.h>
 #include <kvm.h>
 
-#if HAVE_SYS_VMPARAM_H
+#ifdef HAVE_SYS_VMPARAM_H
 #include <sys/vmparam.h>
 #else
 #include <vm/vm_param.h>
diff --git a/agent/mibgroup/hardware/memory/memory_irix.c b/agent/mibgroup/hardware/memory/memory_irix.c
index 377f007025..a396e00379 100644
--- a/agent/mibgroup/hardware/memory/memory_irix.c
+++ b/agent/mibgroup/hardware/memory/memory_irix.c
@@ -3,15 +3,15 @@
 #include <net-snmp/agent/net-snmp-agent-includes.h>
 #include <net-snmp/agent/hardware/memory.h>
 
-#if HAVE_SYS_SWAP_H
+#ifdef HAVE_SYS_SWAP_H
 #include <sys/swap.h>
 #endif
 
-#if HAVE_SYS_SYSGET_H
+#ifdef HAVE_SYS_SYSGET_H
 #include <sys/sysget.h>
 #endif
 
-#if HAVE_SYS_SYSMP_H
+#ifdef HAVE_SYS_SYSMP_H
 #include <sys/sysmp.h>
 #endif
 
diff --git a/agent/mibgroup/hardware/memory/memory_netbsd.c b/agent/mibgroup/hardware/memory/memory_netbsd.c
index 68cd209ce1..f6cb3f7621 100644
--- a/agent/mibgroup/hardware/memory/memory_netbsd.c
+++ b/agent/mibgroup/hardware/memory/memory_netbsd.c
@@ -6,7 +6,7 @@
 #include <unistd.h>
 #include <errno.h>
 #include <sys/sysctl.h>
-#if HAVE_SYS_VMMETER_H
+#ifdef HAVE_SYS_VMMETER_H
 #include <sys/vmmeter.h>
 #endif
 #include <sys/swap.h>
diff --git a/agent/mibgroup/header_complex.c b/agent/mibgroup/header_complex.c
index 539e914430..1e53b77dc3 100644
--- a/agent/mibgroup/header_complex.c
+++ b/agent/mibgroup/header_complex.c
@@ -5,10 +5,10 @@
 #include <net-snmp/net-snmp-config.h>
 
 #include <sys/types.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/host/data_access/swinst_rpm.c b/agent/mibgroup/host/data_access/swinst_rpm.c
index 695c469635..212530145a 100644
--- a/agent/mibgroup/host/data_access/swinst_rpm.c
+++ b/agent/mibgroup/host/data_access/swinst_rpm.c
@@ -97,7 +97,7 @@ netsnmp_swinst_arch_load( netsnmp_container *container, u_int flags)
 
     rpmdbMatchIterator    mi;
     Header                h;
-#if HAVE_HEADERGET
+#ifdef HAVE_HEADERGET
     const char           *g;
     rpmtd                 td_name, td_version, td_release, td_group, td_time;
 #else
@@ -109,7 +109,7 @@ netsnmp_swinst_arch_load( netsnmp_container *container, u_int flags)
     int                   i = 1;
     netsnmp_swinst_entry *entry;
 
-#if HAVE_HEADERGET
+#ifdef HAVE_HEADERGET
     td_name = rpmtdNew();
     td_version = rpmtdNew();
     td_release = rpmtdNew();
@@ -133,7 +133,7 @@ netsnmp_swinst_arch_load( netsnmp_container *container, u_int flags)
         CONTAINER_INSERT(container, entry);
 
         h = headerLink( h );
-#if HAVE_HEADERGET
+#ifdef HAVE_HEADERGET
         headerGet(h, RPMTAG_NAME, td_name, HEADERGET_EXT);
         headerGet(h, RPMTAG_VERSION, td_version, HEADERGET_EXT);
         headerGet(h, RPMTAG_RELEASE, td_release, HEADERGET_EXT);
@@ -171,7 +171,7 @@ netsnmp_swinst_arch_load( netsnmp_container *container, u_int flags)
             memcpy(entry->swDate, dt, entry->swDate_len);
         }
 
-#if HAVE_HEADERGET
+#ifdef HAVE_HEADERGET
         rpmtdFreeData(td_name);
         rpmtdFreeData(td_version);
         rpmtdFreeData(td_release);
@@ -182,7 +182,7 @@ netsnmp_swinst_arch_load( netsnmp_container *container, u_int flags)
     }
     rpmdbFreeIterator( mi );
     rpmtsFree( ts );
-#if HAVE_HEADERGET
+#ifdef HAVE_HEADERGET
     rpmtdFree(td_name);
     rpmtdFree(td_version);
     rpmtdFree(td_release);
diff --git a/agent/mibgroup/host/data_access/swrun_kinfo.c b/agent/mibgroup/host/data_access/swrun_kinfo.c
index 4061ebcba8..54d9727c23 100644
--- a/agent/mibgroup/host/data_access/swrun_kinfo.c
+++ b/agent/mibgroup/host/data_access/swrun_kinfo.c
@@ -221,7 +221,7 @@ netsnmp_arch_swrun_container_load( netsnmp_container *container, u_int flags)
          * We'll use SWRUN_K_COMM for hrSWRunName,
          *   and as an alternative for hrSWRunPath
          */
-#if HAVE_KVM_GETPROC2
+#ifdef HAVE_KVM_GETPROC2
         argv = kvm_getargv2( kd, &(proc_table[i]), 0);
 #else
         argv = kvm_getargv(  kd, &(proc_table[i]), BUFSIZ);
diff --git a/agent/mibgroup/host/hr_device.c b/agent/mibgroup/host/hr_device.c
index 24031bf954..ccb33e35eb 100644
--- a/agent/mibgroup/host/hr_device.c
+++ b/agent/mibgroup/host/hr_device.c
@@ -14,7 +14,7 @@
  */
 
 #include <net-snmp/net-snmp-config.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -252,7 +252,7 @@ var_hrdevice(struct variable *vp,
             (NULL!=(tmp_str=((*device_descr[type])(dev_idx))))) {
             strlcpy(string, tmp_str, sizeof(string));
         } else
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
             goto try_next;
 #else
             sprintf(string, "a black box of some sort");
@@ -271,7 +271,7 @@ var_hrdevice(struct variable *vp,
         if (device_status[type] != NULL)
             long_return = ((*device_status[type]) (dev_idx));
         else
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
             goto try_next;
 #else
             long_return = 2;    /* Assume running */
@@ -283,7 +283,7 @@ var_hrdevice(struct variable *vp,
         if (device_errors[type] != NULL)
             long_return = (*device_errors[type]) (dev_idx);
         else
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
             goto try_next;
 #else
             long_return = 0;    /* Assume OK */
diff --git a/agent/mibgroup/host/hr_disk.c b/agent/mibgroup/host/hr_disk.c
index d1f9112c7f..48a08863b0 100644
--- a/agent/mibgroup/host/hr_disk.c
+++ b/agent/mibgroup/host/hr_disk.c
@@ -16,20 +16,20 @@
 #include <net-snmp/net-snmp-config.h>
 #include "host_res.h"
 #include "hr_disk.h"
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
 
 #include <fcntl.h>
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #ifdef HAVE_KVM_H
 #include <kvm.h>
 #endif
-#if HAVE_DIRENT_H
+#ifdef HAVE_DIRENT_H
 #include <dirent.h>
 #else
 # define dirent direct
@@ -63,7 +63,7 @@
 #include <sys/disk.h>
 #endif
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -78,7 +78,7 @@
 #include <regex.h>
 #endif
 
-#if HAVE_LIMITS_H
+#ifdef HAVE_LIMITS_H
 #include <limits.h>
 #endif
 #ifdef HAVE_UNISTD_H
diff --git a/agent/mibgroup/host/hr_filesys.c b/agent/mibgroup/host/hr_filesys.c
index bde664e9d2..01e4896b73 100644
--- a/agent/mibgroup/host/hr_filesys.c
+++ b/agent/mibgroup/host/hr_filesys.c
@@ -24,19 +24,19 @@
 #include "hr_disk.h"
 #include <net-snmp/utilities.h>
 
-#if HAVE_MNTENT_H
+#ifdef HAVE_MNTENT_H
 #include <mntent.h>
 #endif
-#if HAVE_SYS_MNTENT_H
+#ifdef HAVE_SYS_MNTENT_H
 #include <sys/mntent.h>
 #endif
-#if HAVE_SYS_MNTTAB_H
+#ifdef HAVE_SYS_MNTTAB_H
 #include <sys/mnttab.h>
 #endif
-#if HAVE_SYS_STATVFS_H
+#ifdef HAVE_SYS_STATVFS_H
 #include <sys/statvfs.h>
 #endif
-#if HAVE_SYS_VFS_H
+#ifdef HAVE_SYS_VFS_H
 #include <sys/vfs.h>
 #endif
 #ifdef HAVE_SYS_PARAM_H
@@ -47,14 +47,14 @@
 #endif
 
 #include <ctype.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 
-#if HAVE_NBUTIL_H
+#ifdef HAVE_NBUTIL_H
 #include <nbutil.h>
 #endif
 
@@ -564,7 +564,7 @@ var_hrfilesys(struct variable *vp,
 #if defined(HAVE_STATVFS) && defined(__NetBSD__)
 	long_return = HRFS_entry->f_flag & MNT_RDONLY ? 2 : 1;
 #elif defined(HAVE_GETFSSTAT)
-#if HAVE_STRUCT_STATFS_F_FLAGS
+#ifdef HAVE_STRUCT_STATFS_F_FLAGS
         long_return = HRFS_entry->f_flags & MNT_RDONLY ? 2 : 1;
 #else
         long_return = HRFS_entry->f_flag & MNT_RDONLY ? 2 : 1;
@@ -574,7 +574,7 @@ var_hrfilesys(struct variable *vp,
 #elif defined(aix4) || defined(aix5) || defined(aix6) || defined(aix7)
         long_return = (HRFS_entry->HRFS_flags & MNT_READONLY) == 0 ? 1 : 2;
 #else
-#if HAVE_HASMNTOPT
+#ifdef HAVE_HASMNTOPT
         if (hasmntopt(HRFS_entry, "ro") != NULL)
             long_return = 2;    /* Read Only */
         else
@@ -618,7 +618,7 @@ static FILE    *fp;
 void
 Init_HR_FileSys(void)
 {
-#if HAVE_GETFSSTAT
+#ifdef HAVE_GETFSSTAT
 #if defined(HAVE_STATVFS) && defined(__NetBSD__)
     fscount = getvfsstat(NULL, 0, ST_NOWAIT);
 #else
@@ -719,7 +719,7 @@ int
 Get_Next_HR_FileSys(void)
 {
 next:
-#if HAVE_GETFSSTAT
+#ifdef HAVE_GETFSSTAT
     if (HRFS_index >= fscount)
         return -1;
     HRFS_entry = fsstats + HRFS_index;
diff --git a/agent/mibgroup/host/hr_network.c b/agent/mibgroup/host/hr_network.c
index cd3c56ec1e..fb574c2506 100644
--- a/agent/mibgroup/host/hr_network.c
+++ b/agent/mibgroup/host/hr_network.c
@@ -8,7 +8,7 @@
 #include <net-snmp/net-snmp-includes.h>
 #include <net-snmp/agent/net-snmp-agent-includes.h>
 #include <net-snmp/data_access/interface.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/host/hr_other.c b/agent/mibgroup/host/hr_other.c
index 9e4b16a267..265ccdd3df 100644
--- a/agent/mibgroup/host/hr_other.c
+++ b/agent/mibgroup/host/hr_other.c
@@ -8,7 +8,7 @@
 #include "host_res.h"
 #include "hr_other.h"
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/agent/mibgroup/host/hr_partition.c b/agent/mibgroup/host/hr_partition.c
index 14d80711b7..6761978594 100644
--- a/agent/mibgroup/host/hr_partition.c
+++ b/agent/mibgroup/host/hr_partition.c
@@ -15,12 +15,12 @@
 
 #include <net-snmp/net-snmp-config.h>
 #include <fcntl.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include <errno.h>
diff --git a/agent/mibgroup/host/hr_print.c b/agent/mibgroup/host/hr_print.c
index 6de0f6ca62..1c1ef7a193 100644
--- a/agent/mibgroup/host/hr_print.c
+++ b/agent/mibgroup/host/hr_print.c
@@ -176,7 +176,7 @@ var_hrprint(struct variable * vp,
         long_return = printer_detail_status(print_idx);
         return (u_char *) & long_return;
     case HRPRINT_ERROR:
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #else
         long_return = 0;        /* Null string */
diff --git a/agent/mibgroup/host/hr_proc.c b/agent/mibgroup/host/hr_proc.c
index 6f93079970..a5bacccea3 100644
--- a/agent/mibgroup/host/hr_proc.c
+++ b/agent/mibgroup/host/hr_proc.c
@@ -6,10 +6,10 @@
 #include <net-snmp/net-snmp-config.h>
 #include <net-snmp/net-snmp-includes.h>
 #include <net-snmp/agent/net-snmp-agent-includes.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/host/hr_storage.c b/agent/mibgroup/host/hr_storage.c
index 6b459ec516..af4a9b9cfa 100644
--- a/agent/mibgroup/host/hr_storage.c
+++ b/agent/mibgroup/host/hr_storage.c
@@ -12,13 +12,13 @@
 #endif
 
 #include <sys/types.h>
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -30,41 +30,41 @@
 #endif
 
 #if (!defined(mingw32) && !defined(WIN32))
-#if HAVE_UTMPX_H
+#ifdef HAVE_UTMPX_H
 #include <utmpx.h>
 #else
 #include <utmp.h>
 #endif
 #endif /* mingw32 */
 #ifndef dynix
-#if HAVE_SYS_VM_H
+#ifdef HAVE_SYS_VM_H
 #include <sys/vm.h>
 #if (!defined(KERNEL) || defined(MACH_USER_API)) && defined(HAVE_SYS_VMMETER_H) /*OS X does not #include <sys/vmmeter.h> if (defined(KERNEL) && !defined(MACH_USER_API)) */
 #include <sys/vmmeter.h>
 #endif
 #else
-#if HAVE_VM_VM_H
+#ifdef HAVE_VM_VM_H
 #include <vm/vm.h>
-#if HAVE_MACHINE_TYPES_H
+#ifdef HAVE_MACHINE_TYPES_H
 #include <machine/types.h>
 #endif
-#if HAVE_SYS_VMMETER_H
+#ifdef HAVE_SYS_VMMETER_H
 #include <sys/vmmeter.h>
 #endif
-#if HAVE_VM_VM_PARAM_H
+#ifdef HAVE_VM_VM_PARAM_H
 #include <vm/vm_param.h>
 #endif
 #else
-#if HAVE_SYS_VMPARAM_H
+#ifdef HAVE_SYS_VMPARAM_H
 #include <sys/vmparam.h>
 #endif
-#if HAVE_SYS_VMMAC_H
+#ifdef HAVE_SYS_VMMAC_H
 #include <sys/vmmac.h>
 #endif
-#if HAVE_SYS_VMMETER_H
+#ifdef HAVE_SYS_VMMETER_H
 #include <sys/vmmeter.h>
 #endif
-#if HAVE_SYS_VMSYSTM_H
+#ifdef HAVE_SYS_VMSYSTM_H
 #include <sys/vmsystm.h>
 #endif
 #endif                          /* vm/vm.h */
@@ -76,13 +76,13 @@
 #include <vm/vm_param.h>
 #include <vm/vm_extern.h>
 #endif
-#if HAVE_KVM_H
+#ifdef HAVE_KVM_H
 #include <kvm.h>
 #endif
-#if HAVE_FCNTL_H
+#ifdef HAVE_FCNTL_H
 #include <fcntl.h>
 #endif
-#if HAVE_SYS_POOL_H
+#ifdef HAVE_SYS_POOL_H
 #if defined(MBPOOL_SYMBOL) && defined(MCLPOOL_SYMBOL)
 #define __POOL_EXPOSE
 #include <sys/pool.h>
@@ -90,15 +90,15 @@
 #undef HAVE_SYS_POOL_H
 #endif
 #endif
-#if HAVE_SYS_MBUF_H
+#ifdef HAVE_SYS_MBUF_H
 #include <sys/mbuf.h>
 #endif
-#if HAVE_SYS_SYSCTL_H
+#ifdef HAVE_SYS_SYSCTL_H
 #include <sys/sysctl.h>
 #if defined(CTL_HW) && defined(HW_PAGESIZE)
 #define USE_SYSCTL
 #endif
-#if USE_MACH_HOST_STATISTICS
+#ifdef USE_MACH_HOST_STATISTICS
 #include <mach/mach.h>
 #elif defined(CTL_VM) && (defined(VM_METER) || defined(VM_UVMEXP))
 #define USE_SYSCTL_VM
@@ -119,19 +119,19 @@
 #include "hr_filesys.h"
 #include <net-snmp/agent/auto_nlist.h>
 
-#if HAVE_MNTENT_H
+#ifdef HAVE_MNTENT_H
 #include <mntent.h>
 #endif
-#if HAVE_SYS_MNTTAB_H
+#ifdef HAVE_SYS_MNTTAB_H
 #include <sys/mnttab.h>
 #endif
-#if HAVE_SYS_STATVFS_H
+#ifdef HAVE_SYS_STATVFS_H
 #include <sys/statvfs.h>
 #endif
-#if HAVE_SYS_VFS_H
+#ifdef HAVE_SYS_VFS_H
 #include <sys/vfs.h>
 #endif
-#if HAVE_SYS_MOUNT_H
+#ifdef HAVE_SYS_MOUNT_H
 #ifdef __osf__
 #undef m_next
 #undef m_data
@@ -147,17 +147,17 @@
 #include <sys/pstat.h>
 #endif
 #if defined(solaris2)
-#if HAVE_SYS_SWAP_H
+#ifdef HAVE_SYS_SWAP_H
 #include <sys/swap.h>
 #endif
 #endif
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_NBUTIL_H
+#ifdef HAVE_NBUTIL_H
 #include <nbutil.h>
 #endif
 
@@ -603,7 +603,7 @@ var_hrstore(struct variable *vp,
         }
     case HRSTORE_UNITS:
         if (store_idx > NETSNMP_MEM_TYPE_MAX)
-#if HRFS_HAS_FRSIZE
+#ifdef HRFS_HAS_FRSIZE
             long_return = stat_buf.f_frsize;
 #else
             long_return = stat_buf.f_bsize;
@@ -634,7 +634,7 @@ var_hrstore(struct variable *vp,
         return (u_char *) & long_return;
     case HRSTORE_FAILS:
         if (store_idx > NETSNMP_MEM_TYPE_MAX)
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
 	    goto try_next;
 #else
             long_return = 0;
diff --git a/agent/mibgroup/host/hr_swinst.c b/agent/mibgroup/host/hr_swinst.c
index 1f527332c7..0250869397 100644
--- a/agent/mibgroup/host/hr_swinst.c
+++ b/agent/mibgroup/host/hr_swinst.c
@@ -6,11 +6,11 @@
 #include <net-snmp/net-snmp-config.h>
 #include <net-snmp/net-snmp-features.h>
 
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
 #include <sys/stat.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -20,7 +20,7 @@
 #  include <time.h>
 # endif
 #endif
-#if HAVE_DIRENT_H
+#ifdef HAVE_DIRENT_H
 #include <dirent.h>
 #else
 # define dirent direct
@@ -60,7 +60,7 @@
 #endif
 #endif
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -102,7 +102,7 @@ netsnmp_feature_require(date_n_time);
  *      de_p                    swi->swi_dep
  */
 typedef struct {
-#if HAVE_LIBRPM
+#ifdef HAVE_LIBRPM
     char           *swi_directory;
 #else
     const char     *swi_directory;
@@ -110,7 +110,7 @@ typedef struct {
     char            swi_name[SNMP_MAXPATH];     /* XXX longest file name */
     int             swi_index;
 
-#if HAVE_LIBRPM
+#ifdef HAVE_LIBRPM
     const char     *swi_dbpath;
 
     time_t          swi_timestamp;      /* modify time on database */
@@ -412,7 +412,7 @@ var_hrswinst(struct variable * vp,
             else
                 long_return = 0;        /* predates this agent */
         } else
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
             return NULL;
 #else
             long_return = 363136200;
@@ -516,7 +516,7 @@ var_hrswinst(struct variable * vp,
                     goto err;
             } else {
 err:
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
                 ret = NULL;
 #else
                 sprintf(string, "back in the mists of time");
diff --git a/agent/mibgroup/host/hr_swrun.c b/agent/mibgroup/host/hr_swrun.c
index b1c46c4c0c..a8defcea97 100644
--- a/agent/mibgroup/host/hr_swrun.c
+++ b/agent/mibgroup/host/hr_swrun.c
@@ -16,33 +16,33 @@
  */
 
 #include <net-snmp/net-snmp-config.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 #include <fcntl.h>
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
 #include <sys/param.h>
 #include <ctype.h>
-#if HAVE_SYS_PSTAT_H
+#ifdef HAVE_SYS_PSTAT_H
 #include <sys/pstat.h>
 #endif
-#if HAVE_SYS_USER_H
+#ifdef HAVE_SYS_USER_H
 #ifdef solaris2
 #include <libgen.h>
 #define _KMEMUSER
 #endif
 #include <sys/user.h>
 #endif
-#if HAVE_SYS_PROC_H
+#ifdef HAVE_SYS_PROC_H
 #include <sys/proc.h>
 #endif
-#if HAVE_KVM_H
+#ifdef HAVE_KVM_H
 #include <kvm.h>
 #endif
-#if HAVE_SYS_SYSCTL_H
+#ifdef HAVE_SYS_SYSCTL_H
 #include <sys/sysctl.h>
 #endif
 #if HAVE_DIRENT_H && !defined(cygwin)
@@ -70,7 +70,7 @@
 #include <procfs.h>
 #endif
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -122,9 +122,9 @@ static int      LowProcIndex;
 #if defined(hpux10) || defined(hpux11)
 struct pst_status *proc_table;
 struct pst_dynamic pst_dyn;
-#elif HAVE_KVM_GETPROC2
+#elif defined(HAVE_KVM_GETPROC2)
 struct kinfo_proc2 *proc_table;
-#elif HAVE_KVM_GETPROCS
+#elif defined(HAVE_KVM_GETPROCS)
 struct kinfo_proc *proc_table;
 #elif defined(solaris2)
 int            *proc_table;
@@ -634,7 +634,7 @@ var_hrswrun(struct variable * vp,
 
     switch (vp->magic) {
     case HRSWRUN_OSINDEX:
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #else
         /* 
@@ -680,13 +680,13 @@ var_hrswrun(struct variable * vp,
         cp = strchr(string, ' ');
         if (cp != NULL)
             *cp = '\0';
-#elif HAVE_KVM_GETPROC2
+#elif defined(HAVE_KVM_GETPROC2)
         strlcpy(string, proc_table[LowProcIndex].p_comm, sizeof(string));
         /* process name: truncate the string at the first space */
         cp = strchr(string, ' ');
         if (cp != NULL)
             *cp = '\0';
-#elif HAVE_KVM_GETPROCS
+#elif defined(HAVE_KVM_GETPROCS)
     #if defined(freebsd5) && __FreeBSD_version >= 500014
         strlcpy(string, proc_table[LowProcIndex].ki_comm, sizeof(string));
     #elif defined(dragonfly) && __DragonFly_version >= 190000
@@ -743,7 +743,7 @@ var_hrswrun(struct variable * vp,
         if (cp > string && strcasecmp(cp, ".exe") == 0)
             *cp = '\0';
 #else
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         sprintf(string, "process name");
@@ -803,13 +803,13 @@ var_hrswrun(struct variable * vp,
         cp = strchr(string, ' ');
         if (cp != NULL)
             *cp = '\0';
-#elif HAVE_KVM_GETPROC2
+#elif defined(HAVE_KVM_GETPROC2)
         /* Should be path, but this is not available, just use argv[0] again */
         strlcpy(string, proc_table[LowProcIndex].p_comm, sizeof(string));
         cp = strchr(string, ' ');
         if (cp != NULL)
             *cp = '\0';
-#elif HAVE_KVM_GETPROCS
+#elif defined(HAVE_KVM_GETPROCS)
     #if defined(freebsd5) && __FreeBSD_version >= 500014
         strlcpy(string, proc_table[LowProcIndex].ki_comm, sizeof(string));
     #elif defined(dragonfly) && __DragonFly_version >= 190000
@@ -859,7 +859,7 @@ var_hrswrun(struct variable * vp,
         } else
             strcpy(string, "* unknown");
 #else
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         sprintf(string, "/bin/wombat");
@@ -910,7 +910,7 @@ var_hrswrun(struct variable * vp,
             sprintf(string, "%s", cp);
         } else
             string[0] = '\0';
-#elif HAVE_KVM_GETPROC2
+#elif defined(HAVE_KVM_GETPROC2)
         string[0] = 0;
         argv = kvm_getargv2(kd, proc_table + LowProcIndex, sizeof(string));
         if (argv)
@@ -921,7 +921,7 @@ var_hrswrun(struct variable * vp,
             strcat(string, *argv);
             argv++;
         }
-#elif HAVE_KVM_GETPROCS
+#elif defined(HAVE_KVM_GETPROCS)
         string[0] = 0;
         argv = kvm_getargv(kd, proc_table + LowProcIndex, sizeof(string));
         if (argv)
@@ -966,7 +966,7 @@ var_hrswrun(struct variable * vp,
 #elif defined(cygwin)
         string[0] = 0;
 #else
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         sprintf(string, "-h -q -v");
@@ -988,12 +988,12 @@ var_hrswrun(struct variable * vp,
 			long_return = 2;	/* kernel process */
 		} else
 			long_return = 4;	/* application */
-#elif HAVE_KVM_GETPROC2
+#elif defined(HAVE_KVM_GETPROC2)
         if (proc_table[LowProcIndex].p_flag & P_SYSTEM)
 	    long_return = 2;	/* operatingSystem */
 	else
 	    long_return = 4;	/* application */
-#elif HAVE_KVM_GETPROCS
+#elif defined(HAVE_KVM_GETPROCS)
     #if defined(freebsd5) && __FreeBSD_version >= 500014
 	if (proc_table[LowProcIndex].ki_flag & P_SYSTEM) {
 	    if (proc_table[LowProcIndex].ki_pri.pri_class == PRI_ITHD)
@@ -1050,9 +1050,9 @@ var_hrswrun(struct variable * vp,
             break;
         }
 #else
-#if HAVE_KVM_GETPROC2
+#ifdef HAVE_KVM_GETPROC2
         switch (proc_table[LowProcIndex].p_stat) {
-#elif HAVE_KVM_GETPROCS
+#elif defined(HAVE_KVM_GETPROCS)
     #if defined(freebsd5) && __FreeBSD_version >= 500014
         switch (proc_table[LowProcIndex].ki_stat) {
     #elif defined(dragonfly) && __DragonFly_version >= 190000
@@ -1147,11 +1147,11 @@ var_hrswrun(struct variable * vp,
 #else
         long_return = proc_buf->p_utime * 100 + proc_buf->p_stime * 100;
 #endif
-#elif HAVE_KVM_GETPROC2
+#elif defined(HAVE_KVM_GETPROC2)
         long_return = proc_table[LowProcIndex].p_uticks +
             proc_table[LowProcIndex].p_sticks +
             proc_table[LowProcIndex].p_iticks;
-#elif HAVE_KVM_GETPROCS
+#elif defined(HAVE_KVM_GETPROCS)
     #if defined(NOT_DEFINED) && defined(freebsd5) && __FreeBSD_version >= 500014
         /* XXX: Accessing ki_paddr causes sig10 ...
         long_return = proc_table[LowProcIndex].ki_paddr->p_uticks +
@@ -1267,7 +1267,7 @@ var_hrswrun(struct variable * vp,
 #endif
 #elif defined(aix4) || defined(aix5) || defined(aix6) || defined(aix7)
         long_return = proc_table[LowProcIndex].pi_size * getpagesize() / 1024;
-#elif HAVE_KVM_GETPROC2
+#elif defined(HAVE_KVM_GETPROC2)
         long_return = proc_table[LowProcIndex].p_vm_tsize +
             proc_table[LowProcIndex].p_vm_ssize +
             proc_table[LowProcIndex].p_vm_dsize;
@@ -1331,7 +1331,7 @@ var_hrswrun(struct variable * vp,
             }
         }
 #else
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_return = 16 * 1024;        /* XXX - 16M! */
@@ -1542,7 +1542,7 @@ Init_HR_SWRun(void)
 			proc_table = realloc(proc_table, avail * sizeof(proc_table[0]));
 		}
     }
-#elif HAVE_KVM_GETPROC2
+#elif defined(HAVE_KVM_GETPROC2)
     {
         if (kd == NULL) {
             nproc = 0;
@@ -1550,7 +1550,7 @@ Init_HR_SWRun(void)
         }
         proc_table = kvm_getproc2(kd, KERN_PROC_ALL, 0, sizeof (struct kinfo_proc2), &nproc);
     }
-#elif HAVE_KVM_GETPROCS
+#elif defined(HAVE_KVM_GETPROCS)
     {
         if (kd == NULL) {
             nproc = 0;
@@ -1610,10 +1610,10 @@ Get_Next_HR_SWRun(void)
         return proc_table[current_proc_entry++].pst_pid;
 #elif defined(solaris2)
         return proc_table[current_proc_entry++];
-#elif HAVE_KVM_GETPROC2
+#elif defined(HAVE_KVM_GETPROC2)
         if (proc_table[current_proc_entry].p_stat != 0)
             return proc_table[current_proc_entry++].p_pid;
-#elif HAVE_KVM_GETPROCS
+#elif defined(HAVE_KVM_GETPROCS)
     #if defined(freebsd5) && __FreeBSD_version >= 500014
         if (proc_table[current_proc_entry].ki_stat != 0)
             return proc_table[current_proc_entry++].ki_pid;
diff --git a/agent/mibgroup/host/hr_system.c b/agent/mibgroup/host/hr_system.c
index 3844a9fb07..246ecdaf92 100644
--- a/agent/mibgroup/host/hr_system.c
+++ b/agent/mibgroup/host/hr_system.c
@@ -16,7 +16,7 @@
 
 #include <net-snmp/net-snmp-config.h>
 #include <net-snmp/net-snmp-features.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -36,7 +36,7 @@
 #include "sys/proc.h"
 #endif
 #ifndef mingw32
-#if HAVE_UTMPX_H
+#ifdef HAVE_UTMPX_H
 #include <utmpx.h>
 #else
 #include <utmp.h>
@@ -115,7 +115,7 @@ static long     get_max_solaris_processes(void);
 static int      get_load_dev(void);
 static int      count_users(void);
 extern int      count_processes(void);
-#if USING_HOST_DATA_ACCESS_SWRUN_MODULE
+#ifdef USING_HOST_DATA_ACCESS_SWRUN_MODULE
 static int      count_kthreads = 1;
 
 static void parse_count_kthreads(const char *token, const char *line)
@@ -202,7 +202,7 @@ init_hr_system(void)
 #ifdef NPROC_SYMBOL
     auto_nlist(NPROC_SYMBOL, 0, 0);
 #endif
-#if USING_HOST_DATA_ACCESS_SWRUN_MODULE
+#ifdef USING_HOST_DATA_ACCESS_SWRUN_MODULE
     snmpd_register_const_config_handler("count_kthreads",
                                         parse_count_kthreads, NULL,
 					"0|1    0 to exclude kernel threads from hrSystemProcesses.0");
@@ -318,7 +318,7 @@ var_hrsys(struct variable * vp,
         }
         strlcpy(string,bootparam,sizeof(string));
 #else
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         sprintf(string, "ask Dave");    /* XXX */
@@ -329,12 +329,12 @@ var_hrsys(struct variable * vp,
         long_return = count_users();
         return (u_char *) & long_return;
     case HRSYS_PROCS:
-#if USING_HOST_DATA_ACCESS_SWRUN_MODULE
+#ifdef USING_HOST_DATA_ACCESS_SWRUN_MODULE
         long_return = swrun_count_processes(count_kthreads);
-#elif USING_HOST_HR_SWRUN_MODULE
+#elif defined(USING_HOST_HR_SWRUN_MODULE)
         long_return = count_processes();
 #else
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_return = 0;
@@ -367,7 +367,7 @@ var_hrsys(struct variable * vp,
 	    long_return = nproc;
 	}
 #else
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_return = 0;
@@ -676,7 +676,7 @@ count_users(void)
 {
     int             total = 0;
 #ifndef WIN32
-#if HAVE_UTMPX_H
+#ifdef HAVE_UTMPX_H
 #define setutent setutxent
 #define pututline pututxline
 #define getutent getutxent
diff --git a/agent/mibgroup/host/hrh_filesys.c b/agent/mibgroup/host/hrh_filesys.c
index 12cfb12b81..fabeaa3259 100644
--- a/agent/mibgroup/host/hrh_filesys.c
+++ b/agent/mibgroup/host/hrh_filesys.c
@@ -49,10 +49,10 @@
 #endif
 
 #include <ctype.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 
diff --git a/agent/mibgroup/host/hrh_storage.c b/agent/mibgroup/host/hrh_storage.c
index c8554ea5fc..3d89391104 100644
--- a/agent/mibgroup/host/hrh_storage.c
+++ b/agent/mibgroup/host/hrh_storage.c
@@ -17,13 +17,13 @@
 
 
 #include <sys/types.h>
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # ifdef WIN32
 #  include <windows.h>
 #  include <errno.h>
@@ -39,11 +39,11 @@
 # endif
 #endif
 
-#if HAVE_FCNTL_H
+#ifdef HAVE_FCNTL_H
 #include <fcntl.h>
 #endif
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -454,7 +454,7 @@ var_hrstore(struct variable *vp,
         return (u_char *) & long_return;
     case HRSTORE_FAILS:
         if (store_idx > NETSNMP_MEM_TYPE_MAX)
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
 	    goto try_next;
 #else
         long_return = 0;
diff --git a/agent/mibgroup/if-mib/data_access/interface_linux.c b/agent/mibgroup/if-mib/data_access/interface_linux.c
index 93c49f34ae..23d9f9fa5e 100644
--- a/agent/mibgroup/if-mib/data_access/interface_linux.c
+++ b/agent/mibgroup/if-mib/data_access/interface_linux.c
@@ -69,7 +69,7 @@ typedef __u8 u8;           /* ditto */
 
 #include <net-snmp/agent/net-snmp-agent-includes.h>
 
-#if HAVE_SYS_IOCTL_H
+#ifdef HAVE_SYS_IOCTL_H
 #include <sys/ioctl.h>
 #else
 #error "linux should have sys/ioctl header"
diff --git a/agent/mibgroup/if-mib/data_access/interface_openbsd.c b/agent/mibgroup/if-mib/data_access/interface_openbsd.c
index c1ca83ec39..34e1d8414b 100644
--- a/agent/mibgroup/if-mib/data_access/interface_openbsd.c
+++ b/agent/mibgroup/if-mib/data_access/interface_openbsd.c
@@ -13,7 +13,7 @@ netsnmp_feature_child_of(interface_arch_set_admin_status, interface_all);
 
 #include <net-snmp/agent/net-snmp-agent-includes.h>
 
-#if HAVE_SYS_IOCTL_H
+#ifdef HAVE_SYS_IOCTL_H
 #include <sys/ioctl.h>
 #else
 #error "linux should have sys/ioctl header"
diff --git a/agent/mibgroup/if-mib/data_access/interface_sysctl.c b/agent/mibgroup/if-mib/data_access/interface_sysctl.c
index ed7638a6f7..f9591d249e 100644
--- a/agent/mibgroup/if-mib/data_access/interface_sysctl.c
+++ b/agent/mibgroup/if-mib/data_access/interface_sysctl.c
@@ -13,7 +13,7 @@
 
 #include <net-snmp/agent/net-snmp-agent-includes.h>
 
-#if HAVE_SYS_IOCTL_H
+#ifdef HAVE_SYS_IOCTL_H
 #include <sys/ioctl.h>
 #else
 #error "BSD should have sys/ioctl header"
diff --git a/agent/mibgroup/ip-forward-mib/data_access/route_ioctl.c b/agent/mibgroup/ip-forward-mib/data_access/route_ioctl.c
index cc525f6aa9..eeeecb9637 100644
--- a/agent/mibgroup/ip-forward-mib/data_access/route_ioctl.c
+++ b/agent/mibgroup/ip-forward-mib/data_access/route_ioctl.c
@@ -5,19 +5,19 @@
 #include <net-snmp/net-snmp-config.h>
 
 #include <sys/types.h>
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
-#if HAVE_SYS_FILE_H
+#ifdef HAVE_SYS_FILE_H
 #include <sys/file.h>
 #endif
-#if HAVE_SYS_SOCKET_H
+#ifdef HAVE_SYS_SOCKET_H
 #include <sys/socket.h>
 #endif
 #ifdef HAVE_SYS_SOCKIO_H
 #include <sys/sockio.h>
 #endif
-#if HAVE_SYS_IOCTL_H
+#ifdef HAVE_SYS_IOCTL_H
 #include <sys/ioctl.h>
 #endif
 #ifdef HAVE_SYS_MBUF_H
@@ -28,29 +28,29 @@
 #ifdef HAVE_SYS_STREAM_H
 #include <sys/stream.h>
 #endif
-#if HAVE_NET_ROUTE_H
+#ifdef HAVE_NET_ROUTE_H
 #include <net/route.h>
 #endif
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if HAVE_ARPA_INET_H
+#ifdef HAVE_ARPA_INET_H
 #include <arpa/inet.h>
 #endif
-#if HAVE_NETDB_H
+#ifdef HAVE_NETDB_H
 #include <netdb.h>
 #endif
 
 #include <errno.h>
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include <stdio.h>
 #include <ctype.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 
diff --git a/agent/mibgroup/ip-mib/data_access/arp_netlink.c b/agent/mibgroup/ip-mib/data_access/arp_netlink.c
index 09c13f0806..8cab2efbd8 100644
--- a/agent/mibgroup/ip-mib/data_access/arp_netlink.c
+++ b/agent/mibgroup/ip-mib/data_access/arp_netlink.c
@@ -12,7 +12,7 @@
 #include <errno.h>
 #include <stdint.h>
 #include <sys/types.h>
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include <linux/types.h>
diff --git a/agent/mibgroup/ip-mib/data_access/systemstats_sysctl.c b/agent/mibgroup/ip-mib/data_access/systemstats_sysctl.c
index 105760a8c7..12075f0a46 100644
--- a/agent/mibgroup/ip-mib/data_access/systemstats_sysctl.c
+++ b/agent/mibgroup/ip-mib/data_access/systemstats_sysctl.c
@@ -25,7 +25,7 @@
 #define _KERNEL 1
 #define _I_DEFINED_KERNEL
 #endif
-#if NETSNMP_IFNET_NEEDS_KERNEL_STRUCTURES
+#ifdef NETSNMP_IFNET_NEEDS_KERNEL_STRUCTURES
 #define _KERNEL_STRUCTURES
 #endif
 #include <net/if.h>
@@ -37,10 +37,10 @@
 #include <netinet/ip.h>
 #include <netinet/ip_icmp.h>
 #include <netinet/ip_var.h>
-#if HAVE_NETINET_ICMP6_H
+#ifdef HAVE_NETINET_ICMP6_H
 #include <netinet/icmp6.h>
 #endif
-#if HAVE_NETINET6_IP6_VAR_H
+#ifdef HAVE_NETINET6_IP6_VAR_H
 #include <sys/queue.h>
 #include <netinet6/ip6_var.h>
 #endif
@@ -586,7 +586,7 @@ _systemstats_v6_load_systemstats(netsnmp_container* container, u_int load_flags)
     entry->stats.InHdrErrors = ip6stat.ip6s_badoptions + ip6stat.ip6s_tooshort
                              + ip6stat.ip6s_toosmall + ip6stat.ip6s_badvers
 			     + ip6stat.ip6s_toomanyhdr;
-#if HAVE_STRUCT_IP6STAT_IP6S_EXTHDRTOOLONG
+#ifdef HAVE_STRUCT_IP6STAT_IP6S_EXTHDRTOOLONG
     entry->stats.InHdrErrors += ip6stat.ip6s_exthdrtoolong;
 #endif
     entry->stats.columnAvail[IPSYSTEMSTATSTABLE_INHDRERRORS] = 1;
diff --git a/agent/mibgroup/mibII/data_access/at_hpux.c b/agent/mibgroup/mibII/data_access/at_hpux.c
index 241affcb92..e14c5d0ff1 100644
--- a/agent/mibgroup/mibII/data_access/at_hpux.c
+++ b/agent/mibgroup/mibII/data_access/at_hpux.c
@@ -19,12 +19,12 @@
 #include <net-snmp/agent/net-snmp-agent-includes.h>
 #include <net-snmp/data_access/interface.h>
 #include "../at.h"
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 #if defined(NETSNMP_IFNET_NEEDS_KERNEL) && !defined(_KERNEL)
@@ -32,7 +32,7 @@
 #define _I_DEFINED_KERNEL
 #endif
 #include <sys/types.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -42,46 +42,46 @@
 #  include <time.h>
 # endif
 #endif
-#if HAVE_SYS_SOCKET_H
+#ifdef HAVE_SYS_SOCKET_H
 #include <sys/socket.h>
 #endif
 
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if HAVE_NET_IF_H
+#ifdef HAVE_NET_IF_H
 #include <net/if.h>
 #endif
-#if HAVE_NET_IF_VAR_H
+#ifdef HAVE_NET_IF_VAR_H
 #include <net/if_var.h>
 #endif
 #ifdef _I_DEFINED_KERNEL
 #undef _KERNEL
 #endif
 
-#if HAVE_NETINET_IF_ETHER_H
+#ifdef HAVE_NETINET_IF_ETHER_H
 #include <netinet/if_ether.h>
 #endif
-#if HAVE_INET_MIB2_H
+#ifdef HAVE_INET_MIB2_H
 #include <inet/mib2.h>
 #endif
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
-#if HAVE_SYS_SYSCTL_H
+#ifdef HAVE_SYS_SYSCTL_H
 #include <sys/sysctl.h>
 #endif
-#if HAVE_NET_IF_DL_H
+#ifdef HAVE_NET_IF_DL_H
 #ifndef dynix
 #include <net/if_dl.h>
 #else
 #include <sys/net/if_dl.h>
 #endif
 #endif
-#if HAVE_SYS_STREAM_H
+#ifdef HAVE_SYS_STREAM_H
 #include <sys/stream.h>
 #endif
-#if HAVE_NET_ROUTE_H
+#ifdef HAVE_NET_ROUTE_H
 #include <net/route.h>
 #endif
 #ifdef solaris2
diff --git a/agent/mibgroup/mibII/data_access/at_sysctl.c b/agent/mibgroup/mibII/data_access/at_sysctl.c
index dfc207c9be..c9b5ad412f 100644
--- a/agent/mibgroup/mibII/data_access/at_sysctl.c
+++ b/agent/mibgroup/mibII/data_access/at_sysctl.c
@@ -19,22 +19,22 @@
 #include <net-snmp/agent/net-snmp-agent-includes.h>
 #include <net-snmp/data_access/interface.h>
 #include "../at.h"
-#if HAVE_NET_IF_H
+#ifdef HAVE_NET_IF_H
 #include <net/if.h>
 #endif
-#if HAVE_NET_IF_DL_H
+#ifdef HAVE_NET_IF_DL_H
 #include <net/if_dl.h>
 #endif
-#if HAVE_NETINET_IF_ETHER_H
+#ifdef HAVE_NETINET_IF_ETHER_H
 #include <netinet/if_ether.h>
 #endif
-#if HAVE_NET_ROUTE_H
+#ifdef HAVE_NET_ROUTE_H
 #include <net/route.h>
 #endif
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if HAVE_SYS_SYSCTL_H
+#ifdef HAVE_SYS_SYSCTL_H
 #include <sys/sysctl.h>
 #endif
 
diff --git a/agent/mibgroup/mibII/data_access/at_unix.c b/agent/mibgroup/mibII/data_access/at_unix.c
index 8064301ceb..39c3375e6e 100644
--- a/agent/mibgroup/mibII/data_access/at_unix.c
+++ b/agent/mibgroup/mibII/data_access/at_unix.c
@@ -136,7 +136,7 @@ var_atEntry(struct variable *vp,
     case IPMEDIAIFINDEX:       /* also ATIFINDEX */
         *var_len = sizeof long_return;
         long_return = lowIfIndex ? lowIfIndex : 1;
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         if (lowIfIndex == 0)
             return NULL;
 #endif
diff --git a/agent/mibgroup/mibII/interfaces.c b/agent/mibgroup/mibII/interfaces.c
index 1bbd00dc17..89de7593fc 100644
--- a/agent/mibgroup/mibII/interfaces.c
+++ b/agent/mibgroup/mibII/interfaces.c
@@ -29,19 +29,19 @@ netsnmp_feature_provide(interface_legacy);
 #define _I_DEFINED_KERNEL
 #endif
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
 #include <sys/types.h>
@@ -49,19 +49,19 @@ netsnmp_feature_provide(interface_legacy);
 #define _KERNEL 1
 #define _I_DEFINED_KERNEL
 #endif
-#if HAVE_SYS_SOCKET_H
+#ifdef HAVE_SYS_SOCKET_H
 #include <sys/socket.h>
 #endif
 #ifndef STREAM_NEEDS_KERNEL_ISLANDS
-#if HAVE_SYS_STREAM_H
+#ifdef HAVE_SYS_STREAM_H
 #include <sys/stream.h>
 #endif
 #endif
-#if HAVE_SYS_SOCKETVAR_H
+#ifdef HAVE_SYS_SOCKETVAR_H
 #include <sys/socketvar.h>
 #endif
 
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -71,86 +71,86 @@ netsnmp_feature_provide(interface_legacy);
 #  include <time.h>
 # endif
 #endif
-#if HAVE_SYS_SOCKIO_H
+#ifdef HAVE_SYS_SOCKIO_H
 #include <sys/sockio.h>
 #endif
-#if HAVE_FCNTL_H
+#ifdef HAVE_FCNTL_H
 #include <fcntl.h>
 #endif
-#if HAVE_SYS_IOCTL_H
+#ifdef HAVE_SYS_IOCTL_H
 #include <sys/ioctl.h>
 #endif
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if HAVE_NET_IF_H
+#ifdef HAVE_NET_IF_H
 #include <net/if.h>
 #endif
-#if HAVE_NETINET_IN_VAR_H
+#ifdef HAVE_NETINET_IN_VAR_H
 #include <netinet/in_var.h>
 #endif
-#if HAVE_NET_IF_VAR_H
+#ifdef HAVE_NET_IF_VAR_H
 #include <net/if_var.h>
 #endif
 #ifdef _I_DEFINED_KERNEL
 #undef _KERNEL
 #endif
 #ifdef STREAM_NEEDS_KERNEL_ISLANDS
-#if HAVE_SYS_STREAM_H
+#ifdef HAVE_SYS_STREAM_H
 #include <sys/stream.h>
 #endif
 #endif
-#if HAVE_NET_ROUTE_H
+#ifdef HAVE_NET_ROUTE_H
 #include <net/route.h>
 #endif
-#if HAVE_NETINET_IN_SYSTM_H
+#ifdef HAVE_NETINET_IN_SYSTM_H
 #include <netinet/in_systm.h>
 #endif
-#if HAVE_SYS_HASHING_H
+#ifdef HAVE_SYS_HASHING_H
 #include <sys/hashing.h>
 #endif
-#if HAVE_NETINET_IN_VAR_H
+#ifdef HAVE_NETINET_IN_VAR_H
 #include <netinet/in_var.h>
 #endif
-#if HAVE_NETINET_IP_H
+#ifdef HAVE_NETINET_IP_H
 #include <netinet/ip.h>
 #endif
 #ifdef NETSNMP_ENABLE_IPV6
-#if HAVE_NETINET_IP6_H
+#ifdef HAVE_NETINET_IP6_H
 #include <netinet/ip6.h>
 #endif
 #endif
-#if HAVE_SYS_QUEUE_H
+#ifdef HAVE_SYS_QUEUE_H
 #include <sys/queue.h>
 #endif
-#if HAVE_NETINET_IP_VAR_H
+#ifdef HAVE_NETINET_IP_VAR_H
 #include <netinet/ip_var.h>
 #endif
 #ifdef NETSNMP_ENABLE_IPV6
-#if HAVE_NETNETSNMP_ENABLE_IPV6_IP6_VAR_H
+#ifdef HAVE_NETNETSNMP_ENABLE_IPV6_IP6_VAR_H
 #include <netinet6/ip6_var.h>
 #endif
 #endif
-#if HAVE_NETINET_IN_PCB_H
+#ifdef HAVE_NETINET_IN_PCB_H
 #include <netinet/in_pcb.h>
 #endif
-#if HAVE_NETINET_IF_ETHER_H
+#ifdef HAVE_NETINET_IF_ETHER_H
 #include <netinet/if_ether.h>
 #endif
-#if HAVE_NET_IF_TYPES_H
+#ifdef HAVE_NET_IF_TYPES_H
 #include <net/if_types.h>
 #endif
-#if HAVE_NET_IF_DL_H
+#ifdef HAVE_NET_IF_DL_H
 #ifndef dynix
 #include <net/if_dl.h>
 #else
 #include <sys/net/if_dl.h>
 #endif
 #endif
-#if HAVE_INET_MIB2_H
+#ifdef HAVE_INET_MIB2_H
 #include <inet/mib2.h>
 #endif
-#if HAVE_IOCTLS_H
+#ifdef HAVE_IOCTLS_H
 #include <ioctls.h>
 #endif
 
@@ -170,7 +170,7 @@ netsnmp_feature_provide(interface_legacy);
 #include <windows.h>
 #endif
 
-#if HAVE_SYS_SYSCTL_H
+#ifdef HAVE_SYS_SYSCTL_H
 #include <sys/sysctl.h>
 
 #if defined(freebsd3) || defined(freebsd4) || defined(freebsd5)
@@ -188,7 +188,7 @@ netsnmp_feature_provide(interface_legacy);
 #endif                          /* defined(freebsd3) */
 #endif                          /* HAVE_SYS_SYSCTL_H */
 
-#if HAVE_OSRELDATE_H
+#ifdef HAVE_OSRELDATE_H
 #include <osreldate.h>
 #endif
 #ifdef NETSNMP_CAN_USE_SYSCTL
@@ -292,7 +292,7 @@ init_interfaces(void)
                          "The MIB module to describe generic objects for network interface sub-layers");
 
 #ifndef USE_SYSCTL_IFLIST
-#if HAVE_NET_IF_MIB_H
+#ifdef HAVE_NET_IF_MIB_H
     init_interfaces_setup();
 #endif
 #endif
@@ -621,7 +621,7 @@ var_ifEntry(struct variable *vp,
         if (if_ptr)
             long_return = if_ptr->speed;
         else {
-#if HAVE_STRUCT_IFNET_IF_BAUDRATE_IFS_VALUE
+#ifdef HAVE_STRUCT_IFNET_IF_BAUDRATE_IFS_VALUE
         long_return = (u_long) if_msg.ifm_data.ifi_baudrate.ifs_value <<
             if_msg.ifm_data.ifi_baudrate.ifs_log2;
 #else
@@ -678,7 +678,7 @@ var_ifEntry(struct variable *vp,
 #ifdef if_odrops
         long_return = (u_long) if_msg.ifm_data.ifi_odrops;
 #else
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_return = 0;
@@ -692,7 +692,7 @@ var_ifEntry(struct variable *vp,
         long_return = 0;
 #else
         if (if_msg.ifm_data.ifi_lastchange.tv_sec == 0 &&
-#if STRUCT_IFNET_HAS_IF_LASTCHANGE_TV_NSEC
+#ifdef STRUCT_IFNET_HAS_IF_LASTCHANGE_TV_NSEC
             if_msg.ifm_data.ifi_lastchange.tv_nsec == 0
 #else
             if_msg.ifm_data.ifi_lastchange.tv_usec == 0
@@ -706,7 +706,7 @@ var_ifEntry(struct variable *vp,
                 ((if_msg.ifm_data.ifi_lastchange.tv_sec -
                   starttime.tv_sec) * 100 +
                  (
-#if STRUCT_IFNET_HAS_IF_LASTCHANGE_TV_NSEC
+#ifdef STRUCT_IFNET_HAS_IF_LASTCHANGE_TV_NSEC
                   if_msg.ifm_data.ifi_lastchange.tv_nsec / 1000
 #else
                   if_msg.ifm_data.ifi_lastchange.tv_usec
@@ -802,7 +802,7 @@ var_ifEntry(struct variable *vp,
         if (if_ptr)
             long_return = if_ptr->type;
         else {
-#if HAVE_STRUCT_IFNET_IF_TYPE
+#ifdef HAVE_STRUCT_IFNET_IF_TYPE
             long_return = ifnet.if_type;
 #else
             long_return = 1;    /* OTHER */
@@ -817,9 +817,9 @@ var_ifEntry(struct variable *vp,
         if (if_ptr)
             long_return = if_ptr->speed;
         else {
-#if HAVE_STRUCT_IFNET_IF_BAUDRATE
+#ifdef HAVE_STRUCT_IFNET_IF_BAUDRATE
             long_return = ifnet.if_baudrate;
-#elif HAVE_STRUCT_IFNET_IF_SPEED
+#elif defined(HAVE_STRUCT_IFNET_IF_SPEED)
             long_return = ifnet.if_speed;
 #elif HAVE_STRUCT_IFNET_IF_TYPE && defined(IFT_ETHER)
             if (ifnet.if_type == IFT_ETHER)
@@ -833,7 +833,7 @@ var_ifEntry(struct variable *vp,
             if (ifnet.if_type == IFT_ISDNPRIMARY)
                 long_return = 64000 * 30;
 #else
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
             return NULL;
 #endif
             long_return = (u_long) 10000000;
@@ -868,7 +868,7 @@ var_ifEntry(struct variable *vp,
          * this is fixed, thus the 199607 comparison.
          */
         if (ifnet.if_lastchange.tv_sec == 0 &&
-#if STRUCT_IFNET_HAS_IF_LASTCHANGE_TV_NSEC
+#ifdef STRUCT_IFNET_HAS_IF_LASTCHANGE_TV_NSEC
             ifnet.if_lastchange.tv_nsec == 0
 #else
             ifnet.if_lastchange.tv_usec == 0
@@ -881,7 +881,7 @@ var_ifEntry(struct variable *vp,
             long_return = (u_long)
                 ((ifnet.if_lastchange.tv_sec - starttime.tv_sec) * 100
                  + (
-#if STRUCT_IFNET_HAS_IF_LASTCHANGE_TV_NSEC
+#ifdef STRUCT_IFNET_HAS_IF_LASTCHANGE_TV_NSEC
                    ifnet.if_lastchange.tv_nsec / 1000
 #else
                    ifnet.if_lastchange.tv_usec
@@ -889,7 +889,7 @@ var_ifEntry(struct variable *vp,
                    - starttime.tv_usec) / 10000);
         }
 #else
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_return = 0;        /* XXX */
@@ -903,7 +903,7 @@ var_ifEntry(struct variable *vp,
         long_return = (u_long) ifnet.if_ibytes;
 #endif
 #else
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_return = (u_long) ifnet.if_ipackets * 308; /* XXX */
@@ -916,7 +916,7 @@ var_ifEntry(struct variable *vp,
 #else
             long_return = (u_long) ifnet.if_ipackets;
 #endif
-#if HAVE_STRUCT_IFNET_IF_IMCASTS
+#ifdef HAVE_STRUCT_IFNET_IF_IMCASTS
 #if defined(aix4) || defined(aix5) || defined(aix6) || defined(aix7)
             long_return -= (u_long) ifnet.if_imcasts & 0xffffffff;
 #else
@@ -926,28 +926,28 @@ var_ifEntry(struct variable *vp,
         }
         return (u_char *) & long_return;
     case NETSNMP_IFINNUCASTPKTS:
-#if HAVE_STRUCT_IFNET_IF_IMCASTS
+#ifdef HAVE_STRUCT_IFNET_IF_IMCASTS
 #if defined(aix4) || defined(aix5) || defined(aix6) || defined(aix7)
         long_return = (u_long) ifnet.if_imcasts & 0xffffffff;
 #else
         long_return = (u_long) ifnet.if_imcasts;
 #endif
 #else
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_return = (u_long) 0;       /* XXX */
 #endif
         return (u_char *) & long_return;
     case NETSNMP_IFINDISCARDS:
-#if HAVE_STRUCT_IFNET_IF_IQDROPS
+#ifdef HAVE_STRUCT_IFNET_IF_IQDROPS
 #if defined(aix4) || defined(aix5) || defined(aix6) || defined(aix7)
         long_return = (u_long) ifnet.if_iqdrops & 0xffffffff;
 #else
         long_return = (u_long) ifnet.if_iqdrops;
 #endif
 #else
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_return = (u_long) 0;       /* XXX */
@@ -961,14 +961,14 @@ var_ifEntry(struct variable *vp,
 #endif
         return (u_char *) & long_return;
     case NETSNMP_IFINUNKNOWNPROTOS:
-#if HAVE_STRUCT_IFNET_IF_NOPROTO
+#ifdef HAVE_STRUCT_IFNET_IF_NOPROTO
 #if defined(aix4) || defined(aix5) || defined(aix6) || defined(aix7)
         long_return = (u_long) ifnet.if_noproto & 0xffffffff;
 #else
         long_return = (u_long) ifnet.if_noproto;
 #endif
 #else
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_return = (u_long) 0;       /* XXX */
@@ -982,7 +982,7 @@ var_ifEntry(struct variable *vp,
         long_return = (u_long) ifnet.if_obytes;
 #endif
 #else
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_return = (u_long) ifnet.if_opackets * 308; /* XXX */
@@ -995,7 +995,7 @@ var_ifEntry(struct variable *vp,
 #else
             long_return = (u_long) ifnet.if_opackets;
 #endif
-#if HAVE_STRUCT_IFNET_IF_OMCASTS
+#ifdef HAVE_STRUCT_IFNET_IF_OMCASTS
 #if defined(aix4) || defined(aix5) || defined(aix6) || defined(aix7)
             long_return -= (u_long) ifnet.if_omcasts & 0xffffffff;
 #else
@@ -1005,14 +1005,14 @@ var_ifEntry(struct variable *vp,
         }
         return (u_char *) & long_return;
     case NETSNMP_IFOUTNUCASTPKTS:
-#if HAVE_STRUCT_IFNET_IF_OMCASTS
+#ifdef HAVE_STRUCT_IFNET_IF_OMCASTS
 #if defined(aix4) || defined(aix5) || defined(aix6) || defined(aix7)
         long_return = (u_long) ifnet.if_omcasts & 0xffffffff;
 #else
         long_return = (u_long) ifnet.if_omcasts;
 #endif
 #else
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_return = (u_long) 0;       /* XXX */
@@ -1072,7 +1072,7 @@ var_ifEntry(struct variable *vp,
     static char     Name[16];
 #endif
     register char  *cp;
-#if HAVE_STRUCT_IFNET_IF_LASTCHANGE_TV_SEC
+#ifdef HAVE_STRUCT_IFNET_IF_LASTCHANGE_TV_SEC
     struct timeval  now;
 #endif
 #if !defined(hpux11)
@@ -2036,7 +2036,7 @@ Interface_Scan_NextInt(int *Index,
             DEBUGMSGTL(("mibII/interfaces:Interface_Scan_Next", "klookup failed\n"));
             break;
         }
-#if HAVE_STRUCT_IFNET_IF_XNAME
+#ifdef HAVE_STRUCT_IFNET_IF_XNAME
 #if defined(netbsd1) || defined(openbsd2)
         strlcpy(saveName, ifnet.if_xname, sizeof(saveName));
 #else
diff --git a/agent/mibgroup/mibII/ip.c b/agent/mibgroup/mibII/ip.c
index c1b7f1540a..8daa462d15 100644
--- a/agent/mibgroup/mibII/ip.c
+++ b/agent/mibgroup/mibII/ip.c
@@ -415,7 +415,7 @@ ip_handler(netsnmp_mib_handler          *handler,
         ret_value = ipstat.ips_forward;
         break;
     case IPINUNKNOWNPROTOS:
-#if HAVE_STRUCT_IPSTAT_IPS_NOPROTO
+#ifdef HAVE_STRUCT_IPSTAT_IPS_NOPROTO
         ret_value = ipstat.ips_noproto;
         break;
 #else
@@ -423,7 +423,7 @@ ip_handler(netsnmp_mib_handler          *handler,
         continue;
 #endif
     case IPINDISCARDS:
-#if HAVE_STRUCT_IPSTAT_IPS_FRAGDROPPED
+#ifdef HAVE_STRUCT_IPSTAT_IPS_FRAGDROPPED
         ret_value = ipstat.ips_fragdropped;   /* ?? */
         break;
 #else
@@ -431,7 +431,7 @@ ip_handler(netsnmp_mib_handler          *handler,
         continue;
 #endif
     case IPINDELIVERS:
-#if HAVE_STRUCT_IPSTAT_IPS_DELIVERED
+#ifdef HAVE_STRUCT_IPSTAT_IPS_DELIVERED
         ret_value = ipstat.ips_delivered & 0xffffffff;
         break;
 #else
@@ -439,7 +439,7 @@ ip_handler(netsnmp_mib_handler          *handler,
         continue;
 #endif
     case IPOUTREQUESTS:
-#if HAVE_STRUCT_IPSTAT_IPS_LOCALOUT
+#ifdef HAVE_STRUCT_IPSTAT_IPS_LOCALOUT
         ret_value = ipstat.ips_localout & 0xffffffff;
         break;
 #else
@@ -447,7 +447,7 @@ ip_handler(netsnmp_mib_handler          *handler,
         continue;
 #endif
     case IPOUTDISCARDS:
-#if HAVE_STRUCT_IPSTAT_IPS_ODROPPED
+#ifdef HAVE_STRUCT_IPSTAT_IPS_ODROPPED
         ret_value = ipstat.ips_odropped;
         break;
 #else
@@ -470,7 +470,7 @@ ip_handler(netsnmp_mib_handler          *handler,
         ret_value = ipstat.ips_fragments;
         break;
     case IPREASMOKS:
-#if HAVE_STRUCT_IPSTAT_IPS_REASSEMBLED
+#ifdef HAVE_STRUCT_IPSTAT_IPS_REASSEMBLED
         ret_value = ipstat.ips_reassembled;
         break;
 #else
@@ -481,7 +481,7 @@ ip_handler(netsnmp_mib_handler          *handler,
         ret_value = ipstat.ips_fragdropped + ipstat.ips_fragtimeout;
         break;
     case IPFRAGOKS:
-#if HAVE_STRUCT_IPSTAT_IPS_FRAGMENTED
+#ifdef HAVE_STRUCT_IPSTAT_IPS_FRAGMENTED
         ret_value = ipstat.ips_fragments;
         break;
 #else            /* XXX */
@@ -490,7 +490,7 @@ ip_handler(netsnmp_mib_handler          *handler,
         break;
 #endif
     case IPFRAGFAILS:
-#if HAVE_STRUCT_IPSTAT_IPS_CANTFRAG
+#ifdef HAVE_STRUCT_IPSTAT_IPS_CANTFRAG
         ret_value = ipstat.ips_cantfrag;
         break;
 #else
@@ -498,7 +498,7 @@ ip_handler(netsnmp_mib_handler          *handler,
         continue;
 #endif
     case IPFRAGCREATES:
-#if HAVE_STRUCT_IPSTAT_IPS_OFRAGMENTS
+#ifdef HAVE_STRUCT_IPSTAT_IPS_OFRAGMENTS
         ret_value = ipstat.ips_ofragments;
         break;
 #else
@@ -506,7 +506,7 @@ ip_handler(netsnmp_mib_handler          *handler,
         continue;
 #endif
     case IPROUTEDISCARDS:
-#if HAVE_STRUCT_IPSTAT_IPS_NOROUTE
+#ifdef HAVE_STRUCT_IPSTAT_IPS_NOROUTE
         ret_value = ipstat.ips_noroute;
         break;
 #else
diff --git a/agent/mibgroup/mibII/ipAddr.c b/agent/mibgroup/mibII/ipAddr.c
index 7370581177..82d2b8ddb8 100644
--- a/agent/mibgroup/mibII/ipAddr.c
+++ b/agent/mibgroup/mibII/ipAddr.c
@@ -21,10 +21,10 @@
 #define _KERNEL 1
 #define _I_DEFINED_KERNEL
 #endif
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #ifdef irix6
 #define _STANDALONE 1
 #endif
@@ -34,7 +34,7 @@
 #include <sys/socket.h>
 #endif
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -938,7 +938,7 @@ var_ipAddrEntry(struct variable *vp,
         return (u_char *) & long_return;
 
     case IPADREASMMAX:
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #else
         long_return = -1;
diff --git a/agent/mibgroup/mibII/ipv6.c b/agent/mibgroup/mibII/ipv6.c
index ae78e96642..a4577e6c20 100644
--- a/agent/mibgroup/mibII/ipv6.c
+++ b/agent/mibgroup/mibII/ipv6.c
@@ -1417,7 +1417,7 @@ var_icmpv6Entry(register struct variable * vp,
 #endif
 }
 
-#if HAVE_KVM_GETFILES
+#ifdef HAVE_KVM_GETFILES
 
 u_char         *
 var_udp6(register struct variable * vp,
@@ -1970,7 +1970,7 @@ var_tcp6(register struct variable * vp,
     return NULL;
 }
 
-#elif HAVE_KVM_GETFILES
+#elif defined(HAVE_KVM_GETFILES)
 
 u_char         *
 var_tcp6(register struct variable * vp,
diff --git a/agent/mibgroup/mibII/kernel_linux.c b/agent/mibgroup/mibII/kernel_linux.c
index a06f0dd1cd..7587ad69b9 100644
--- a/agent/mibgroup/mibII/kernel_linux.c
+++ b/agent/mibgroup/mibII/kernel_linux.c
@@ -8,11 +8,11 @@
 #include <net-snmp/net-snmp-includes.h>
 #include <net-snmp/agent/net-snmp-agent-includes.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
 #include <sys/types.h>
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
 #include <errno.h>
diff --git a/agent/mibgroup/mibII/mibII_common.h b/agent/mibgroup/mibII/mibII_common.h
index 668b6b3266..dedf399d7b 100644
--- a/agent/mibgroup/mibII/mibII_common.h
+++ b/agent/mibgroup/mibII/mibII_common.h
@@ -1,18 +1,18 @@
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
 #include <sys/types.h>
 
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
 
diff --git a/agent/mibgroup/mibII/mta_sendmail.c b/agent/mibgroup/mibII/mta_sendmail.c
index 084f238652..8f4f0f15ca 100644
--- a/agent/mibgroup/mibII/mta_sendmail.c
+++ b/agent/mibgroup/mibII/mta_sendmail.c
@@ -59,7 +59,7 @@
 # include <strings.h>
 #endif
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 
@@ -71,7 +71,7 @@
 # include <fcntl.h>
 #endif
 
-#if HAVE_DIRENT_H
+#ifdef HAVE_DIRENT_H
 #include <dirent.h>
 #else
 # define dirent direct
@@ -90,7 +90,7 @@
 # include <sys/stat.h>
 #endif
 
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/agent/mibgroup/mibII/route_headers.h b/agent/mibgroup/mibII/route_headers.h
index 6224d10ddc..71287604df 100644
--- a/agent/mibgroup/mibII/route_headers.h
+++ b/agent/mibgroup/mibII/route_headers.h
@@ -10,12 +10,12 @@
 #include <sys/queue.h>
 #include <sys/socket.h>
 #include <sys/sysctl.h>
-#if HAVE_SYS_TIME_H
+#ifdef HAVE_SYS_TIME_H
 #include <sys/time.h>
 #endif
 
 #include <net/if_dl.h>
-#if HAVE_SYS_STREAM_H
+#ifdef HAVE_SYS_STREAM_H
 #include <sys/stream.h>
 #endif
 #include <net/route.h>
@@ -33,13 +33,13 @@
 #define GATEWAY                 /* MultiNet is always configured this way! */
 #include <stdio.h>
 #include <sys/types.h>
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
 #ifdef HAVE_SYS_SOCKET_H
 #include <sys/socket.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -123,12 +123,12 @@
 #include <kvm.h>
 #endif
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 #ifdef HAVE_INET_MIB2_H
diff --git a/agent/mibgroup/mibII/route_write.c b/agent/mibgroup/mibII/route_write.c
index 34420f3875..a308eb3205 100644
--- a/agent/mibgroup/mibII/route_write.c
+++ b/agent/mibgroup/mibII/route_write.c
@@ -11,10 +11,10 @@
 #include <net-snmp/net-snmp-config.h>
 
 #include <sys/types.h>
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
-#if HAVE_SYS_FILE_H
+#ifdef HAVE_SYS_FILE_H
 #include <sys/file.h>
 #endif
 #ifdef HAVE_SYS_SOCKET_H
@@ -48,15 +48,15 @@
 #endif
 
 #include <errno.h>
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include <stdio.h>
 #include <ctype.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 
diff --git a/agent/mibgroup/mibII/system_mib.c b/agent/mibgroup/mibII/system_mib.c
index c4622712cd..a6caac5e87 100644
--- a/agent/mibgroup/mibII/system_mib.c
+++ b/agent/mibgroup/mibII/system_mib.c
@@ -16,13 +16,13 @@
 #include <net-snmp/net-snmp-config.h>
 #include <net-snmp/net-snmp-features.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 #ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -216,7 +216,7 @@ handle_sysServices(netsnmp_mib_handler *handler,
                    netsnmp_agent_request_info *reqinfo,
                    netsnmp_request_info *requests)
 {
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
     if (reqinfo->mode == MODE_GET && !sysServicesConfiged)
         netsnmp_request_set_error(requests, SNMP_NOSUCHINSTANCE);
 #endif
diff --git a/agent/mibgroup/mibII/tcp.c b/agent/mibgroup/mibII/tcp.c
index ac934e22bb..e9d47556f7 100644
--- a/agent/mibgroup/mibII/tcp.c
+++ b/agent/mibgroup/mibII/tcp.c
@@ -8,10 +8,10 @@
 #include <net-snmp/net-snmp-features.h>
 #include "mibII_common.h"
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/agent/mibgroup/mibII/tcpTable.c b/agent/mibgroup/mibII/tcpTable.c
index 50f56d6d74..772b16a9c9 100644
--- a/agent/mibgroup/mibII/tcpTable.c
+++ b/agent/mibgroup/mibII/tcpTable.c
@@ -107,7 +107,7 @@ struct netsnmp_tcpConnEntry_s {
 #define	TCPTABLE_REMOTEPORT	inp_fport
 #define	TCPTABLE_IS_LINKED_LIST
 
-#elif HAVE_KVM_GETFILES
+#elif defined(HAVE_KVM_GETFILES)
 #define	TCPTABLE_ENTRY_TYPE	struct kinfo_file
 #define	TCPTABLE_STATE		t_state 
 #define	TCPTABLE_LOCALADDRESS	inp_laddru[0]
diff --git a/agent/mibgroup/mibII/udp.c b/agent/mibgroup/mibII/udp.c
index 09b0112075..7b0f40f055 100644
--- a/agent/mibgroup/mibII/udp.c
+++ b/agent/mibgroup/mibII/udp.c
@@ -244,7 +244,7 @@ udp_handler(netsnmp_mib_handler          *handler,
 #define udpstat          udpstat.udpstat
 #endif
     case UDPINDATAGRAMS:
-#if HAVE_STRUCT_UDPSTAT_UDPS_IPACKETS
+#ifdef HAVE_STRUCT_UDPSTAT_UDPS_IPACKETS
         ret_value = udpstat.udps_ipackets;
         break;
 #else
@@ -253,7 +253,7 @@ udp_handler(netsnmp_mib_handler          *handler,
 #endif
 
     case UDPNOPORTS:
-#if HAVE_STRUCT_UDPSTAT_UDPS_NOPORT
+#ifdef HAVE_STRUCT_UDPSTAT_UDPS_NOPORT
         ret_value = udpstat.udps_noport;
         break;
 #else
@@ -262,7 +262,7 @@ udp_handler(netsnmp_mib_handler          *handler,
 #endif
 
     case UDPOUTDATAGRAMS:
-#if HAVE_STRUCT_UDPSTAT_UDPS_OPACKETS
+#ifdef HAVE_STRUCT_UDPSTAT_UDPS_OPACKETS
         ret_value = udpstat.udps_opackets;
         break;
 #else
diff --git a/agent/mibgroup/mibII/vacm_conf.c b/agent/mibgroup/mibII/vacm_conf.c
index a310361a4d..30911d9110 100644
--- a/agent/mibgroup/mibII/vacm_conf.c
+++ b/agent/mibgroup/mibII/vacm_conf.c
@@ -19,18 +19,18 @@
 
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_MALLOC_H
+#ifdef HAVE_MALLOC_H
 #include <malloc.h>
 #endif
 #include <ctype.h>
diff --git a/agent/mibgroup/mibII/vacm_context.c b/agent/mibgroup/mibII/vacm_context.c
index aab1688b8f..09d2bf0380 100644
--- a/agent/mibgroup/mibII/vacm_context.c
+++ b/agent/mibgroup/mibII/vacm_context.c
@@ -11,7 +11,7 @@
 
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/mibII/vacm_vars.c b/agent/mibgroup/mibII/vacm_vars.c
index 62c9a3d051..e577848089 100644
--- a/agent/mibgroup/mibII/vacm_vars.c
+++ b/agent/mibgroup/mibII/vacm_vars.c
@@ -19,18 +19,18 @@
 
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_MALLOC_H
+#ifdef HAVE_MALLOC_H
 #include <malloc.h>
 #endif
 #include <ctype.h>
@@ -54,7 +54,7 @@
 #include "vacm_vars.h"
 #include "util_funcs/header_generic.h"
 
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/agent/mibgroup/mibII/var_route.c b/agent/mibgroup/mibII/var_route.c
index 23fea11336..5551068084 100644
--- a/agent/mibgroup/mibII/var_route.c
+++ b/agent/mibgroup/mibII/var_route.c
@@ -241,25 +241,25 @@ var_ipRouteEntry(struct variable *vp,
         long_return = (rtp->rtm_flags & RTF_UP) ? 1 : 0;
         return (u_char *) & long_return;
     case IPROUTEMETRIC2:
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_return = -1;
         return (u_char *) & long_return;
     case IPROUTEMETRIC3:
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_return = -1;
         return (u_char *) & long_return;
     case IPROUTEMETRIC4:
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_return = -1;
         return (u_char *) & long_return;
     case IPROUTEMETRIC5:
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_return = -1;
@@ -285,7 +285,7 @@ var_ipRouteEntry(struct variable *vp,
             ? 2 : (rtp->rtm_flags & RTF_DYNAMIC) ? 4 : 1;
         return (u_char *) & long_return;
     case IPROUTEAGE:
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_return = 0;
@@ -457,7 +457,7 @@ var_ipRouteEntry(struct variable * vp,
      ** this optimisation fails, if there is only a single route avail.
      ** it is a very special case, but better leave it out ...
      **/
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
     saveNameLen = 0;
 #endif
     if (rtsize <= 1)
@@ -600,7 +600,7 @@ var_ipRouteEntry(struct variable * vp,
         long_return = -1;
         return (u_char *) & long_return;
     case IPROUTEMETRIC5:
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_return = -1;
@@ -655,7 +655,7 @@ var_ipRouteEntry(struct variable * vp,
          * XXX - Almost certainly not right
          * but I don't have a suitable system to test this on 
          */
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         addr_ret = 0;
@@ -914,7 +914,7 @@ load_rtentries(struct radix_node *pt)
                 DEBUGMSGTL(("mibII/var_route", "klookup failed\n"));
                 return;
             }
-#if HAVE_STRUCT_IFNET_IF_XNAME
+#ifdef HAVE_STRUCT_IFNET_IF_XNAME
 #if defined(netbsd1) || defined(openbsd2)
             strlcpy(name, ifnet.if_xname, sizeof(name));
 #else
@@ -948,7 +948,7 @@ load_rtentries(struct radix_node *pt)
                     break;
             }
         }
-#if CHECK_RT_FLAGS
+#ifdef CHECK_RT_FLAGS
         if (((rt.rt_flags & RTF_CLONING) != RTF_CLONING)
             && ((rt.rt_flags & RTF_LLINFO) != RTF_LLINFO)) {
 #endif
@@ -972,7 +972,7 @@ load_rtentries(struct radix_node *pt)
              */
             memcpy((char *) rthead[rtsize], (char *) &rt, sizeof(RTENTRY));
             rtsize++;
-#if CHECK_RT_FLAGS
+#ifdef CHECK_RT_FLAGS
         }
 #endif
 
@@ -1501,7 +1501,7 @@ var_ipRouteEntry(struct variable *vp,
      ** this optimisation fails, if there is only a single route avail.
      ** it is a very special case, but better leave it out ...
      **/
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
     saveNameLen = 0;
 #endif
     if (route_row == NULL) {
@@ -1980,7 +1980,7 @@ var_ipRouteEntry(struct variable * vp,
         return (u_char *) & long_return;
 
     case IPROUTEAGE:
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_return = 0;
@@ -2047,7 +2047,7 @@ snmp_socket_length(int family)
     case AF_LINK:
 #ifdef _MAX_SA_LEN
         length = _MAX_SA_LEN;
-#elif SOCK_MAXADDRLEN
+#elif defined(SOCK_MAXADDRLEN)
         length = SOCK_MAXADDRLEN;
 #else
         length = sizeof(struct sockaddr_dl);
diff --git a/agent/mibgroup/mibincl.h b/agent/mibgroup/mibincl.h
index 3d48768b4e..4ef3cd727f 100644
--- a/agent/mibgroup/mibincl.h
+++ b/agent/mibgroup/mibincl.h
@@ -5,13 +5,13 @@
 #include <stdio.h>
 #include <sys/types.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_MALLOC_H
+#ifdef HAVE_MALLOC_H
 #include <malloc.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/agent/mibgroup/misc/ipfwacc.c b/agent/mibgroup/misc/ipfwacc.c
index 5b65fb9d31..622e9e8600 100644
--- a/agent/mibgroup/misc/ipfwacc.c
+++ b/agent/mibgroup/misc/ipfwacc.c
@@ -8,7 +8,7 @@
 
 #include <net-snmp/net-snmp-config.h>
 
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/agent/mibgroup/notification/snmpNotifyFilterProfileTable.c b/agent/mibgroup/notification/snmpNotifyFilterProfileTable.c
index 28e9554636..65e668c67f 100644
--- a/agent/mibgroup/notification/snmpNotifyFilterProfileTable.c
+++ b/agent/mibgroup/notification/snmpNotifyFilterProfileTable.c
@@ -15,10 +15,10 @@
 #include <net-snmp/net-snmp-config.h>
 
 #include <sys/types.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/notification/snmpNotifyFilterProfileTable_data.c b/agent/mibgroup/notification/snmpNotifyFilterProfileTable_data.c
index 26fe93bd63..0532312a35 100644
--- a/agent/mibgroup/notification/snmpNotifyFilterProfileTable_data.c
+++ b/agent/mibgroup/notification/snmpNotifyFilterProfileTable_data.c
@@ -15,10 +15,10 @@
 #include <net-snmp/net-snmp-config.h>
 
 #include <sys/types.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/notification/snmpNotifyTable.c b/agent/mibgroup/notification/snmpNotifyTable.c
index da3a3bc011..c23f3d3250 100644
--- a/agent/mibgroup/notification/snmpNotifyTable.c
+++ b/agent/mibgroup/notification/snmpNotifyTable.c
@@ -16,10 +16,10 @@
 #include <net-snmp/net-snmp-features.h>
 
 #include <sys/types.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/notification/snmpNotifyTable_data.c b/agent/mibgroup/notification/snmpNotifyTable_data.c
index bcdedc3aa1..5a42a96235 100644
--- a/agent/mibgroup/notification/snmpNotifyTable_data.c
+++ b/agent/mibgroup/notification/snmpNotifyTable_data.c
@@ -15,10 +15,10 @@
 #include <net-snmp/net-snmp-features.h>
 
 #include <sys/types.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/rmon-mib/data_access/etherstats_linux.c b/agent/mibgroup/rmon-mib/data_access/etherstats_linux.c
index 204a6ff742..ebad8ab0ff 100644
--- a/agent/mibgroup/rmon-mib/data_access/etherstats_linux.c
+++ b/agent/mibgroup/rmon-mib/data_access/etherstats_linux.c
@@ -5,7 +5,7 @@
 #include <net-snmp/net-snmp-includes.h>
 #include <net-snmp/agent/net-snmp-agent-includes.h>
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/agent/mibgroup/rmon-mib/etherStatsTable/etherStatsTable_data_access.c b/agent/mibgroup/rmon-mib/etherStatsTable/etherStatsTable_data_access.c
index 5259645c35..7e41523366 100644
--- a/agent/mibgroup/rmon-mib/etherStatsTable/etherStatsTable_data_access.c
+++ b/agent/mibgroup/rmon-mib/etherStatsTable/etherStatsTable_data_access.c
@@ -11,7 +11,7 @@
 #include <net-snmp/net-snmp-includes.h>
 #include <net-snmp/agent/net-snmp-agent-includes.h>
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/agent/mibgroup/smux/smux.c b/agent/mibgroup/smux/smux.c
index 5023dfae62..fb53f4972d 100644
--- a/agent/mibgroup/smux/smux.c
+++ b/agent/mibgroup/smux/smux.c
@@ -12,21 +12,21 @@
 #include <io.h>
 #endif
 #include <stdio.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #ifdef HAVE_ERR_H
 #include <err.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/agent/mibgroup/smux/snmp_bgp.c b/agent/mibgroup/smux/snmp_bgp.c
index a97ca35e32..cf3b0bd146 100644
--- a/agent/mibgroup/smux/snmp_bgp.c
+++ b/agent/mibgroup/smux/snmp_bgp.c
@@ -9,21 +9,21 @@
 #include <net-snmp/net-snmp-config.h>
 
 #include <stdio.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_ERR_H
+#ifdef HAVE_ERR_H
 #include <err.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -38,11 +38,11 @@
 
 #include <sys/stat.h>
 #include <sys/socket.h>
-#if HAVE_SYS_FILIO_H
+#ifdef HAVE_SYS_FILIO_H
 #include <sys/filio.h>
 #endif
 
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
 
diff --git a/agent/mibgroup/smux/snmp_ospf.c b/agent/mibgroup/smux/snmp_ospf.c
index 4b6d64051a..5d1f62a82c 100644
--- a/agent/mibgroup/smux/snmp_ospf.c
+++ b/agent/mibgroup/smux/snmp_ospf.c
@@ -9,21 +9,21 @@
 #include <net-snmp/net-snmp-config.h>
 
 #include <stdio.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_ERR_H
+#ifdef HAVE_ERR_H
 #include <err.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -38,11 +38,11 @@
 
 #include <sys/stat.h>
 #include <sys/socket.h>
-#if HAVE_SYS_FILIO_H
+#ifdef HAVE_SYS_FILIO_H
 #include <sys/filio.h>
 #endif
 
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
 
diff --git a/agent/mibgroup/smux/snmp_rip2.c b/agent/mibgroup/smux/snmp_rip2.c
index 9d49a3020c..c174a3e6fb 100644
--- a/agent/mibgroup/smux/snmp_rip2.c
+++ b/agent/mibgroup/smux/snmp_rip2.c
@@ -9,21 +9,21 @@
 #include <net-snmp/net-snmp-config.h>
 
 #include <stdio.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_ERR_H
+#ifdef HAVE_ERR_H
 #include <err.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -38,11 +38,11 @@
 
 #include <sys/stat.h>
 #include <sys/socket.h>
-#if HAVE_SYS_FILIO_H
+#ifdef HAVE_SYS_FILIO_H
 #include <sys/filio.h>
 #endif
 
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
 
diff --git a/agent/mibgroup/snmpv3/usmUser.c b/agent/mibgroup/snmpv3/usmUser.c
index 0edea53cfb..608637ec63 100644
--- a/agent/mibgroup/snmpv3/usmUser.c
+++ b/agent/mibgroup/snmpv3/usmUser.c
@@ -15,7 +15,7 @@
 #include <net-snmp/net-snmp-features.h>
 #include <stdlib.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/target/snmpTargetAddrEntry.c b/agent/mibgroup/target/snmpTargetAddrEntry.c
index 03adb2610e..bd87260dcd 100644
--- a/agent/mibgroup/target/snmpTargetAddrEntry.c
+++ b/agent/mibgroup/target/snmpTargetAddrEntry.c
@@ -11,7 +11,7 @@
  */
 
 #include <net-snmp/net-snmp-config.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/target/snmpTargetAddrEntry_data.c b/agent/mibgroup/target/snmpTargetAddrEntry_data.c
index 8a60945d26..4a3954ba22 100644
--- a/agent/mibgroup/target/snmpTargetAddrEntry_data.c
+++ b/agent/mibgroup/target/snmpTargetAddrEntry_data.c
@@ -11,7 +11,7 @@
  */
 
 #include <net-snmp/net-snmp-config.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/target/snmpTargetParamsEntry.c b/agent/mibgroup/target/snmpTargetParamsEntry.c
index a2f2e704a7..84c3e519e3 100644
--- a/agent/mibgroup/target/snmpTargetParamsEntry.c
+++ b/agent/mibgroup/target/snmpTargetParamsEntry.c
@@ -11,7 +11,7 @@
  */
 
 #include <net-snmp/net-snmp-config.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/target/snmpTargetParamsEntry_data.c b/agent/mibgroup/target/snmpTargetParamsEntry_data.c
index a128cd9066..54aecf3c2b 100644
--- a/agent/mibgroup/target/snmpTargetParamsEntry_data.c
+++ b/agent/mibgroup/target/snmpTargetParamsEntry_data.c
@@ -10,7 +10,7 @@
  */
 
 #include <net-snmp/net-snmp-config.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/target/target.c b/agent/mibgroup/target/target.c
index cc14292990..239b35a21b 100644
--- a/agent/mibgroup/target/target.c
+++ b/agent/mibgroup/target/target.c
@@ -7,7 +7,7 @@
 #include <net-snmp/net-snmp-config.h>
 #include <net-snmp/net-snmp-features.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/target/target_counters.c b/agent/mibgroup/target/target_counters.c
index 9725ddcb25..7c48052d6f 100644
--- a/agent/mibgroup/target/target_counters.c
+++ b/agent/mibgroup/target/target_counters.c
@@ -2,7 +2,7 @@
 
 #include <net-snmp/net-snmp-features.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/tcp-mib/data_access/tcpConn_freebsd4.c b/agent/mibgroup/tcp-mib/data_access/tcpConn_freebsd4.c
index 4e2a41a122..dc51cf5cb8 100644
--- a/agent/mibgroup/tcp-mib/data_access/tcpConn_freebsd4.c
+++ b/agent/mibgroup/tcp-mib/data_access/tcpConn_freebsd4.c
@@ -12,16 +12,16 @@
 
 #include "mibII/mibII_common.h"
 
-#if HAVE_NETINET_TCP_H
+#ifdef HAVE_NETINET_TCP_H
 #include <netinet/tcp.h>
 #endif
-#if HAVE_NETINET_TCP_TIMER_H
+#ifdef HAVE_NETINET_TCP_TIMER_H
 #include <netinet/tcp_timer.h>
 #endif
-#if HAVE_NETINET_TCPIP_H
+#ifdef HAVE_NETINET_TCPIP_H
 #include <netinet/tcpip.h>
 #endif
-#if HAVE_NETINET_TCP_VAR_H
+#ifdef HAVE_NETINET_TCP_VAR_H
 #include <netinet/tcp_var.h>
 #endif
 
diff --git a/agent/mibgroup/tcp-mib/data_access/tcpConn_netbsd.c b/agent/mibgroup/tcp-mib/data_access/tcpConn_netbsd.c
index b4229ff9fd..9a80192b3a 100644
--- a/agent/mibgroup/tcp-mib/data_access/tcpConn_netbsd.c
+++ b/agent/mibgroup/tcp-mib/data_access/tcpConn_netbsd.c
@@ -12,16 +12,16 @@
 
 #include "mibII/mibII_common.h"
 
-#if HAVE_NETINET_TCP_H
+#ifdef HAVE_NETINET_TCP_H
 #include <netinet/tcp.h>
 #endif
-#if HAVE_NETINET_TCP_TIMER_H
+#ifdef HAVE_NETINET_TCP_TIMER_H
 #include <netinet/tcp_timer.h>
 #endif
-#if HAVE_NETINET_TCPIP_H
+#ifdef HAVE_NETINET_TCPIP_H
 #include <netinet/tcpip.h>
 #endif
-#if HAVE_NETINET_TCP_VAR_H
+#ifdef HAVE_NETINET_TCP_VAR_H
 #include <netinet/tcp_var.h>
 #endif
 
diff --git a/agent/mibgroup/tcp-mib/data_access/tcpConn_openbsd.c b/agent/mibgroup/tcp-mib/data_access/tcpConn_openbsd.c
index 41a8c4c33a..56e2c3d981 100644
--- a/agent/mibgroup/tcp-mib/data_access/tcpConn_openbsd.c
+++ b/agent/mibgroup/tcp-mib/data_access/tcpConn_openbsd.c
@@ -13,26 +13,26 @@
 
 #include "mibII/mibII_common.h"
 
-#if HAVE_NETINET_TCP_H
+#ifdef HAVE_NETINET_TCP_H
 #include <netinet/tcp.h>
 #endif
-#if HAVE_NETINET_TCP_TIMER_H
+#ifdef HAVE_NETINET_TCP_TIMER_H
 #include <netinet/tcp_timer.h>
 #endif
-#if HAVE_NETINET_TCPIP_H
+#ifdef HAVE_NETINET_TCPIP_H
 #include <netinet/tcpip.h>
 #endif
-#if HAVE_NETINET_TCP_VAR_H
+#ifdef HAVE_NETINET_TCP_VAR_H
 #include <netinet/tcp_var.h>
 #endif
 
-#if HAVE_KVM_GETFILES
+#ifdef HAVE_KVM_GETFILES
 #if defined(HAVE_KVM_GETFILE2) || !defined(openbsd5)
 #undef HAVE_KVM_GETFILES
 #endif
 #endif
 
-#if HAVE_KVM_GETFILES
+#ifdef HAVE_KVM_GETFILES
 #include <kvm.h>
 #include <sys/sysctl.h>
 #define _KERNEL /* for DTYPE_SOCKET */
diff --git a/agent/mibgroup/testhandler.c b/agent/mibgroup/testhandler.c
index e83bc18d00..4fcdeaa363 100644
--- a/agent/mibgroup/testhandler.c
+++ b/agent/mibgroup/testhandler.c
@@ -4,7 +4,7 @@
 #ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/ucd-snmp/disk_hw.c b/agent/mibgroup/ucd-snmp/disk_hw.c
index bf820fcd35..95ca19cd69 100644
--- a/agent/mibgroup/ucd-snmp/disk_hw.c
+++ b/agent/mibgroup/ucd-snmp/disk_hw.c
@@ -7,21 +7,21 @@
 
 #include <stdio.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_FCNTL_H
+#ifdef HAVE_FCNTL_H
 #include <fcntl.h>
 #endif
 #include <signal.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 #include <sys/time.h>
 #include <time.h>
 #else
-#if HAVE_SYS_TIME_H
+#ifdef HAVE_SYS_TIME_H
 #include <sys/time.h>
 #else
 #include <time.h>
@@ -35,7 +35,7 @@
 #include "struct.h"
 #include "disk_hw.h"
 #include "util_funcs/header_simple_table.h"
-#if USING_UCD_SNMP_ERRORMIB_MODULE
+#ifdef USING_UCD_SNMP_ERRORMIB_MODULE
 #include "errormib.h"
 #else
 #define setPerrorstatus(x) snmp_log_perror(x)
diff --git a/agent/mibgroup/ucd-snmp/diskio.c b/agent/mibgroup/ucd-snmp/diskio.c
index e9df2ac82c..f9512054a7 100644
--- a/agent/mibgroup/ucd-snmp/diskio.c
+++ b/agent/mibgroup/ucd-snmp/diskio.c
@@ -14,7 +14,7 @@
 /*
  * needed by util_funcs.h 
  */
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -88,9 +88,9 @@ static int ps_numdisks;			/* number of disks in system, may change while running
 
 #if defined(HAVE_GETDEVS) || defined(HAVE_DEVSTAT_GETDEVS)
 #include <sys/param.h>
-#if HAVE_DEVSTAT_GETDEVS
+#ifdef HAVE_DEVSTAT_GETDEVS
 #include <sys/resource.h>       /* for CPUSTATES in devstat.h */
-#elif HAVE_SYS_DKSTAT_H
+#elif defined(HAVE_SYS_DKSTAT_H)
 #include <sys/dkstat.h>
 #endif
 #include <devstat.h>
@@ -102,7 +102,7 @@ static int ps_numdisks;			/* number of disks in system, may change while running
 
 #endif                          /* freebsd */
 
-#if HAVE_DEVSTAT_GETDEVS
+#ifdef HAVE_DEVSTAT_GETDEVS
   #define GETDEVS(x) devstat_getdevs(NULL, (x))
 #else
   #define GETDEVS(x) getdevs((x))
@@ -1019,7 +1019,7 @@ var_diskio(struct variable * vp,
 /* disk load average patch by Rojer */
 
 struct dev_la {
-#if HAVE_DEVSTAT_GETDEVS
+#ifdef HAVE_DEVSTAT_GETDEVS
         struct bintime prev;
 #else
         struct timeval prev;
@@ -1093,7 +1093,7 @@ void devla_getstats(unsigned int regno, void *dummy) {
                 }
 
         for (i=0; i<ndevs; i++) {
-#if HAVE_DEVSTAT_GETDEVS
+#ifdef HAVE_DEVSTAT_GETDEVS
                 busy_time = devstat_compute_etime(&lastat->dinfo->devices[i].busy_time, &devloads[i].prev);
 #else
                 busy_time = devla_timeval_diff(&devloads[i].prev, &lastat->dinfo->devices[i].busy_time);
@@ -1189,14 +1189,14 @@ var_diskio(struct variable * vp,
         *var_len = strlen(stat->dinfo->devices[indx].device_name);
         return (u_char *) stat->dinfo->devices[indx].device_name;
     case DISKIO_NREAD:
-#if HAVE_DEVSTAT_GETDEVS
+#ifdef HAVE_DEVSTAT_GETDEVS
         long_ret = (signed long) stat->dinfo->devices[indx].bytes[DEVSTAT_READ] & 0xFFFFFFFF;
 #else
         long_ret = (signed long) stat->dinfo->devices[indx].bytes_read;
 #endif
         return (u_char *) & long_ret;
     case DISKIO_NWRITTEN:
-#if HAVE_DEVSTAT_GETDEVS
+#ifdef HAVE_DEVSTAT_GETDEVS
         long_ret = (signed long) stat->dinfo->devices[indx].bytes[DEVSTAT_WRITE] & 0xFFFFFFFF;
 #else
         long_ret = (signed long) stat->dinfo->devices[indx].bytes_written;
@@ -1204,7 +1204,7 @@ var_diskio(struct variable * vp,
         return (u_char *) & long_ret;
     case DISKIO_NREADX:
         *var_len = sizeof(struct counter64);
-#if HAVE_DEVSTAT_GETDEVS
+#ifdef HAVE_DEVSTAT_GETDEVS
         longlong_ret = stat->dinfo->devices[indx].bytes[DEVSTAT_READ];
 #else
         longlong_ret = stat->dinfo->devices[indx].bytes_read;
@@ -1214,7 +1214,7 @@ var_diskio(struct variable * vp,
         return (u_char *) & c64_ret;
     case DISKIO_NWRITTENX:
         *var_len = sizeof(struct counter64);
-#if HAVE_DEVSTAT_GETDEVS
+#ifdef HAVE_DEVSTAT_GETDEVS
         longlong_ret = stat->dinfo->devices[indx].bytes[DEVSTAT_WRITE];
 #else
         longlong_ret = stat->dinfo->devices[indx].bytes_written;
@@ -1223,14 +1223,14 @@ var_diskio(struct variable * vp,
         c64_ret.high = longlong_ret >> 32;
         return (u_char *) & c64_ret;
     case DISKIO_READS:
-#if HAVE_DEVSTAT_GETDEVS
+#ifdef HAVE_DEVSTAT_GETDEVS
         long_ret = (signed long) stat->dinfo->devices[indx].operations[DEVSTAT_READ] & 0xFFFFFFFF;
 #else
         long_ret = (signed long) stat->dinfo->devices[indx].num_reads;
 #endif
         return (u_char *) & long_ret;
     case DISKIO_WRITES:
-#if HAVE_DEVSTAT_GETDEVS
+#ifdef HAVE_DEVSTAT_GETDEVS
         long_ret = (signed long) stat->dinfo->devices[indx].operations[DEVSTAT_WRITE] & 0xFFFFFFFF;
 #else
         long_ret = (signed long) stat->dinfo->devices[indx].num_writes;
diff --git a/agent/mibgroup/ucd-snmp/dlmod.c b/agent/mibgroup/ucd-snmp/dlmod.c
index d69ca097fa..2cc87395b5 100644
--- a/agent/mibgroup/ucd-snmp/dlmod.c
+++ b/agent/mibgroup/ucd-snmp/dlmod.c
@@ -6,11 +6,11 @@
 #include <net-snmp/net-snmp-features.h>
 
 #include <ctype.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 #include <stdio.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/ucd-snmp/errormib.c b/agent/mibgroup/ucd-snmp/errormib.c
index 679839f14a..04ea4b8003 100644
--- a/agent/mibgroup/ucd-snmp/errormib.c
+++ b/agent/mibgroup/ucd-snmp/errormib.c
@@ -1,16 +1,16 @@
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_FCNTL_H
+#ifdef HAVE_FCNTL_H
 #include <fcntl.h>
 #endif
 #include <signal.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -23,7 +23,7 @@
 #ifdef HAVE_MACHINE_PARAM_H
 #include <machine/param.h>
 #endif
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
 #ifdef HAVE_SYS_VMMETER_H
@@ -82,13 +82,13 @@
 #include <sys/vfs.h>
 #endif
 #if (!defined(HAVE_STATVFS)) && defined(HAVE_STATFS)
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
-#if HAVE_SYS_MOUNT_H
+#ifdef HAVE_SYS_MOUNT_H
 #include <sys/mount.h>
 #endif
-#if HAVE_SYS_SYSCTL_H
+#ifdef HAVE_SYS_SYSCTL_H
 #include <sys/sysctl.h>
 #endif
 #define statvfs statfs
@@ -102,10 +102,10 @@
 #ifdef HAVE_SYS_FIXPOINT_H
 #include <sys/fixpoint.h>
 #endif
-#if HAVE_MALLOC_H
+#ifdef HAVE_MALLOC_H
 #include <malloc.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
 
diff --git a/agent/mibgroup/ucd-snmp/extensible.c b/agent/mibgroup/ucd-snmp/extensible.c
index 34de4ab029..8a027ddfdf 100644
--- a/agent/mibgroup/ucd-snmp/extensible.c
+++ b/agent/mibgroup/ucd-snmp/extensible.c
@@ -1,16 +1,16 @@
 #include <net-snmp/net-snmp-config.h>
 #include <net-snmp/net-snmp-features.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_FCNTL_H
+#ifdef HAVE_FCNTL_H
 #include <fcntl.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -24,7 +24,7 @@
 #ifdef HAVE_MACHINE_PARAM_H
 #include <machine/param.h>
 #endif
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
 #ifdef HAVE_SYS_VMMETER_H
@@ -73,10 +73,10 @@
 #include <sys/vfs.h>
 #endif
 #if (!defined(HAVE_STATVFS)) && defined(HAVE_STATFS)
-#if HAVE_SYS_MOUNT_H
+#ifdef HAVE_SYS_MOUNT_H
 #include <sys/mount.h>
 #endif
-#if HAVE_SYS_SYSCTL_H
+#ifdef HAVE_SYS_SYSCTL_H
 #include <sys/sysctl.h>
 #endif
 #define statvfs statfs
@@ -90,10 +90,10 @@
 #ifdef HAVE_SYS_FIXPOINT_H
 #include <sys/fixpoint.h>
 #endif
-#if HAVE_MALLOC_H
+#ifdef HAVE_MALLOC_H
 #include <malloc.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
 #include <ctype.h>
diff --git a/agent/mibgroup/ucd-snmp/file.c b/agent/mibgroup/ucd-snmp/file.c
index 9e345d8a5c..8623314fb1 100644
--- a/agent/mibgroup/ucd-snmp/file.c
+++ b/agent/mibgroup/ucd-snmp/file.c
@@ -11,7 +11,7 @@
 
 #include <sys/types.h>
 #include <sys/stat.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -21,11 +21,11 @@
 #  include <time.h>
 # endif
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
 
diff --git a/agent/mibgroup/ucd-snmp/hpux.c b/agent/mibgroup/ucd-snmp/hpux.c
index 9c5f9f9bc7..64e6dd19af 100644
--- a/agent/mibgroup/ucd-snmp/hpux.c
+++ b/agent/mibgroup/ucd-snmp/hpux.c
@@ -5,13 +5,13 @@
 #include <net-snmp/net-snmp-config.h>
 
 #include <signal.h>
-#if HAVE_MACHINE_PARAM_H
+#ifdef HAVE_MACHINE_PARAM_H
 #include <machine/param.h>
 #endif
-#if HAVE_SYS_VMMETER_H
+#ifdef HAVE_SYS_VMMETER_H
 #include <sys/vmmeter.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
 
diff --git a/agent/mibgroup/ucd-snmp/loadave.c b/agent/mibgroup/ucd-snmp/loadave.c
index 1ff26c2d77..9cfe2483dc 100644
--- a/agent/mibgroup/ucd-snmp/loadave.c
+++ b/agent/mibgroup/ucd-snmp/loadave.c
@@ -1,19 +1,19 @@
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_FCNTL_H
+#ifdef HAVE_FCNTL_H
 #include <fcntl.h>
 #endif
 #include <signal.h>
 #ifdef HAVE_MACHINE_PARAM_H
 #include <machine/param.h>
 #endif
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
 #ifdef HAVE_SYS_VMMETER_H
@@ -72,10 +72,10 @@
 #include <sys/vfs.h>
 #endif
 #if (!defined(HAVE_STATVFS)) && defined(HAVE_STATFS)
-#if HAVE_SYS_MOUNT_H
+#ifdef HAVE_SYS_MOUNT_H
 #include <sys/mount.h>
 #endif
-#if HAVE_SYS_SYSCTL_H
+#ifdef HAVE_SYS_SYSCTL_H
 #include <sys/sysctl.h>
 #endif
 #define statvfs statfs
@@ -92,13 +92,13 @@
 #ifdef HAVE_SYS_LOADAVG_H
 #include <sys/loadavg.h>
 #endif
-#if HAVE_MALLOC_H
+#ifdef HAVE_MALLOC_H
 #include <malloc.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/agent/mibgroup/ucd-snmp/memory_aix4.c b/agent/mibgroup/ucd-snmp/memory_aix4.c
index 786e5eba79..7c74cfd68a 100644
--- a/agent/mibgroup/ucd-snmp/memory_aix4.c
+++ b/agent/mibgroup/ucd-snmp/memory_aix4.c
@@ -17,10 +17,10 @@
  */
 
 #include <net-snmp/net-snmp-config.h>   /* local SNMP configuration details */
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 
diff --git a/agent/mibgroup/ucd-snmp/memory_darwin7.c b/agent/mibgroup/ucd-snmp/memory_darwin7.c
index 7fdfb58899..1578d33174 100644
--- a/agent/mibgroup/ucd-snmp/memory_darwin7.c
+++ b/agent/mibgroup/ucd-snmp/memory_darwin7.c
@@ -303,7 +303,7 @@ var_extensible_mem(struct variable *vp,
     case MEMSHARED:
     case MEMBUFFER:
     case MEMCACHED:
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_ret = -1;
@@ -385,12 +385,12 @@ int pages_swapped(void) {
 
                 /* Get memory region. */
                 count = VM_REGION_EXTENDED_INFO_COUNT;
-#if HAVE_VM_REGION_64
+#ifdef HAVE_VM_REGION_64
                 ret = vm_region64(tasks[j], &address, &size,
                                   VM_REGION_EXTENDED_INFO,
                                   (vm_region_extended_info_t)&info, &count,
                                   &object_name);
-#elif HAVE_VM_REGION
+#elif defined(HAVE_VM_REGION)
                 ret = vm_region(tasks[j], &address, &size,
                                 VM_REGION_EXTENDED_INFO,
                                 (vm_region_extended_info_t)&info, &count,
diff --git a/agent/mibgroup/ucd-snmp/memory_freebsd2.c b/agent/mibgroup/ucd-snmp/memory_freebsd2.c
index 22dde4c09e..927adcbea3 100644
--- a/agent/mibgroup/ucd-snmp/memory_freebsd2.c
+++ b/agent/mibgroup/ucd-snmp/memory_freebsd2.c
@@ -29,7 +29,7 @@
 #include <sys/sysctl.h>
 #include <sys/vmmeter.h>
 
-#if HAVE_SYS_VMPARAM_H
+#ifdef HAVE_SYS_VMPARAM_H
 #include <sys/vmparam.h>
 #else
 #include <vm/vm_param.h>
@@ -342,7 +342,7 @@ var_extensible_mem(struct variable *vp,
     case MEMUSEDSWAPTXT:
     case MEMTOTALREALTXT:
     case MEMUSEDREALTXT:
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_ret = -1;
diff --git a/agent/mibgroup/ucd-snmp/memory_hpux.c b/agent/mibgroup/ucd-snmp/memory_hpux.c
index c2b2478586..cbad70cb67 100644
--- a/agent/mibgroup/ucd-snmp/memory_hpux.c
+++ b/agent/mibgroup/ucd-snmp/memory_hpux.c
@@ -1,8 +1,8 @@
 #include <net-snmp/net-snmp-config.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 
diff --git a/agent/mibgroup/ucd-snmp/memory_netbsd1.c b/agent/mibgroup/ucd-snmp/memory_netbsd1.c
index 4fec88cb92..6a8dddc529 100644
--- a/agent/mibgroup/ucd-snmp/memory_netbsd1.c
+++ b/agent/mibgroup/ucd-snmp/memory_netbsd1.c
@@ -233,7 +233,7 @@ var_extensible_mem(struct variable *vp,
     case MEMUSEDSWAPTXT:
     case MEMTOTALREALTXT:
     case MEMUSEDREALTXT:
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_ret = -1;
diff --git a/agent/mibgroup/ucd-snmp/memory_solaris2.c b/agent/mibgroup/ucd-snmp/memory_solaris2.c
index 2d36278c92..8caa238c48 100644
--- a/agent/mibgroup/ucd-snmp/memory_solaris2.c
+++ b/agent/mibgroup/ucd-snmp/memory_solaris2.c
@@ -1,8 +1,8 @@
 #include <net-snmp/net-snmp-config.h>   /* local SNMP configuration details */
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 
diff --git a/agent/mibgroup/ucd-snmp/pass.c b/agent/mibgroup/ucd-snmp/pass.c
index 6411e0f20b..88e95d3e45 100644
--- a/agent/mibgroup/ucd-snmp/pass.c
+++ b/agent/mibgroup/ucd-snmp/pass.c
@@ -1,16 +1,16 @@
 #include <net-snmp/net-snmp-config.h>
 #include <net-snmp/net-snmp-features.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 #include <stdio.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include <ctype.h>
diff --git a/agent/mibgroup/ucd-snmp/pass_common.c b/agent/mibgroup/ucd-snmp/pass_common.c
index c1f8ef4a79..4c3d40e180 100644
--- a/agent/mibgroup/ucd-snmp/pass_common.c
+++ b/agent/mibgroup/ucd-snmp/pass_common.c
@@ -3,7 +3,7 @@
 #include <ctype.h>
 #include <stddef.h>
 #include <stdio.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/agent/mibgroup/ucd-snmp/pass_persist.c b/agent/mibgroup/ucd-snmp/pass_persist.c
index ea7e20ce87..15272d4ff8 100644
--- a/agent/mibgroup/ucd-snmp/pass_persist.c
+++ b/agent/mibgroup/ucd-snmp/pass_persist.c
@@ -4,15 +4,15 @@
 #ifdef HAVE_IO_H
 #include <io.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include <ctype.h>
diff --git a/agent/mibgroup/ucd-snmp/proc.c b/agent/mibgroup/ucd-snmp/proc.c
index 01704e8f39..ea5b186b73 100644
--- a/agent/mibgroup/ucd-snmp/proc.c
+++ b/agent/mibgroup/ucd-snmp/proc.c
@@ -9,18 +9,18 @@
 #ifdef HAVE_IO_H                   /* win32 */
 #include <io.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_MALLOC_H
+#ifdef HAVE_MALLOC_H
 #include <malloc.h>
 #endif
 #include <math.h>
@@ -29,7 +29,7 @@
 #ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/agent/mibgroup/ucd-snmp/proxy.c b/agent/mibgroup/ucd-snmp/proxy.c
index 46ca65bdf6..9ab7effdbc 100644
--- a/agent/mibgroup/ucd-snmp/proxy.c
+++ b/agent/mibgroup/ucd-snmp/proxy.c
@@ -17,10 +17,10 @@
 #include <net-snmp/net-snmp-features.h>
 
 #include <sys/types.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #ifdef HAVE_NETINET_IN_H
diff --git a/agent/mibgroup/ucd-snmp/versioninfo.c b/agent/mibgroup/ucd-snmp/versioninfo.c
index 4d727d13ce..ddf8c95665 100644
--- a/agent/mibgroup/ucd-snmp/versioninfo.c
+++ b/agent/mibgroup/ucd-snmp/versioninfo.c
@@ -2,7 +2,7 @@
 #include <net-snmp/net-snmp-features.h>
 
 #include <sys/types.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -15,7 +15,7 @@
 #ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
 
diff --git a/agent/mibgroup/ucd-snmp/vmstat_bsdi4.c b/agent/mibgroup/ucd-snmp/vmstat_bsdi4.c
index e35b6cd1ba..4abccb223d 100644
--- a/agent/mibgroup/ucd-snmp/vmstat_bsdi4.c
+++ b/agent/mibgroup/ucd-snmp/vmstat_bsdi4.c
@@ -224,13 +224,13 @@ var_extensible_vmstat(struct variable *vp,
         long_ret = rate(long_ret);
         return ((u_char *) (&long_ret));
     case IOSENT:
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_ret = -1;
         return ((u_char *) (&long_ret));
     case IORECEIVE:
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_ret = -1;
diff --git a/agent/mibgroup/ucd-snmp/vmstat_darwin7.c b/agent/mibgroup/ucd-snmp/vmstat_darwin7.c
index d96c55c677..87f77981be 100644
--- a/agent/mibgroup/ucd-snmp/vmstat_darwin7.c
+++ b/agent/mibgroup/ucd-snmp/vmstat_darwin7.c
@@ -20,7 +20,7 @@
 #include <sys/sysctl.h>
 #include <sys/vmmeter.h>
 
-#if HAVE_SYS_VMPARAM_H
+#ifdef HAVE_SYS_VMPARAM_H
 #include <sys/vmparam.h>
 #else
 #include <vm/vm_param.h>
@@ -254,13 +254,13 @@ var_extensible_vmstat(struct variable *vp,
         long_ret = rate(long_ret);
         return ((u_char *) (&long_ret));
     case IOSENT:
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_ret = -1;
         return ((u_char *) (&long_ret));
     case IORECEIVE:
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_ret = -1;
diff --git a/agent/mibgroup/ucd-snmp/vmstat_freebsd2.c b/agent/mibgroup/ucd-snmp/vmstat_freebsd2.c
index 3de89b20b3..f8d9c0aa6c 100644
--- a/agent/mibgroup/ucd-snmp/vmstat_freebsd2.c
+++ b/agent/mibgroup/ucd-snmp/vmstat_freebsd2.c
@@ -34,7 +34,7 @@
 #include <sys/sysctl.h>
 #include <sys/vmmeter.h>
 
-#if HAVE_SYS_VMPARAM_H
+#ifdef HAVE_SYS_VMPARAM_H
 #include <sys/vmparam.h>
 #else
 #include <vm/vm_param.h>
@@ -294,13 +294,13 @@ var_extensible_vmstat(struct variable *vp,
         long_ret = rate(long_ret);
         return ((u_char *) (&long_ret));
     case IOSENT:
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_ret = -1;
         return ((u_char *) (&long_ret));
     case IORECEIVE:
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_ret = -1;
diff --git a/agent/mibgroup/ucd-snmp/vmstat_linux.c b/agent/mibgroup/ucd-snmp/vmstat_linux.c
index fa7032e5d5..a2eeb8ccbc 100644
--- a/agent/mibgroup/ucd-snmp/vmstat_linux.c
+++ b/agent/mibgroup/ucd-snmp/vmstat_linux.c
@@ -1,35 +1,35 @@
 #include <net-snmp/net-snmp-config.h>
 #include <net-snmp/net-snmp-features.h>
 
-#if HAVE_LIMITS_H
+#ifdef HAVE_LIMITS_H
 #include <limits.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_FCNTL_H
+#ifdef HAVE_FCNTL_H
 #include <fcntl.h>
 #endif
 #include <ctype.h>
 #include <signal.h>
-#if HAVE_MACHINE_PARAM_H
+#ifdef HAVE_MACHINE_PARAM_H
 #include <machine/param.h>
 #endif
-#if HAVE_SYS_VMMETER_H
+#ifdef HAVE_SYS_VMMETER_H
 #if !defined(bsdi2) && !defined(netbsd1)
 #include <sys/vmmeter.h>
 #endif
 #endif
-#if HAVE_SYS_CONF_H
+#ifdef HAVE_SYS_CONF_H
 #include <sys/conf.h>
 #endif
-#if HAVE_SYS_FS_H
+#ifdef HAVE_SYS_FS_H
 #include <sys/fs.h>
 #else
-#if HAVE_UFS_FS_H
+#ifdef HAVE_UFS_FS_H
 #include <ufs/fs.h>
 #else
 #ifdef HAVE_SYS_STAT_H
@@ -44,52 +44,52 @@
 #ifdef HAVE_UFS_UFS_INODE_H
 #include <ufs/ufs/inode.h>
 #endif
-#if HAVE_UFS_FFS_FS_H
+#ifdef HAVE_UFS_FFS_FS_H
 #include <ufs/ffs/fs.h>
 #endif
 #endif
 #endif
-#if HAVE_MTAB_H
+#ifdef HAVE_MTAB_H
 #include <mtab.h>
 #endif
 #include <sys/stat.h>
 #include <errno.h>
-#if HAVE_FSTAB_H
+#ifdef HAVE_FSTAB_H
 #include <fstab.h>
 #endif
-#if HAVE_SYS_STATVFS_H
+#ifdef HAVE_SYS_STATVFS_H
 #include <sys/statvfs.h>
 #endif
-#if HAVE_SYS_VFS_H
+#ifdef HAVE_SYS_VFS_H
 #include <sys/vfs.h>
 #endif
 #if (!defined(HAVE_STATVFS)) && defined(HAVE_STATFS)
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
-#if HAVE_SYS_MOUNT_H
+#ifdef HAVE_SYS_MOUNT_H
 #include <sys/mount.h>
 #endif
-#if HAVE_SYS_SYSCTL_H
+#ifdef HAVE_SYS_SYSCTL_H
 #include <sys/sysctl.h>
 #endif
 #define statvfs statfs
 #endif
-#if HAVE_VM_SWAP_PAGER_H
+#ifdef HAVE_VM_SWAP_PAGER_H
 #include <vm/swap_pager.h>
 #endif
-#if HAVE_SYS_FIXPOINT_H
+#ifdef HAVE_SYS_FIXPOINT_H
 #include <sys/fixpoint.h>
 #endif
-#if HAVE_MALLOC_H
+#ifdef HAVE_MALLOC_H
 #include <malloc.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/agent/mibgroup/ucd-snmp/vmstat_netbsd1.c b/agent/mibgroup/ucd-snmp/vmstat_netbsd1.c
index 9706c42a45..c06300fc07 100644
--- a/agent/mibgroup/ucd-snmp/vmstat_netbsd1.c
+++ b/agent/mibgroup/ucd-snmp/vmstat_netbsd1.c
@@ -258,13 +258,13 @@ var_extensible_vmstat(struct variable *vp,
         long_ret = rate(long_ret);
         return ((u_char *) (&long_ret));
     case IOSENT:
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_ret = -1;
         return ((u_char *) (&long_ret));
     case IORECEIVE:
-#if NETSNMP_NO_DUMMY_VALUES
+#ifdef NETSNMP_NO_DUMMY_VALUES
         return NULL;
 #endif
         long_ret = -1;
diff --git a/agent/mibgroup/udp-mib/data_access/udp_endpoint_freebsd4.c b/agent/mibgroup/udp-mib/data_access/udp_endpoint_freebsd4.c
index 53e17a9f11..814df69c3d 100644
--- a/agent/mibgroup/udp-mib/data_access/udp_endpoint_freebsd4.c
+++ b/agent/mibgroup/udp-mib/data_access/udp_endpoint_freebsd4.c
@@ -13,10 +13,10 @@
 
 #include "mibII/mibII_common.h"
 
-#if HAVE_NETINET_UDP_H
+#ifdef HAVE_NETINET_UDP_H
 #include <netinet/udp.h>
 #endif
-#if HAVE_NETINET_UDP_VAR_H
+#ifdef HAVE_NETINET_UDP_VAR_H
 #include <netinet/udp_var.h>
 #endif
 
diff --git a/agent/mibgroup/udp-mib/data_access/udp_endpoint_netbsd.c b/agent/mibgroup/udp-mib/data_access/udp_endpoint_netbsd.c
index f68314b776..62891e8da6 100644
--- a/agent/mibgroup/udp-mib/data_access/udp_endpoint_netbsd.c
+++ b/agent/mibgroup/udp-mib/data_access/udp_endpoint_netbsd.c
@@ -15,10 +15,10 @@
 
 #include "mibII/mibII_common.h"
 
-#if HAVE_NETINET_UDP_H
+#ifdef HAVE_NETINET_UDP_H
 #include <netinet/udp.h>
 #endif
-#if HAVE_NETINET_UDP_VAR_H
+#ifdef HAVE_NETINET_UDP_VAR_H
 #include <netinet/udp_var.h>
 #endif
 
diff --git a/agent/mibgroup/udp-mib/data_access/udp_endpoint_openbsd.c b/agent/mibgroup/udp-mib/data_access/udp_endpoint_openbsd.c
index 727087acd5..ae1da66c75 100644
--- a/agent/mibgroup/udp-mib/data_access/udp_endpoint_openbsd.c
+++ b/agent/mibgroup/udp-mib/data_access/udp_endpoint_openbsd.c
@@ -14,20 +14,20 @@
 
 #include "mibII/mibII_common.h"
 
-#if HAVE_NETINET_UDP_H
+#ifdef HAVE_NETINET_UDP_H
 #include <netinet/udp.h>
 #endif
-#if HAVE_NETINET_UDP_VAR_H
+#ifdef HAVE_NETINET_UDP_VAR_H
 #include <netinet/udp_var.h>
 #endif
 
-#if HAVE_KVM_GETFILES
+#ifdef HAVE_KVM_GETFILES
 #if defined(HAVE_KVM_GETFILE2) || !defined(openbsd5)
 #undef HAVE_KVM_GETFILES
 #endif
 #endif
 
-#if HAVE_KVM_GETFILES
+#ifdef HAVE_KVM_GETFILES
 #include <kvm.h>
 #include <sys/sysctl.h>
 #define _KERNEL /* for DTYPE_SOCKET */
diff --git a/agent/mibgroup/util_funcs.c b/agent/mibgroup/util_funcs.c
index 31e607a40c..d289c9b71c 100644
--- a/agent/mibgroup/util_funcs.c
+++ b/agent/mibgroup/util_funcs.c
@@ -24,10 +24,10 @@
 #include <spawn.h>
 #endif
 #include <stdio.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_MALLOC_H
+#ifdef HAVE_MALLOC_H
 #include <malloc.h>
 #endif
 #ifdef __alpha
@@ -51,7 +51,7 @@
 #ifndef WIFEXITED
 # define WIFEXITED(stat_val) (((stat_val) & 255) == 0)
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -61,15 +61,15 @@
 #  include <time.h>
 # endif
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_FCNTL_H
+#ifdef HAVE_FCNTL_H
 #include <fcntl.h>
 #endif
 #include <errno.h>
 #include <signal.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -110,7 +110,7 @@ typedef __u8 u8;           /* ditto */
 #include "util_funcs.h"
 #include "utilities/execute.h"
 
-#if HAVE_LIMITS_H
+#ifdef HAVE_LIMITS_H
 #include "limits.h"
 #endif
 #ifdef USING_UCD_SNMP_ERRORMIB_MODULE
@@ -153,7 +153,7 @@ make_tempfile(void)
 int
 shell_command(struct extensible *ex)
 {
-#if HAVE_SYSTEM
+#ifdef HAVE_SYSTEM
     const char     *ofname;
     char           *shellline = NULL;
     FILE           *shellout;
diff --git a/agent/mibgroup/util_funcs/Exit.c b/agent/mibgroup/util_funcs/Exit.c
index c848fd8bf2..540453bcd9 100644
--- a/agent/mibgroup/util_funcs/Exit.c
+++ b/agent/mibgroup/util_funcs/Exit.c
@@ -7,7 +7,7 @@
 
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 
diff --git a/agent/mibgroup/util_funcs/get_pid_from_inode.h b/agent/mibgroup/util_funcs/get_pid_from_inode.h
index ad887a7726..6b5a9280ae 100644
--- a/agent/mibgroup/util_funcs/get_pid_from_inode.h
+++ b/agent/mibgroup/util_funcs/get_pid_from_inode.h
@@ -11,7 +11,7 @@ config_error(get_pid_from_inode is only suppored on linux)
 
 #define _LARGEFILE64_SOURCE 1
 
-#if HAVE_DIRENT_H
+#ifdef HAVE_DIRENT_H
 #include <dirent.h>
 #else
 # define dirent direct
diff --git a/agent/mibgroup/util_funcs/restart.c b/agent/mibgroup/util_funcs/restart.c
index 0e8fbacb74..a8f9d4d5b2 100644
--- a/agent/mibgroup/util_funcs/restart.c
+++ b/agent/mibgroup/util_funcs/restart.c
@@ -10,7 +10,7 @@
 
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include <signal.h>
@@ -47,21 +47,21 @@ restart_doit(int a)
      *  The use of sigprocmask() is unspecified in a multithreaded process; see
      *  pthread_sigmask(3).
      */
-#if HAVE_SIGPROCMASK
+#ifdef HAVE_SIGPROCMASK
     {
         sigset_t empty_set;
 
         sigemptyset(&empty_set);
         sigprocmask(SIG_SETMASK, &empty_set, NULL);
     }
-#elif HAVE_SIGBLOCK
+#elif defined(HAVE_SIGBLOCK)
     sigsetmask(0);
 #endif
 
     /*
      * do the exec
      */
-#if HAVE_EXECV
+#ifdef HAVE_EXECV
     execv(argvrestartname, argvrestartp);
     setPerrorstatus(argvrestartname);
 #endif
diff --git a/agent/mibgroup/utilities/execute.c b/agent/mibgroup/utilities/execute.c
index e40bfa277a..98c0484d17 100644
--- a/agent/mibgroup/utilities/execute.c
+++ b/agent/mibgroup/utilities/execute.c
@@ -8,18 +8,18 @@
 #include <io.h>
 #endif
 #include <stdio.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_MALLOC_H
+#ifdef HAVE_MALLOC_H
 #include <malloc.h>
 #endif
 #include <sys/types.h>
 #include <ctype.h>
-#if HAVE_FCNTL_H
+#ifdef HAVE_FCNTL_H
 #include <fcntl.h>
 #endif
 #ifdef HAVE_SYS_WAIT_H
@@ -62,7 +62,7 @@ int
 run_shell_command(const char *command, const char *input,
                   char *output, int *out_len)
 {
-#if HAVE_SYSTEM
+#ifdef HAVE_SYSTEM
     int         result;    /* and the return value of the command */
 
     if (!command)
diff --git a/agent/netsnmp_close_fds.c b/agent/netsnmp_close_fds.c
index 8b75e97cd1..2e2f46e5a4 100644
--- a/agent/netsnmp_close_fds.c
+++ b/agent/netsnmp_close_fds.c
@@ -1,10 +1,10 @@
 #include <net-snmp/net-snmp-config.h>
 
 #include <stdio.h>
-#if HAVE_DIRENT_H
+#ifdef HAVE_DIRENT_H
 #include <dirent.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/agent/snmp_agent.c b/agent/snmp_agent.c
index 3f678fe2df..b6be0f1dd4 100644
--- a/agent/snmp_agent.c
+++ b/agent/snmp_agent.c
@@ -54,13 +54,13 @@ SOFTWARE.
 #ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/agent/snmp_vars.c b/agent/snmp_vars.c
index ba94232965..4f0c49c08a 100644
--- a/agent/snmp_vars.c
+++ b/agent/snmp_vars.c
@@ -61,13 +61,13 @@ PERFORMANCE OF THIS SOFTWARE.
  */
 
 #include <net-snmp/net-snmp-config.h>
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 #include <sys/types.h>
@@ -75,7 +75,7 @@ PERFORMANCE OF THIS SOFTWARE.
 #include <fcntl.h>
 #include <errno.h>
 
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/agent/snmpd.c b/agent/snmpd.c
index 90de12d994..049f98ac37 100644
--- a/agent/snmpd.c
+++ b/agent/snmpd.c
@@ -44,15 +44,15 @@
 #endif
 #include <stdio.h>
 #include <errno.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include <sys/types.h>
@@ -62,7 +62,7 @@
 #ifdef HAVE_ARPA_INET_H
 #include <arpa/inet.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -87,7 +87,7 @@
 #ifdef HAVE_SYS_IOCTL_H
 #include <sys/ioctl.h>
 #endif
-#if HAVE_SYS_FILE_H
+#ifdef HAVE_SYS_FILE_H
 #include <sys/file.h>
 #endif
 #ifdef HAVE_FCNTL_H
@@ -103,7 +103,7 @@
 #ifdef HAVE_PROCESS_H
 #include <process.h>
 #endif
-#if HAVE_LIMITS_H
+#ifdef HAVE_LIMITS_H
 #include <limits.h>
 #endif
 #ifdef HAVE_PWD_H
@@ -236,7 +236,7 @@ usage(char *prog)
 	   "\t\t\t  Don't put space(s) between -D and TOKEN(s).\n"
 #endif
            "  -f\t\t\tdo not fork from the shell\n",
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
            "  -g GID\t\tchange to this numeric gid after opening\n"
 	   "\t\t\t  transport endpoints\n"
 #endif
@@ -264,7 +264,7 @@ usage(char *prog)
            "  \t\t\t  (followed by the startup parameter list)\n"
            "  \t\t\t  Note that some parameters are not relevant when running as a service\n"
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
            "  -u UID\t\tchange to this uid (numeric or textual) after\n"
 	   "\t\t\t  opening transport endpoints\n"
 #endif
@@ -383,7 +383,7 @@ main(int argc, char *argv[])
 #endif
 {
     static const char options[] = "aAc:CdD::fhHI:l:L:m:M:n:p:P:qrsS:UvV-:Y:"
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
         "g:u:"
 #endif
 #if defined(USING_AGENTX_SUBAGENT_MODULE)|| defined(USING_AGENTX_MASTER_MODULE)
@@ -402,7 +402,7 @@ main(int argc, char *argv[])
 #ifndef WIN32
     int             prepared_sockets = 0;
 #endif
-#if HAVE_GETPID
+#ifdef HAVE_GETPID
     int fd;
     FILE           *PID;
 #endif
@@ -549,7 +549,7 @@ main(int argc, char *argv[])
             dont_fork = 1;
             break;
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
         case 'g':
             if (optarg != NULL) {
                 char           *ecp;
@@ -727,7 +727,7 @@ main(int argc, char *argv[])
 				      NETSNMP_DS_AGENT_LEAVE_PIDFILE);
             break;
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
         case 'u':
             if (optarg != NULL) {
                 char           *ecp;
@@ -938,7 +938,7 @@ main(int argc, char *argv[])
         }
     }
 
-#if HAVE_GETPID
+#ifdef HAVE_GETPID
     if (pid_file != NULL) {
         /*
          * unlink the pid_file, if it exists, prior to open.  Without
diff --git a/apps/encode_keychange.c b/apps/encode_keychange.c
index 850d202cd4..7baa6ae898 100644
--- a/apps/encode_keychange.c
+++ b/apps/encode_keychange.c
@@ -26,10 +26,10 @@
 #include <ctype.h>
 #include <sys/types.h>
 #include <sys/stat.h>
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/apps/snmpbulkget.c b/apps/snmpbulkget.c
index 2d89ce1425..7742b0b97f 100644
--- a/apps/snmpbulkget.c
+++ b/apps/snmpbulkget.c
@@ -25,13 +25,13 @@ SOFTWARE.
 **********************************************************************/
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -41,7 +41,7 @@ SOFTWARE.
 #ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/apps/snmpbulkwalk.c b/apps/snmpbulkwalk.c
index f10071d48f..8d84b328a9 100644
--- a/apps/snmpbulkwalk.c
+++ b/apps/snmpbulkwalk.c
@@ -26,13 +26,13 @@ SOFTWARE.
 **********************************************************************/
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -41,7 +41,7 @@ SOFTWARE.
 #ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/apps/snmpdelta.c b/apps/snmpdelta.c
index 74ebd801bc..ee2966606b 100644
--- a/apps/snmpdelta.c
+++ b/apps/snmpdelta.c
@@ -28,13 +28,13 @@
 
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -45,7 +45,7 @@
 #endif
 #include <stdio.h>
 #include <ctype.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/apps/snmpdf.c b/apps/snmpdf.c
index 2aeab47c49..45c1c6d02d 100644
--- a/apps/snmpdf.c
+++ b/apps/snmpdf.c
@@ -36,13 +36,13 @@ SOFTWARE.
  */
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -53,7 +53,7 @@ SOFTWARE.
 #endif
 #include <stdio.h>
 #include <ctype.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/apps/snmpget.c b/apps/snmpget.c
index 79027d87a9..ffdbe69966 100644
--- a/apps/snmpget.c
+++ b/apps/snmpget.c
@@ -25,13 +25,13 @@ SOFTWARE.
 ******************************************************************/
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -42,7 +42,7 @@ SOFTWARE.
 #endif
 #include <stdio.h>
 #include <ctype.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/apps/snmpgetnext.c b/apps/snmpgetnext.c
index d8867dc09b..da2a0369b5 100644
--- a/apps/snmpgetnext.c
+++ b/apps/snmpgetnext.c
@@ -25,13 +25,13 @@ SOFTWARE.
 ******************************************************************/
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -42,7 +42,7 @@ SOFTWARE.
 #endif
 #include <stdio.h>
 #include <ctype.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/apps/snmpnetstat/if.c b/apps/snmpnetstat/if.c
index b53439bacf..b4d7f8f39e 100755
--- a/apps/snmpnetstat/if.c
+++ b/apps/snmpnetstat/if.c
@@ -38,7 +38,7 @@
 #include <net-snmp/net-snmp-includes.h>
 
 #include <stdint.h>
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #ifdef HAVE_NET_IF_H
diff --git a/apps/snmpnetstat/inet.c b/apps/snmpnetstat/inet.c
index 6b9c9e7be7..f27c0d8b1a 100644
--- a/apps/snmpnetstat/inet.c
+++ b/apps/snmpnetstat/inet.c
@@ -37,7 +37,7 @@
 #include <net-snmp/net-snmp-config.h>
 
 #include <stdint.h>
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #ifdef HAVE_WINSOCK_H
diff --git a/apps/snmpnetstat/inet6.c b/apps/snmpnetstat/inet6.c
index 034499d18b..574ca6dbdc 100644
--- a/apps/snmpnetstat/inet6.c
+++ b/apps/snmpnetstat/inet6.c
@@ -35,7 +35,7 @@
 
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #ifdef HAVE_WINSOCK_H
@@ -47,7 +47,7 @@
 #ifdef HAVE_NETDB_H
 #include <netdb.h>
 #endif
-#if HAVE_SYS_TYPES_H
+#ifdef HAVE_SYS_TYPES_H
 #include <sys/types.h>
 #endif
 
diff --git a/apps/snmpnetstat/inetx.c b/apps/snmpnetstat/inetx.c
index 8f78f4bd92..153b39c389 100644
--- a/apps/snmpnetstat/inetx.c
+++ b/apps/snmpnetstat/inetx.c
@@ -35,7 +35,7 @@
 
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #ifdef HAVE_WINSOCK_H
@@ -47,7 +47,7 @@
 #ifdef HAVE_NETDB_H
 #include <netdb.h>
 #endif
-#if HAVE_SYS_TYPES_H
+#ifdef HAVE_SYS_TYPES_H
 #include <sys/types.h>
 #endif
 
diff --git a/apps/snmpnetstat/main.c b/apps/snmpnetstat/main.c
index a13f874f9d..d8c78d208c 100644
--- a/apps/snmpnetstat/main.c
+++ b/apps/snmpnetstat/main.c
@@ -43,7 +43,7 @@ char            copyright[] = "@(#) Copyright (c) 1983, 1988, 1993\n\
 #include <net-snmp/net-snmp-includes.h>
 #include <net-snmp/utilities.h>
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #ifdef HAVE_NETDB_H
diff --git a/apps/snmpnetstat/route.c b/apps/snmpnetstat/route.c
index 75226c0d7b..02cb15a11a 100644
--- a/apps/snmpnetstat/route.c
+++ b/apps/snmpnetstat/route.c
@@ -36,7 +36,7 @@
 
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_SYS_TYPES_H
+#ifdef HAVE_SYS_TYPES_H
 #include <sys/types.h>
 #endif
 
@@ -49,7 +49,7 @@
 
 #include <net-snmp/net-snmp-includes.h>
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #ifdef HAVE_NETDB_H
diff --git a/apps/snmpnetstat/routex.c b/apps/snmpnetstat/routex.c
index 70fb0a69f6..0cce8757a2 100644
--- a/apps/snmpnetstat/routex.c
+++ b/apps/snmpnetstat/routex.c
@@ -36,7 +36,7 @@
 
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_SYS_TYPES_H
+#ifdef HAVE_SYS_TYPES_H
 #include <sys/types.h>
 #endif
 
@@ -51,7 +51,7 @@
 
 netsnmp_feature_require(sockaddr_size);
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #ifdef HAVE_NETDB_H
diff --git a/apps/snmpnetstat/winstub.c b/apps/snmpnetstat/winstub.c
index e88c5d612f..d0823b3667 100644
--- a/apps/snmpnetstat/winstub.c
+++ b/apps/snmpnetstat/winstub.c
@@ -19,10 +19,10 @@
 
 #include <stdio.h>
 #include <sys/types.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
 #ifdef HAVE_NETINET_IN_H
diff --git a/apps/snmpping.c b/apps/snmpping.c
index 9bebc7e0ee..6003e84e73 100644
--- a/apps/snmpping.c
+++ b/apps/snmpping.c
@@ -56,7 +56,7 @@
 #ifdef HAVE_NETDB_H
 #include <netdb.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #ifdef HAVE_IO_H
diff --git a/apps/snmpps.c b/apps/snmpps.c
index 76a0a2c905..1ff966341e 100644
--- a/apps/snmpps.c
+++ b/apps/snmpps.c
@@ -48,7 +48,7 @@ SOFTWARE.
 #endif
 #include <stdio.h>
 #include <ctype.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -69,7 +69,7 @@ SOFTWARE.
 #endif
 #ifdef HAVE_NCURSES_CURSES_H
 #include <ncurses/curses.h>
-#elif HAVE_CURSES_H
+#elif defined(HAVE_CURSES_H)
 #include <curses.h>
 #endif
 #include <signal.h>
diff --git a/apps/snmpset.c b/apps/snmpset.c
index d542713e1b..9172b4b5b7 100644
--- a/apps/snmpset.c
+++ b/apps/snmpset.c
@@ -25,13 +25,13 @@ SOFTWARE.
 ******************************************************************/
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -42,7 +42,7 @@ SOFTWARE.
 #endif
 #include <stdio.h>
 #include <ctype.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/apps/snmpstatus.c b/apps/snmpstatus.c
index 1f0d9bff55..3e959e1b8d 100644
--- a/apps/snmpstatus.c
+++ b/apps/snmpstatus.c
@@ -26,13 +26,13 @@ SOFTWARE.
 ******************************************************************/
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -43,7 +43,7 @@ SOFTWARE.
 #endif
 #include <stdio.h>
 #include <ctype.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/apps/snmptable.c b/apps/snmptable.c
index 570c074f6c..5fa7ad5d1f 100644
--- a/apps/snmptable.c
+++ b/apps/snmptable.c
@@ -27,13 +27,13 @@ SOFTWARE.
 ******************************************************************/
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -42,7 +42,7 @@ SOFTWARE.
 #ifdef HAVE_NETINET_IN_H
 # include <netinet/in.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/apps/snmptest.c b/apps/snmptest.c
index 42c780e9e5..043ded8050 100644
--- a/apps/snmptest.c
+++ b/apps/snmptest.c
@@ -27,13 +27,13 @@ SOFTWARE.
 ******************************************************************/
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -44,7 +44,7 @@ SOFTWARE.
 #endif
 #include <stdio.h>
 #include <ctype.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/apps/snmptls.c b/apps/snmptls.c
index dc1202eb29..709fd960f9 100644
--- a/apps/snmptls.c
+++ b/apps/snmptls.c
@@ -13,7 +13,7 @@ netsnmp_feature_require(tls_fingerprint_build);
 netsnmp_feature_require(row_create);
 
 #include <ctype.h>
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/apps/snmptranslate.c b/apps/snmptranslate.c
index d7cbcaab86..d7773e779e 100644
--- a/apps/snmptranslate.c
+++ b/apps/snmptranslate.c
@@ -30,13 +30,13 @@ SOFTWARE.
 
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/apps/snmptrap.c b/apps/snmptrap.c
index ec49de3987..bd76bcaf05 100644
--- a/apps/snmptrap.c
+++ b/apps/snmptrap.c
@@ -25,13 +25,13 @@ SOFTWARE.
 ******************************************************************/
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -40,7 +40,7 @@ SOFTWARE.
 #ifdef HAVE_NETINET_IN_H
 # include <netinet/in.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/apps/snmptrapd.c b/apps/snmptrapd.c
index fa31f21e2c..0400126046 100644
--- a/apps/snmptrapd.c
+++ b/apps/snmptrapd.c
@@ -25,13 +25,13 @@ SOFTWARE.
 ******************************************************************/
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -61,7 +61,7 @@ SOFTWARE.
 #ifdef HAVE_SYS_SELECT_H
 #include <sys/select.h>
 #endif
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
 #ifdef HAVE_SYSLOG_H
@@ -79,7 +79,7 @@ SOFTWARE.
 #ifdef HAVE_ARPA_INET_H
 #include <arpa/inet.h>
 #endif
-#if HAVE_FCNTL_H
+#ifdef HAVE_FCNTL_H
 #include <fcntl.h>
 #endif
 #ifdef HAVE_PROCESS_H
@@ -145,7 +145,7 @@ char           *logfile = NULL;
 static int      reconfig = 0;
 char            ddefault_port[] = "udp:162";	/* Default default port */
 char           *default_port = ddefault_port;
-#if HAVE_GETPID
+#ifdef HAVE_GETPID
     FILE           *PID;
     char           *pid_file = NULL;
 #endif
@@ -201,7 +201,7 @@ usage(void)
     fprintf(stderr, "  -f\t\t\tdo not fork from the shell\n");
     fprintf(stderr,
             "  -F FORMAT\t\tuse specified format for logging to standard error\n");
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
     fprintf(stderr, "  -g GID\t\tchange to this numeric gid after opening\n"
 	   "\t\t\t  transport endpoints\n");
 #endif
@@ -214,7 +214,7 @@ usage(void)
             "  -M DIRLIST\t\tuse DIRLIST as the list of locations\n\t\t\t  to look for MIBs\n");
     fprintf(stderr,
             "  -n\t\t\tuse numeric addresses instead of attempting\n\t\t\t  hostname lookups (no DNS)\n");
-#if HAVE_GETPID
+#ifdef HAVE_GETPID
     fprintf(stderr, "  -p FILE\t\tstore process id in FILE\n");
 #endif
 #ifdef WIN32SERVICE
@@ -224,7 +224,7 @@ usage(void)
     fprintf(stderr, "  \t\t\t  Note that some parameters are not relevant when running as a service\n");
 #endif
     fprintf(stderr, "  -t\t\t\tPrevent traps from being logged to syslog\n");
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
     fprintf(stderr, "  -u UID\t\tchange to this uid (numeric or textual) after\n"
 	   "\t\t\t  opening transport endpoints\n");
 #endif
@@ -541,7 +541,7 @@ main(int argc, char *argv[])
 #endif
 {
     static const char options[] = "aAc:CdD::efF:g:hHI:L:m:M:no:O:Ptu:vx:X-:"
-#if HAVE_GETPID
+#ifdef HAVE_GETPID
         "p:"
 #endif
         ;
@@ -601,7 +601,7 @@ main(int argc, char *argv[])
 
     register_config_handler("snmptrapd", "doNotLogTraps",
                             parse_config_doNotLogTraps, NULL, "(1|yes|true|0|no|false)");
-#if HAVE_GETPID
+#ifdef HAVE_GETPID
     register_config_handler("snmptrapd", "pidFile",
                             parse_config_pidFile, NULL, "string");
 #endif
@@ -709,7 +709,7 @@ main(int argc, char *argv[])
             }
             break;
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
         case 'g':
             if (optarg != NULL) {
                 int gid;
@@ -814,7 +814,7 @@ main(int argc, char *argv[])
             }
             break;
 
-#if HAVE_GETPID
+#ifdef HAVE_GETPID
         case 'p':
             if (optarg != NULL) {
                 parse_config_pidFile(NULL, optarg);
@@ -839,7 +839,7 @@ main(int argc, char *argv[])
             SyslogTrap++;
             break;
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
         case 'u':
             if (optarg != NULL) {
                 int             uid;
@@ -1175,7 +1175,7 @@ main(int argc, char *argv[])
         }
     }
 #endif                          /* WIN32 */
-#if HAVE_GETPID
+#ifdef HAVE_GETPID
     if (pid_file != NULL) {
         if ((PID = fopen(pid_file, "w")) == NULL) {
             snmp_log_perror("fopen");
@@ -1194,7 +1194,7 @@ main(int argc, char *argv[])
      */
     reconfig = 0;
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #ifdef HAVE_SETGID
     {
     int gid;
diff --git a/apps/snmptrapd_auth.c b/apps/snmptrapd_auth.c
index 06b8488c9d..892fe499a6 100644
--- a/apps/snmptrapd_auth.c
+++ b/apps/snmptrapd_auth.c
@@ -9,7 +9,7 @@
  */
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_SYS_TYPES_H
+#ifdef HAVE_SYS_TYPES_H
 #include <sys/types.h>
 #endif
 #ifdef HAVE_NETINET_IN_H
diff --git a/apps/snmptrapd_handlers.c b/apps/snmptrapd_handlers.c
index 8e42b5aea6..9496d310ef 100644
--- a/apps/snmptrapd_handlers.c
+++ b/apps/snmptrapd_handlers.c
@@ -1,14 +1,14 @@
 #include <net-snmp/net-snmp-config.h>
 #include <net-snmp/net-snmp-features.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include <stdio.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/apps/snmptrapd_log.c b/apps/snmptrapd_log.c
index 50e48f7b89..4d1b5da62d 100644
--- a/apps/snmptrapd_log.c
+++ b/apps/snmptrapd_log.c
@@ -25,13 +25,13 @@ SOFTWARE.
 ******************************************************************/
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -62,7 +62,7 @@ SOFTWARE.
 #ifdef HAVE_SYS_SELECT_H
 #include <sys/select.h>
 #endif
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
 #ifdef HAVE_SYSLOG_H
@@ -80,7 +80,7 @@ SOFTWARE.
 #ifdef HAVE_ARPA_INET_H
 #include <arpa/inet.h>
 #endif
-#if HAVE_FCNTL_H
+#ifdef HAVE_FCNTL_H
 #include <fcntl.h>
 #endif
 
diff --git a/apps/snmptrapd_sql.c b/apps/snmptrapd_sql.c
index 262cb8e6da..fd7ffb24d3 100644
--- a/apps/snmptrapd_sql.c
+++ b/apps/snmptrapd_sql.c
@@ -34,24 +34,24 @@
 #include <mysql.h>
 #include <errmsg.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include <stdio.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
 #include <ctype.h>
 #include <sys/types.h>
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if HAVE_NETDB_H
+#ifdef HAVE_NETDB_H
 #include <netdb.h>
 #endif
 
@@ -456,7 +456,7 @@ netsnmp_mysql_init(void)
     char **not_argv = not_args;
 
     /** load .my.cnf values */
-#if HAVE_MY_LOAD_DEFAULTS
+#ifdef HAVE_MY_LOAD_DEFAULTS
     my_load_defaults ("my", _sql.groups, &not_argc, &not_argv, 0);
 #elif defined(HAVE_LOAD_DEFAULTS)
     load_defaults ("my", _sql.groups, &not_argc, &not_argv);
@@ -563,7 +563,7 @@ netsnmp_mysql_init(void)
         return -1;
     }
 
-#if HAVE_MYSQL_OPTIONS
+#ifdef HAVE_MYSQL_OPTIONS
     mysql_options(_sql.conn, MYSQL_READ_DEFAULT_GROUP, "snmptrapd");
 #endif
 
diff --git a/apps/snmpusm.c b/apps/snmpusm.c
index bbefa18c32..da1070acd2 100644
--- a/apps/snmpusm.c
+++ b/apps/snmpusm.c
@@ -23,13 +23,13 @@
 #include <openssl/dh.h>
 #endif /* HAVE_OPENSSL_DH_H && HAVE_LIBCRYPTO */
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -40,7 +40,7 @@
 #endif
 #include <stdio.h>
 #include <ctype.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/apps/snmpvacm.c b/apps/snmpvacm.c
index f5b39446c4..5ecdcdaf8c 100644
--- a/apps/snmpvacm.c
+++ b/apps/snmpvacm.c
@@ -5,13 +5,13 @@
  */
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -22,7 +22,7 @@
 #endif
 #include <stdio.h>
 #include <ctype.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/apps/snmpwalk.c b/apps/snmpwalk.c
index f5ea758962..61e8059ba2 100644
--- a/apps/snmpwalk.c
+++ b/apps/snmpwalk.c
@@ -26,13 +26,13 @@ SOFTWARE.
 ******************************************************************/
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -41,7 +41,7 @@ SOFTWARE.
 #ifdef HAVE_NETINET_IN_H
 # include <netinet/in.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/apps/sshtosnmp.c b/apps/sshtosnmp.c
index 20aed4b815..6e765bdd43 100644
--- a/apps/sshtosnmp.c
+++ b/apps/sshtosnmp.c
@@ -17,7 +17,7 @@
 #ifdef HAVE_SYS_SOCKET_H
 #include <sys/socket.h>
 #endif
-#if HAVE_SYS_UN_H
+#ifdef HAVE_SYS_UN_H
 #include <sys/un.h>
 #endif
 
diff --git a/configure.d/config_os_headers b/configure.d/config_os_headers
index b9c8c31341..584064eeb1 100644
--- a/configure.d/config_os_headers
+++ b/configure.d/config_os_headers
@@ -123,7 +123,7 @@ fi
 AC_CHECK_HEADERS(sys/swap.h,,,
     AC_INCLUDES_DEFAULT([])
     [
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
     ])
@@ -136,10 +136,10 @@ AC_CHECK_HEADERS([malloc.h        osreldate.h                   ] dnl
                  [sys/mount.h     sys/proc.h    sys/queue.h     ] dnl
                  [sys/user.h                                    ],,,
     [[
-#if HAVE_SYS_TYPES_H
+#ifdef HAVE_SYS_TYPES_H
 #include <sys/types.h>
 #endif
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
     ]])
@@ -162,7 +162,7 @@ AC_CHECK_HEADERS([sys/sema.h])
 AC_CHECK_HEADERS(sys/hashing.h,,,
     AC_INCLUDES_DEFAULT([])
     [
-#if HAVE_SYS_SEMA_H
+#ifdef HAVE_SYS_SEMA_H
 #include <sys/sema.h>
 #endif
     ])
@@ -173,7 +173,7 @@ AC_CHECK_HEADERS(sys/hashing.h,,,
 AC_CHECK_HEADERS(sys/vnode.h,,,
     [
 #define _KMEMUSER 1
-#if HAVE_SYS_TYPES_H
+#ifdef HAVE_SYS_TYPES_H
 #include <sys/types.h>
 #endif
     ])
@@ -183,13 +183,13 @@ AC_CHECK_HEADERS(sys/vnode.h,,,
 #
 AC_CHECK_HEADERS(sys/disklabel.h,,,
     [[
-#if HAVE_SYS_TYPES_H
+#ifdef HAVE_SYS_TYPES_H
 #include <sys/types.h>
 #endif
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
-#if HAVE_MACHINE_TYPES_H
+#ifdef HAVE_MACHINE_TYPES_H
 #include <machine/types.h>
 #endif
     ]])
@@ -202,13 +202,13 @@ AC_CHECK_HEADERS([nbutil.h])
 #
 AC_CHECK_HEADERS([ufs/ufs/dinode.h ufs/ufs/quota.h ufs/ufs/inode.h ufs/ffs/fs.h],,,
     [[
-#if HAVE_SYS_TYPES_H
+#ifdef HAVE_SYS_TYPES_H
 #include <sys/types.h>
 #endif
-#if HAVE_UFS_UFS_DINODE_H
+#ifdef HAVE_UFS_UFS_DINODE_H
 #include <ufs/ufs/dinode.h>
 #endif
-#if HAVE_UFS_UFS_QUOTA_H
+#ifdef HAVE_UFS_UFS_QUOTA_H
 #include <ufs/ufs/quota.h>
 #endif
     ]])
@@ -218,7 +218,7 @@ AC_CHECK_HEADERS([ufs/ufs/dinode.h ufs/ufs/quota.h ufs/ufs/inode.h ufs/ffs/fs.h]
 #
 AC_CHECK_HEADERS(vm/swap_pager.h,,,
     [[
-#if HAVE_VM_VM_H
+#ifdef HAVE_VM_VM_H
 #include <vm/vm.h>
 #endif
     ]])
@@ -228,13 +228,13 @@ AC_CHECK_HEADERS(vm/swap_pager.h,,,
 #
 AC_CHECK_HEADERS([linux/netlink.h  linux/rtnetlink.h],,,
     [[
-#if HAVE_ASM_TYPES_H
+#ifdef HAVE_ASM_TYPES_H
 #include <asm/types.h>
 #endif
-#if HAVE_SYS_SOCKET_H
+#ifdef HAVE_SYS_SOCKET_H
 #include <sys/socket.h>
 #endif
-#if HAVE_LINUX_NETLINK_H
+#ifdef HAVE_LINUX_NETLINK_H
 #include <linux/netlink.h>
 #endif
     ]])
@@ -291,61 +291,61 @@ AC_CHECK_HEADERS([sys/socket.h]dnl
                  [netinet6/tcp6_var.h]dnl
                  ,,,
     [[
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
-#if HAVE_SYS_TYPES_H
+#ifdef HAVE_SYS_TYPES_H
 #include <sys/types.h>
 #endif
-#if HAVE_SYS_TIMEOUT_H
+#ifdef HAVE_SYS_TIMEOUT_H
 #include <sys/timeout.h>
 #endif
-#if HAVE_SYS_SOCKET_H
+#ifdef HAVE_SYS_SOCKET_H
 #include <sys/socket.h>
 #endif
-#if HAVE_SYS_SOCKETVAR_H
+#ifdef HAVE_SYS_SOCKETVAR_H
 #include <sys/socketvar.h>
 #endif
-#if HAVE_ARPA_INET_H
+#ifdef HAVE_ARPA_INET_H
 #include <arpa/inet.h>
 #endif
-#if HAVE_NETINET_IN_SYSTM_H
+#ifdef HAVE_NETINET_IN_SYSTM_H
 #include <netinet/in_systm.h>
 #endif
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if HAVE_NETINET_IP_H
+#ifdef HAVE_NETINET_IP_H
 #include <netinet/ip.h>
 #endif
-#if HAVE_NETINET_IP_H
+#ifdef HAVE_NETINET_IP_H
 #include <netinet/ip_icmp.h>
 #endif
-#if HAVE_NET_IF_H
+#ifdef HAVE_NET_IF_H
 #include <net/if.h>
 #endif
-#if HAVE_NET_IF_VAR_H
+#ifdef HAVE_NET_IF_VAR_H
 #include <net/if_var.h>
 #endif
-#if HAVE_NETINET_IP_VAR_H
+#ifdef HAVE_NETINET_IP_VAR_H
 #include <netinet/ip_var.h>
 #endif
-#if HAVE_NETINET_IP_ICMP_H
+#ifdef HAVE_NETINET_IP_ICMP_H
 #include <netinet/ip_icmp.h>
 #endif
-#if HAVE_NETINET_TCP_H
+#ifdef HAVE_NETINET_TCP_H
 #include <netinet/tcp.h>
 #endif
-#if HAVE_NETINET_UDP_H
+#ifdef HAVE_NETINET_UDP_H
 #include <netinet/udp.h>
 #endif
-#if HAVE_NETINET_TCP_TIMER_H
+#ifdef HAVE_NETINET_TCP_TIMER_H
 #include <netinet/tcp_timer.h>
 #endif
-#if HAVE_NETINET_IP6_H
+#ifdef HAVE_NETINET_IP6_H
 #include <netinet/ip6.h>
 #endif
-#if HAVE_NETINET_ICMP6_H
+#ifdef HAVE_NETINET_ICMP6_H
 #include <netinet/icmp6.h>
 #endif
     ]])
@@ -420,7 +420,7 @@ case $target_os in
 ]),,
                 LMIBLIBS),,
     [[
-#if HAVE_SYS_PROTOSW_H
+#ifdef HAVE_SYS_PROTOSW_H
 #include <sys/protosw.h>
 #endif
     ]])
diff --git a/configure.d/config_os_misc4 b/configure.d/config_os_misc4
index 39ad7fd8d2..1224b235f7 100644
--- a/configure.d/config_os_misc4
+++ b/configure.d/config_os_misc4
@@ -167,7 +167,7 @@ else
     AC_CACHE_CHECK([if sysctl can read kernel information],
         ac_cv_NETSNMP_CAN_USE_SYSCTL,
        [AC_TRY_RUN([
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -177,11 +177,11 @@ else
 #  include <time.h>
 # endif
 #endif
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 # include <sys/param.h>
 #endif
 #include <sys/types.h>
-#if HAVE_SYS_SYSCTL_H
+#ifdef HAVE_SYS_SYSCTL_H
 # include <sys/sysctl.h>
 #endif
 #include <stddef.h>
@@ -246,10 +246,10 @@ case $target_os in
     AC_CHECK_HEADERS(inet/ip.h,ac_inet_ip_h=yes,ac_inet_ip_h=no,
         AC_INCLUDES_DEFAULT([])
         [
-#if HAVE_SYS_STREAM_H
+#ifdef HAVE_SYS_STREAM_H
 #include <sys/stream.h>
 #endif
-#if HAVE_INET_COMMON_H
+#ifdef HAVE_INET_COMMON_H
 #include <inet/common.h>
 #endif
         ])
@@ -257,7 +257,7 @@ case $target_os in
         AC_CACHE_CHECK([for mib2_ipRouteEntry_t in inet/mib2.h],
             ac_cv_mib2_ipRouteEntry_t,
            [AC_TRY_COMPILE([
-#if HAVE_INET_MIB2_H
+#ifdef HAVE_INET_MIB2_H
 #include <inet/mib2.h>
 #endif
                ],[
@@ -272,7 +272,7 @@ case $target_os in
             AC_CACHE_CHECK([whether IRE_CACHE is defined in inet/ip.h],
                 ac_cv_ire_cache,
                [AC_TRY_COMPILE([
-#if HAVE_INET_IP_H
+#ifdef HAVE_INET_IP_H
 #include <inet/ip.h>
 #endif
                    ],[
diff --git a/configure.d/config_os_struct_members b/configure.d/config_os_struct_members
index ee9f9f2493..c19156fc45 100644
--- a/configure.d/config_os_struct_members
+++ b/configure.d/config_os_struct_members
@@ -25,10 +25,10 @@ AC_CHECK_MEMBERS([struct arphd.at_next],,,[
 #include <sys/time.h>
 #endif
 #include <net/if.h>
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if HAVE_NETINET_IF_ETHER_H
+#ifdef HAVE_NETINET_IF_ETHER_H
 #include <netinet/if_ether.h>
 #endif
     ]])
@@ -52,7 +52,7 @@ fi
 AC_CHECK_MEMBERS([struct dirent.d_type],,,[
     AC_INCLUDES_DEFAULT()
     [
-#if HAVE_DIRENT_H
+#ifdef HAVE_DIRENT_H
 #include <dirent.h>
 #endif
     ]])
@@ -84,10 +84,10 @@ AC_CHECK_MEMBERS([struct ipstat.ips_cantfrag,
                   struct ipstat.ips_reassembled],,,[
     AC_INCLUDES_DEFAULT()
     [
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if HAVE_NETINET_IP_VAR_H
+#ifdef HAVE_NETINET_IP_VAR_H
 #include <netinet/ip_var.h>
 #endif
     ]])
@@ -97,10 +97,10 @@ AC_CHECK_MEMBERS([struct ipstat.ips_cantfrag,
 AC_CHECK_MEMBERS([struct ip6stat.ip6s_exthdrtoolong ],,,[
     AC_INCLUDES_DEFAULT()
     [
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if HAVE_NETINET6_IP6_VAR_H
+#ifdef HAVE_NETINET6_IP6_VAR_H
 #include <netinet6/ip6_var.h>
 #endif
     ]])
@@ -111,10 +111,10 @@ AC_CHECK_MEMBERS([struct ipstat.ips_cantforward,
                   struct ipstat.ips_fragtimeout],,,[
     AC_INCLUDES_DEFAULT()
     [
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if HAVE_NETINET_IP_VAR_H
+#ifdef HAVE_NETINET_IP_VAR_H
 #include <netinet/ip_var.h>
 #endif
     ]])
@@ -127,10 +127,10 @@ AC_CHECK_MEMBERS([struct mbstat.m_clusters,
                   struct mbstat.m_mbufs],,,[
     AC_INCLUDES_DEFAULT()
     [
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
-#if HAVE_SYS_MBUF_H
+#ifdef HAVE_SYS_MBUF_H
 #include <sys/mbuf.h>
 #endif
     ]])
@@ -150,7 +150,7 @@ AC_CHECK_MEMBERS([struct nlist.n_value,
                   struct nlist64.n_value],,,[
     AC_INCLUDES_DEFAULT()
     [
-#if HAVE_NLIST_H
+#ifdef HAVE_NLIST_H
 #include <nlist.h>
 #endif
     ]])
@@ -215,7 +215,7 @@ AC_CHECK_MEMBERS([struct sockaddr_in6.sin6_scope_id],,,[
 AC_CHECK_SIZEOF([sockaddr_un.sun_path],,[
     AC_INCLUDES_DEFAULT
     [
-#if HAVE_SYS_UN_H
+#ifdef HAVE_SYS_UN_H
 #include <sys/un.h>
 #endif
 struct sockaddr_un sockaddr_un;
@@ -231,7 +231,7 @@ AC_CHECK_MEMBERS([struct statfs.f_favail,
                   struct statfs.f_frsize],,,[
     AC_INCLUDES_DEFAULT()
     [
-#if HAVE_SYS_STATFS_H
+#ifdef HAVE_SYS_STATFS_H
 #include <sys/statfs.h>
 #endif
 #ifdef HAVE_SYS_PARAM_H
@@ -253,10 +253,10 @@ AC_CHECK_MEMBERS([struct statvfs.f_files,
                   struct statvfs.mnt_dir],,,[
     AC_INCLUDES_DEFAULT()
     [
-#if HAVE_SYS_STATFS_H
+#ifdef HAVE_SYS_STATFS_H
 #include <sys/statfs.h>
 #endif
-#if HAVE_SYS_STATVFS_H
+#ifdef HAVE_SYS_STATVFS_H
 #include <sys/statvfs.h>
 #endif
     ]])
@@ -270,7 +270,7 @@ AC_CHECK_MEMBERS([struct swdevt.sw_nblksenabled],,,[
 #ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
-#if HAVE_SYS_CONF_H
+#ifdef HAVE_SYS_CONF_H
 #include <sys/conf.h>
 #endif
     ]])
@@ -304,7 +304,7 @@ AC_CHECK_MEMBERS([struct tcpstat.tcp_rcvmemdrop],,,[
 AC_CHECK_MEMBERS([struct tm.tm_gmtoff, struct tm.tm_isdst],,,[
     AC_INCLUDES_DEFAULT()
     [
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -317,7 +317,7 @@ AC_CHECK_MEMBERS([struct tm.tm_gmtoff, struct tm.tm_isdst],,,[
     ]])
 
 AC_CHECK_DECLS([daylight,timezone],,,[
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -331,7 +331,7 @@ AC_CHECK_DECLS([daylight,timezone],,,[
 
 AC_MSG_CHECKING([whether timezone is a scalar])
 AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -358,7 +358,7 @@ AC_CHECK_MEMBERS([struct timezone.tz_dsttime],,,[
 #ifdef HAVE_SYS_TIMEB_H
 # include <sys/timeb.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -381,16 +381,16 @@ AC_CHECK_MEMBERS([struct udpstat.udps_discard,
                   struct udpstat.udps_opackets],,,[
     AC_INCLUDES_DEFAULT()
     [
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if HAVE_NETINET_IP_VAR_H
+#ifdef HAVE_NETINET_IP_VAR_H
 #include <netinet/ip_var.h>
 #endif
-#if HAVE_NETINET_UDP_H
+#ifdef HAVE_NETINET_UDP_H
 #include <netinet/udp.h>
 #endif
-#if HAVE_NETINET_UDP_VAR_H
+#ifdef HAVE_NETINET_UDP_VAR_H
 #include <netinet/udp_var.h>
 #endif
     ]])
@@ -724,7 +724,7 @@ AC_DEFINE_UNQUOTED(RTENTRY,struct ${ac_cv_struct_rtentry},
 AC_MSG_CHECKING([syslog prioritynames])
 AC_LINK_IFELSE([AC_LANG_PROGRAM([[
 #include <stdio.h>
-#if HAVE_SYSLOG_H
+#ifdef HAVE_SYSLOG_H
 #define SYSLOG_NAMES
 #include <syslog.h>
 #endif
diff --git a/include/net-snmp/library/libsnmp.h b/include/net-snmp/library/libsnmp.h
index 6a073003ba..7e5e837f6f 100644
--- a/include/net-snmp/library/libsnmp.h
+++ b/include/net-snmp/library/libsnmp.h
@@ -37,22 +37,22 @@ extern          "C" {
 
 #include <ucd-snmp/ucd-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
 #include <sys/types.h>
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -62,15 +62,15 @@ extern          "C" {
 #  include <time.h>
 # endif
 #endif
-#if HAVE_SYS_SELECT_H
+#ifdef HAVE_SYS_SELECT_H
 #include <sys/select.h>
 #endif
 #include <stdio.h>
 #include <ctype.h>
-#if HAVE_NETDB_H
+#ifdef HAVE_NETDB_H
 #include <netdb.h>
 #endif
-#if HAVE_ARPA_INET_H
+#ifdef HAVE_ARPA_INET_H
 #include <arpa/inet.h>
 #endif
 
diff --git a/include/net-snmp/library/snmpAAL5PVCDomain.h b/include/net-snmp/library/snmpAAL5PVCDomain.h
index 24bdd76433..e75f6fea46 100644
--- a/include/net-snmp/library/snmpAAL5PVCDomain.h
+++ b/include/net-snmp/library/snmpAAL5PVCDomain.h
@@ -7,7 +7,7 @@
 extern          "C" {
 #endif
 
-#if HAVE_SYS_SOCKET_H
+#ifdef HAVE_SYS_SOCKET_H
 #include <sys/socket.h>
 #endif
 
diff --git a/include/net-snmp/library/snmpDTLSUDPDomain.h b/include/net-snmp/library/snmpDTLSUDPDomain.h
index 5a60eeea0c..a0927e80da 100644
--- a/include/net-snmp/library/snmpDTLSUDPDomain.h
+++ b/include/net-snmp/library/snmpDTLSUDPDomain.h
@@ -1,7 +1,7 @@
 #ifndef _SNMPDTLSUDPDOMAIN_H
 #define _SNMPDTLSUDPDOMAIN_H
 
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
 
diff --git a/include/net-snmp/library/snmpIPXDomain.h b/include/net-snmp/library/snmpIPXDomain.h
index 67a2a450be..b51e298a29 100644
--- a/include/net-snmp/library/snmpIPXDomain.h
+++ b/include/net-snmp/library/snmpIPXDomain.h
@@ -7,7 +7,7 @@ extern          "C" {
 
 #include <net-snmp/library/snmp_transport.h>
 #include <net-snmp/library/asn1.h>
-#if HAVE_NETIPX_IPX_H
+#ifdef HAVE_NETIPX_IPX_H
 #include <netipx/ipx.h>
 #endif
 
diff --git a/include/net-snmp/library/snmpSSHDomain.h b/include/net-snmp/library/snmpSSHDomain.h
index 202c623e13..979d917875 100644
--- a/include/net-snmp/library/snmpSSHDomain.h
+++ b/include/net-snmp/library/snmpSSHDomain.h
@@ -8,7 +8,7 @@ config_require(SocketBase)
 
 #include <net-snmp/library/snmp_transport.h>
 
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
 
diff --git a/include/net-snmp/library/snmpTLSTCPDomain.h b/include/net-snmp/library/snmpTLSTCPDomain.h
index 4f27662caf..40177b02a2 100644
--- a/include/net-snmp/library/snmpTLSTCPDomain.h
+++ b/include/net-snmp/library/snmpTLSTCPDomain.h
@@ -1,7 +1,7 @@
 #ifndef _SNMPTLSTCPDOMAIN_H
 #define _SNMPTLSTCPDOMAIN_H
 
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
 
diff --git a/include/net-snmp/library/snmpUDPsharedDomain.h b/include/net-snmp/library/snmpUDPsharedDomain.h
index 3df9c9a249..8f2e1a3177 100644
--- a/include/net-snmp/library/snmpUDPsharedDomain.h
+++ b/include/net-snmp/library/snmpUDPsharedDomain.h
@@ -8,10 +8,10 @@
 #ifndef SNMPUDPsharedBASE_H
 #define SNMPUDPsharedBASE_H
 
-#if HAVE_SYS_SOCKET_H
+#ifdef HAVE_SYS_SOCKET_H
 #include <sys/socket.h>
 #endif
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
 
diff --git a/include/net-snmp/library/snmpUnixDomain.h b/include/net-snmp/library/snmpUnixDomain.h
index 333305f461..6e42d47ddb 100644
--- a/include/net-snmp/library/snmpUnixDomain.h
+++ b/include/net-snmp/library/snmpUnixDomain.h
@@ -7,10 +7,10 @@
     config_error(Unix domain protocol support unavailable for this platform)
 #endif
 
-#if HAVE_SYS_SOCKET_H
+#ifdef HAVE_SYS_SOCKET_H
 #include <sys/socket.h>
 #endif
-#if HAVE_SYS_UN_H
+#ifdef HAVE_SYS_UN_H
 #include <sys/un.h>
 #endif
 
diff --git a/include/net-snmp/library/snmp_alarm.h b/include/net-snmp/library/snmp_alarm.h
index 0635375696..20cdbadc72 100644
--- a/include/net-snmp/library/snmp_alarm.h
+++ b/include/net-snmp/library/snmp_alarm.h
@@ -4,7 +4,7 @@
 /*
  * For 'timeval'
  */
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/include/net-snmp/net-snmp-includes.h b/include/net-snmp/net-snmp-includes.h
index fdefc11343..e0d47dcf14 100644
--- a/include/net-snmp/net-snmp-includes.h
+++ b/include/net-snmp/net-snmp-includes.h
@@ -12,7 +12,7 @@
 #error "Please include <net-snmp/net-snmp-config.h> before this file"
 #endif
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/include/net-snmp/system/dynix.h b/include/net-snmp/system/dynix.h
index 63e979b1ab..db06dcc6bd 100644
--- a/include/net-snmp/system/dynix.h
+++ b/include/net-snmp/system/dynix.h
@@ -98,7 +98,7 @@
  * Might as well include this here, since a significant
  * number of files seem to need it.  DTS 
  */
-#if HAVE_SYS_SELECT_H
+#ifdef HAVE_SYS_SELECT_H
 #include <sys/select.h>
 #endif
 
diff --git a/include/net-snmp/utilities.h b/include/net-snmp/utilities.h
index 84569eb794..85a7c71236 100644
--- a/include/net-snmp/utilities.h
+++ b/include/net-snmp/utilities.h
@@ -27,7 +27,7 @@
 
 #include <net-snmp/library/snmp_api.h>
 #include <net-snmp/library/snmp_client.h>
-#if HAVE_GETOPT_H
+#ifdef HAVE_GETOPT_H
 #include <getopt.h>
 #else
 #include <net-snmp/library/getopt.h>
diff --git a/snmplib/asn1.c b/snmplib/asn1.c
index 07bdcc6976..256b5040db 100644
--- a/snmplib/asn1.c
+++ b/snmplib/asn1.c
@@ -167,7 +167,7 @@ SOFTWARE.
 #include "gw.h"
 #endif
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/snmplib/callback.c b/snmplib/callback.c
index 9678e093b7..4b26ea0a86 100644
--- a/snmplib/callback.c
+++ b/snmplib/callback.c
@@ -20,19 +20,19 @@
 #include <net-snmp/net-snmp-features.h>
 #include <sys/types.h>
 #include <stdio.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 #ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/snmplib/cert_util.c b/snmplib/cert_util.c
index 210ad8baa1..a7ea6b39a6 100644
--- a/snmplib/cert_util.c
+++ b/snmplib/cert_util.c
@@ -42,20 +42,20 @@ netsnmp_feature_child_of(tls_fingerprint_build, cert_util_all);
 
 #include <ctype.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
 
-#if HAVE_SYS_STAT_H
+#ifdef HAVE_SYS_STAT_H
 #   include <sys/stat.h>
 #endif
-#if HAVE_DIRENT_H
+#ifdef HAVE_DIRENT_H
 # include <dirent.h>
 # define NAMLEN(dirent) strlen((dirent)->d_name)
 #else
diff --git a/snmplib/container_binary_array.c b/snmplib/container_binary_array.c
index 700497ecf6..9f07943096 100644
--- a/snmplib/container_binary_array.c
+++ b/snmplib/container_binary_array.c
@@ -19,14 +19,14 @@
 #include <io.h>
 #endif
 #include <stdio.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_MALLOC_H
+#ifdef HAVE_MALLOC_H
 #include <malloc.h>
 #endif
 #include <sys/types.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/snmplib/container_iterator.c b/snmplib/container_iterator.c
index a320045274..579e2b812b 100644
--- a/snmplib/container_iterator.c
+++ b/snmplib/container_iterator.c
@@ -7,14 +7,14 @@
 #include <net-snmp/net-snmp-features.h>
 
 #include <stdio.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_MALLOC_H
+#ifdef HAVE_MALLOC_H
 #include <malloc.h>
 #endif
 #include <sys/types.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/snmplib/container_list_ssll.c b/snmplib/container_list_ssll.c
index 0eef2056f6..ef3e8e7ed1 100644
--- a/snmplib/container_list_ssll.c
+++ b/snmplib/container_list_ssll.c
@@ -7,14 +7,14 @@
 #include <net-snmp/net-snmp-features.h>
 
 #include <stdio.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_MALLOC_H
+#ifdef HAVE_MALLOC_H
 #include <malloc.h>
 #endif
 #include <sys/types.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/snmplib/container_null.c b/snmplib/container_null.c
index 38711efb69..18fc743e49 100644
--- a/snmplib/container_null.c
+++ b/snmplib/container_null.c
@@ -13,14 +13,14 @@
 #include <io.h>
 #endif
 #include <stdio.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_MALLOC_H
+#ifdef HAVE_MALLOC_H
 #include <malloc.h>
 #endif
 #include <sys/types.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/snmplib/default_store.c b/snmplib/default_store.c
index 176c191fb8..422f5ac9ed 100644
--- a/snmplib/default_store.c
+++ b/snmplib/default_store.c
@@ -128,22 +128,22 @@
 #include <net-snmp/net-snmp-config.h>
 #include <net-snmp/net-snmp-features.h>
 #include <sys/types.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 #ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/snmplib/dir_utils.c b/snmplib/dir_utils.c
index c2dd989dc0..40db11cced 100644
--- a/snmplib/dir_utils.c
+++ b/snmplib/dir_utils.c
@@ -14,26 +14,26 @@
 
 #include <stdio.h>
 #include <ctype.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #   include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #   include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #   include <string.h>
 #else
 #  include <strings.h>
 #endif
 
 #include <sys/types.h>
-#if HAVE_LIMITS_H
+#ifdef HAVE_LIMITS_H
 #include <limits.h>
 #endif
-#if HAVE_SYS_STAT_H
+#ifdef HAVE_SYS_STAT_H
 #include <sys/stat.h>
 #endif
-#if HAVE_DIRENT_H
+#ifdef HAVE_DIRENT_H
 # include <dirent.h>
 # define NAMLEN(dirent) strlen((dirent)->d_name)
 #else
diff --git a/snmplib/file_utils.c b/snmplib/file_utils.c
index c7f831b523..d29ace9fd1 100644
--- a/snmplib/file_utils.c
+++ b/snmplib/file_utils.c
@@ -7,13 +7,13 @@
 #endif
 #include <stdio.h>
 #include <ctype.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #   include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #   include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #   include <string.h>
 #else
 #  include <strings.h>
@@ -21,7 +21,7 @@
 
 #include <sys/types.h>
 
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #   include <sys/param.h>
 #endif
 #ifdef HAVE_SYS_STAT_H
diff --git a/snmplib/gettimeofday.c b/snmplib/gettimeofday.c
index df5c0a04d4..6ae0843244 100644
--- a/snmplib/gettimeofday.c
+++ b/snmplib/gettimeofday.c
@@ -8,7 +8,7 @@
 #ifdef HAVE_SYS_TIMEB_H
 # include <sys/timeb.h> /* _ftime() */
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/snmplib/inet_ntop.c b/snmplib/inet_ntop.c
index 947ad53753..5037b2ab59 100644
--- a/snmplib/inet_ntop.c
+++ b/snmplib/inet_ntop.c
@@ -29,7 +29,7 @@
 
 #include <errno.h>
 #include <stdio.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/snmplib/inet_pton.c b/snmplib/inet_pton.c
index 60a40020d0..dc4e1e7d3a 100644
--- a/snmplib/inet_pton.c
+++ b/snmplib/inet_pton.c
@@ -31,7 +31,7 @@
 
 #include <errno.h>
 #include <stdio.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/snmplib/int64.c b/snmplib/int64.c
index 964c2a719c..3b1f705e56 100644
--- a/snmplib/int64.c
+++ b/snmplib/int64.c
@@ -14,7 +14,7 @@
 #ifdef HAVE_INTTYPES_H
 #include <inttypes.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/snmplib/keytools.c b/snmplib/keytools.c
index 14a452a1d1..388e6556dc 100644
--- a/snmplib/keytools.c
+++ b/snmplib/keytools.c
@@ -29,13 +29,13 @@
 #ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
@@ -228,7 +228,7 @@ generate_Ku(const oid * hashtype, u_int hashtype_len,
         if (rval != 0) {
             return SNMPERR_USM_ENCRYPTIONERROR;
         }
-#elif NETSNMP_USE_INTERNAL_MD5
+#elif defined(NETSNMP_USE_INTERNAL_MD5)
         if (MDupdate(&MD, buf, USM_LENGTH_KU_HASHBLOCK * 8)) {
             rval = SNMPERR_USM_ENCRYPTIONERROR;
             goto md5_fin;
@@ -258,7 +258,7 @@ generate_Ku(const oid * hashtype, u_int hashtype_len,
     if (ret == SNMPERR_GENERR)
         return SNMPERR_GENERR;
     *kulen = ret;
-#elif NETSNMP_USE_INTERNAL_MD5
+#elif defined(NETSNMP_USE_INTERNAL_MD5)
     if (MDupdate(&MD, buf, 0)) {
         rval = SNMPERR_USM_ENCRYPTIONERROR;
         goto md5_fin;
@@ -299,7 +299,7 @@ generate_Ku(const oid * hashtype, u_int hashtype_len,
     return rval;
 
 }                               /* end generate_Ku() */
-#elif NETSNMP_USE_PKCS11
+#elif defined(NETSNMP_USE_PKCS11)
 {
     int             rval = SNMPERR_SUCCESS, auth_type;;
 
diff --git a/snmplib/lcd_time.c b/snmplib/lcd_time.c
index 548d56148c..102754caba 100644
--- a/snmplib/lcd_time.c
+++ b/snmplib/lcd_time.c
@@ -13,12 +13,12 @@
 #ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -32,7 +32,7 @@
 #include <netinet/in.h>
 #endif
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/snmplib/md5.c b/snmplib/md5.c
index 2ce36808ef..96b1eaff9f 100644
--- a/snmplib/md5.c
+++ b/snmplib/md5.c
@@ -37,13 +37,13 @@
 #include <inttypes.h>
 #endif
 #include <sys/types.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 
diff --git a/snmplib/mib.c b/snmplib/mib.c
index 72d21591d9..5a8645de77 100644
--- a/snmplib/mib.c
+++ b/snmplib/mib.c
@@ -49,7 +49,7 @@ SOFTWARE.
 #include <ctype.h>
 #include <sys/types.h>
 
-#if HAVE_DIRENT_H
+#ifdef HAVE_DIRENT_H
 # include <dirent.h>
 # define NAMLEN(dirent) strlen((dirent)->d_name)
 #else
@@ -72,7 +72,7 @@ SOFTWARE.
 #ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -82,19 +82,19 @@ SOFTWARE.
 #  include <time.h>
 # endif
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 #ifdef HAVE_SYS_SELECT_H
 #include <sys/select.h>
 #endif
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/snmplib/parse.c b/snmplib/parse.c
index 9406f4f881..30f46537b6 100644
--- a/snmplib/parse.c
+++ b/snmplib/parse.c
@@ -37,28 +37,28 @@ SOFTWARE.
 
 #ifndef NETSNMP_DISABLE_MIB_LOADING
 
-#if HAVE_LIMITS_H
+#ifdef HAVE_LIMITS_H
 #include <limits.h>
 #endif
 #include <stdio.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
 #include <ctype.h>
 #include <sys/types.h>
-#if HAVE_SYS_STAT_H
+#ifdef HAVE_SYS_STAT_H
 #include <sys/stat.h>
 #endif
 
 /*
  * Wow.  This is ugly.  -- Wes 
  */
-#if HAVE_DIRENT_H
+#ifdef HAVE_DIRENT_H
 # include <dirent.h>
 # define NAMLEN(dirent) strlen((dirent)->d_name)
 #else
@@ -74,7 +74,7 @@ SOFTWARE.
 #  include <ndir.h>
 # endif
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -90,7 +90,7 @@ SOFTWARE.
 #if defined(HAVE_REGEX_H) && defined(HAVE_REGCOMP)
 #include <regex.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/snmplib/read_config.c b/snmplib/read_config.c
index 225e49e7a1..74ef9819c3 100644
--- a/snmplib/read_config.c
+++ b/snmplib/read_config.c
@@ -69,22 +69,22 @@
 
 #include <stdio.h>
 #include <ctype.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include <sys/types.h>
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -117,7 +117,7 @@
 #include <io.h>
 #endif
 
-#if HAVE_DIRENT_H
+#ifdef HAVE_DIRENT_H
 # include <dirent.h>
 # define NAMLEN(dirent) strlen((dirent)->d_name)
 #else
diff --git a/snmplib/scapi.c b/snmplib/scapi.c
index 54fdd5c9ab..f53371c75f 100644
--- a/snmplib/scapi.c
+++ b/snmplib/scapi.c
@@ -29,12 +29,12 @@
 #ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -48,7 +48,7 @@
 #include <netinet/in.h>
 #endif
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include "memcheck.h"
@@ -554,7 +554,7 @@ sc_init(void)
     gettimeofday(&tv, (struct timezone *) 0);
 
     netsnmp_srandom((unsigned)(tv.tv_sec ^ tv.tv_usec));
-#elif NETSNMP_USE_PKCS11
+#elif defined(NETSNMP_USE_PKCS11)
     DEBUGTRACE;
     rval = pkcs_init();
 #else
diff --git a/snmplib/snmp-tc.c b/snmplib/snmp-tc.c
index 85b3e07adc..4507e79524 100644
--- a/snmplib/snmp-tc.c
+++ b/snmplib/snmp-tc.c
@@ -7,18 +7,18 @@
 #include <net-snmp/net-snmp-config.h>
 #include <net-snmp/net-snmp-features.h>
 #include <sys/types.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 #include <ctype.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
 #ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
 
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -255,7 +255,7 @@ ctime_to_timet(const char *str)
      */
 
 #ifdef HAVE_STRUCT_TM_TM_ISDST
-#if HAVE_DECL_DAYLIGHT
+#if HAVE_DECL_DAYLIGHT==1
     tm.tm_isdst = !!daylight;
 #else
     tm.tm_isdst = 0;
diff --git a/snmplib/snmp_alarm.c b/snmplib/snmp_alarm.c
index 07953bc9f7..f0fc7e1f4b 100644
--- a/snmplib/snmp_alarm.c
+++ b/snmplib/snmp_alarm.c
@@ -18,22 +18,22 @@
  */
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include <signal.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 #include <sys/types.h>
 #ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #endif
 
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/snmplib/snmp_api.c b/snmplib/snmp_api.c
index 346f203404..e8d0cbe5d0 100644
--- a/snmplib/snmp_api.c
+++ b/snmplib/snmp_api.c
@@ -47,22 +47,22 @@ SOFTWARE.
 
 #include <stdio.h>
 #include <ctype.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include <sys/types.h>
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -102,7 +102,7 @@ SOFTWARE.
 #endif
 #include <errno.h>
 
-#if HAVE_LOCALE_H
+#ifdef HAVE_LOCALE_H
 #include <locale.h>
 #endif
 
diff --git a/snmplib/snmp_auth.c b/snmplib/snmp_auth.c
index f4ff2c76f2..af84687b1f 100644
--- a/snmplib/snmp_auth.c
+++ b/snmplib/snmp_auth.c
@@ -33,16 +33,16 @@ SOFTWARE.
 #endif
 
 #include <stdio.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
 #include <sys/types.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -62,7 +62,7 @@ SOFTWARE.
 #include <arpa/inet.h>
 #endif
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/snmplib/snmp_client.c b/snmplib/snmp_client.c
index 6e585af971..dca658162a 100644
--- a/snmplib/snmp_client.c
+++ b/snmplib/snmp_client.c
@@ -52,19 +52,19 @@ SOFTWARE.
 #ifdef HAVE_INTTYPES_H
 #include <inttypes.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include <sys/types.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -74,7 +74,7 @@ SOFTWARE.
 #  include <time.h>
 # endif
 #endif
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
 #ifdef HAVE_NETINET_IN_H
diff --git a/snmplib/snmp_debug.c b/snmplib/snmp_debug.c
index c58193618c..1b684e0316 100644
--- a/snmplib/snmp_debug.c
+++ b/snmplib/snmp_debug.c
@@ -18,10 +18,10 @@
 #ifndef HAVE_PRIORITYNAMES
 #include <errno.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -32,7 +32,7 @@
 #endif
 #include <stdarg.h>
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/snmplib/snmp_enum.c b/snmplib/snmp_enum.c
index 9bd0d6f0bd..c7c77ccda1 100644
--- a/snmplib/snmp_enum.c
+++ b/snmplib/snmp_enum.c
@@ -12,7 +12,7 @@
 #include <stdlib.h>
 #endif
 #include <stdio.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/snmplib/snmp_logging.c b/snmplib/snmp_logging.c
index 2c56e889b5..96215527d5 100644
--- a/snmplib/snmp_logging.c
+++ b/snmplib/snmp_logging.c
@@ -25,16 +25,16 @@
 #include <net-snmp/net-snmp-config.h>
 #include <net-snmp/net-snmp-features.h>
 #include <stdio.h>
-#if HAVE_MALLOC_H
+#ifdef HAVE_MALLOC_H
 #include <malloc.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
 #include <ctype.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 #include <sys/types.h>
@@ -47,7 +47,7 @@
 #include <sys/syslog.h>
 #endif
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -63,7 +63,7 @@
 
 #include <stdarg.h>
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/snmplib/snmp_parse_args.c b/snmplib/snmp_parse_args.c
index f0258af1fb..73e564788e 100644
--- a/snmplib/snmp_parse_args.c
+++ b/snmplib/snmp_parse_args.c
@@ -20,27 +20,27 @@
 #include <net-snmp/net-snmp-config.h>
 #include <errno.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
 #include <sys/types.h>
 #include <stdio.h>
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include <ctype.h>
 #ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/snmplib/snmp_secmod.c b/snmplib/snmp_secmod.c
index 614c31f7ce..1362a68033 100644
--- a/snmplib/snmp_secmod.c
+++ b/snmplib/snmp_secmod.c
@@ -14,15 +14,15 @@
 #include <net-snmp/net-snmp-config.h>
 #include <stdio.h>
 #include <ctype.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/snmplib/snmp_transport.c b/snmplib/snmp_transport.c
index 415423c6e4..d2fcf467d9 100644
--- a/snmplib/snmp_transport.c
+++ b/snmplib/snmp_transport.c
@@ -11,20 +11,20 @@
 #include <net-snmp/library/snmp_transport.h>
 
 #include <stdio.h>
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
 #include <sys/types.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 
 #include <ctype.h>
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
@@ -1288,7 +1288,7 @@ netsnmp_transport_cache_get(int af, int type, int local,
 
 #define USE_CACHE 1
 
-#if USE_CACHE
+#ifdef USE_CACHE
     /** check for existing transport */
     tc = _tc_find(af, type, local, bind_addr);
     if (tc) {
@@ -1307,7 +1307,7 @@ netsnmp_transport_cache_get(int af, int type, int local,
     }
     DEBUGMSGTL(("transport:cache:get", "new transport %p\n", t));
 
-#if USE_CACHE
+#ifdef USE_CACHE
     /** create transport cache for new transport */
     tc = _tc_add(af, type, local, bind_addr, t);
     if (NULL == tc) {
diff --git a/snmplib/snmpksm.c b/snmplib/snmpksm.c
index d30347a9f2..3896ad0347 100644
--- a/snmplib/snmpksm.c
+++ b/snmplib/snmpksm.c
@@ -13,7 +13,7 @@
 #ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -23,7 +23,7 @@
 #  include <time.h>
 # endif
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -62,9 +62,9 @@
 #define TICKET_CLIENT(x)	(x)->enc_part2->client
 #endif				/* NETSNMP_USE_KERBEROS_HEIMDAL */
 
-#if HAVE_ET_COM_ERR_H
+#ifdef HAVE_ET_COM_ERR_H
 #include <et/com_err.h>
-#elif HAVE_COM_ERR_H
+#elif defined(HAVE_COM_ERR_H)
 #include <com_err.h>
 #else
 static const char *error_message(int ret) { return "(?)"; }
diff --git a/snmplib/snmpusm.c b/snmplib/snmpusm.c
index 75fc952935..dde65f9c63 100644
--- a/snmplib/snmpusm.c
+++ b/snmplib/snmpusm.c
@@ -34,7 +34,7 @@
 #ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -44,7 +44,7 @@
 #  include <time.h>
 # endif
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -53,7 +53,7 @@
 #include <netinet/in.h>
 #endif
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/snmplib/snmpv3.c b/snmplib/snmpv3.c
index 7b1746bf28..46914281dd 100644
--- a/snmplib/snmpv3.c
+++ b/snmplib/snmpv3.c
@@ -22,7 +22,7 @@
 #include <stdio.h>
 #include <sys/types.h>
 
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -35,7 +35,7 @@
 #ifdef HAVE_SYS_TIMES_H
 #include <sys/times.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -44,7 +44,7 @@
 #ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #ifdef HAVE_SYS_SOCKET_H
@@ -53,7 +53,7 @@
 #ifdef HAVE_NETDB_H
 #include <netdb.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #       include <stdlib.h>
 #endif
 
diff --git a/snmplib/snprintf.c b/snmplib/snprintf.c
index b92fba92e1..82bc658c53 100644
--- a/snmplib/snprintf.c
+++ b/snmplib/snprintf.c
@@ -60,7 +60,7 @@
 
 #if !defined(HAVE_SNPRINTF) || !defined(HAVE_VSNPRINTF)
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/snmplib/strlcat.c b/snmplib/strlcat.c
index 43254107a5..f495c6a040 100644
--- a/snmplib/strlcat.c
+++ b/snmplib/strlcat.c
@@ -20,7 +20,7 @@
 
 #ifndef HAVE_STRLCAT
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/snmplib/strlcpy.c b/snmplib/strlcpy.c
index 0235a30a11..c5ec5a18cb 100644
--- a/snmplib/strlcpy.c
+++ b/snmplib/strlcpy.c
@@ -5,7 +5,7 @@
  */
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/snmplib/strtol.c b/snmplib/strtol.c
index 4d2c6e83bc..ad9f410376 100644
--- a/snmplib/strtol.c
+++ b/snmplib/strtol.c
@@ -29,12 +29,12 @@
 
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_LIMITS_H
+#ifdef HAVE_LIMITS_H
 #include <limits.h>
 #endif
 #include <ctype.h>
 #include <errno.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 
diff --git a/snmplib/strtoul.c b/snmplib/strtoul.c
index ac9be25fbd..d819ba952f 100644
--- a/snmplib/strtoul.c
+++ b/snmplib/strtoul.c
@@ -29,12 +29,12 @@
 
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_LIMITS_H
+#ifdef HAVE_LIMITS_H
 #include <limits.h>
 #endif
 #include <ctype.h>
 #include <errno.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 
diff --git a/snmplib/system.c b/snmplib/system.c
index 6df6f746ab..3a43556c1a 100644
--- a/snmplib/system.c
+++ b/snmplib/system.c
@@ -61,14 +61,14 @@ SOFTWARE.
 #ifdef HAVE_DIRECT_H
 #include <direct.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
 
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -108,7 +108,7 @@ SOFTWARE.
 #include <nlist.h>
 #endif
 
-#if HAVE_SYS_FILE_H
+#ifdef HAVE_SYS_FILE_H
 #include <sys/file.h>
 #endif
 
@@ -116,14 +116,14 @@ SOFTWARE.
 #include <kstat.h>
 #endif
 
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
 #ifdef HAVE_SYS_SYSCTL_H
 #include <sys/sysctl.h>
 #endif
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -137,7 +137,7 @@ SOFTWARE.
 #ifdef HAVE_SYS_STAT_H
 #include <sys/stat.h>
 #endif
-#if HAVE_FCNTL_H
+#ifdef HAVE_FCNTL_H
 #include <fcntl.h>
 #endif
 
@@ -172,7 +172,7 @@ SOFTWARE.
 #include <grp.h>
 #endif
 
-#if HAVE_LIMITS_H
+#ifdef HAVE_LIMITS_H
 #include <limits.h>
 #endif
 
@@ -771,7 +771,7 @@ netsnmp_validator_context(void)
 int
 netsnmp_gethostbyname_v4(const char* name, in_addr_t *addr_out)
 {
-#if HAVE_GETADDRINFO
+#ifdef HAVE_GETADDRINFO
     struct addrinfo *addrs = NULL;
     struct addrinfo hint;
     int             err;
@@ -798,7 +798,7 @@ netsnmp_gethostbyname_v4(const char* name, in_addr_t *addr_out)
     }
     return 0;
 
-#elif HAVE_GETHOSTBYNAME
+#elif defined(HAVE_GETHOSTBYNAME)
     struct hostent *hp = NULL;
 
     hp = netsnmp_gethostbyname(name);
@@ -817,7 +817,7 @@ netsnmp_gethostbyname_v4(const char* name, in_addr_t *addr_out)
     }
     return 0;
 
-#elif HAVE_GETIPNODEBYNAME
+#elif defined(HAVE_GETIPNODEBYNAME)
     struct hostent *hp = NULL;
     int             err;
 
@@ -841,7 +841,7 @@ int
 netsnmp_getaddrinfo(const char *name, const char *service,
                     const struct addrinfo *hints, struct addrinfo **res)
 {
-#if HAVE_GETADDRINFO
+#ifdef HAVE_GETADDRINFO
     struct addrinfo *addrs = NULL;
     struct addrinfo hint;
     int             err;
@@ -949,7 +949,7 @@ netsnmp_getaddrinfo(const char *name, const char *service,
 struct hostent *
 netsnmp_gethostbyname(const char *name)
 {
-#if HAVE_GETHOSTBYNAME
+#ifdef HAVE_GETHOSTBYNAME
 #ifdef DNSSEC_LOCAL_VALIDATION
     val_status_t val_status;
 #endif
diff --git a/snmplib/text_utils.c b/snmplib/text_utils.c
index b089633e5e..47e88b911e 100644
--- a/snmplib/text_utils.c
+++ b/snmplib/text_utils.c
@@ -4,13 +4,13 @@
 
 #include <stdio.h>
 #include <ctype.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #   include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #   include <unistd.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #   include <string.h>
 #else
 #  include <strings.h>
@@ -18,10 +18,10 @@
 
 #include <sys/types.h>
 
-#if HAVE_LIMITS_H
+#ifdef HAVE_LIMITS_H
 #   include <limits.h>
 #endif
-#if HAVE_SYS_PARAM_H
+#ifdef HAVE_SYS_PARAM_H
 #   include <sys/param.h>
 #endif
 #ifdef HAVE_SYS_STAT_H
diff --git a/snmplib/tools.c b/snmplib/tools.c
index 751440b058..2419053bad 100644
--- a/snmplib/tools.c
+++ b/snmplib/tools.c
@@ -27,7 +27,7 @@
 #endif
 #include <stdio.h>
 #include <sys/types.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
@@ -46,7 +46,7 @@
 #ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -64,7 +64,7 @@
 #include <windows.h>
 #endif
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/snmplib/transports/snmpAAL5PVCDomain.c b/snmplib/transports/snmpAAL5PVCDomain.c
index e050dfe603..e89ce1ba4a 100644
--- a/snmplib/transports/snmpAAL5PVCDomain.c
+++ b/snmplib/transports/snmpAAL5PVCDomain.c
@@ -7,18 +7,18 @@
 #include <ctype.h>
 #include <errno.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_SYS_SOCKET_H
+#ifdef HAVE_SYS_SOCKET_H
 #include <sys/socket.h>
 #endif
 #include <atm.h>
diff --git a/snmplib/transports/snmpAliasDomain.c b/snmplib/transports/snmpAliasDomain.c
index 5d0478306a..cda8a49d01 100644
--- a/snmplib/transports/snmpAliasDomain.c
+++ b/snmplib/transports/snmpAliasDomain.c
@@ -7,15 +7,15 @@
 #include <sys/types.h>
 #include <errno.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/snmplib/transports/snmpCallbackDomain.c b/snmplib/transports/snmpCallbackDomain.c
index f75151b453..0f7d2511ff 100644
--- a/snmplib/transports/snmpCallbackDomain.c
+++ b/snmplib/transports/snmpCallbackDomain.c
@@ -10,15 +10,15 @@
 #ifdef WIN32
 #include <net-snmp/library/winpipe.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #ifdef HAVE_SYS_SOCKET_H
@@ -30,7 +30,7 @@
 #ifdef HAVE_IO_H
 #include <io.h>
 #endif
-#if HAVE_FCNTL_H
+#ifdef HAVE_FCNTL_H
 #include <fcntl.h>
 #endif
 
diff --git a/snmplib/transports/snmpDTLSUDPDomain.c b/snmplib/transports/snmpDTLSUDPDomain.c
index 45aa4187ed..a987c53ed6 100644
--- a/snmplib/transports/snmpDTLSUDPDomain.c
+++ b/snmplib/transports/snmpDTLSUDPDomain.c
@@ -33,30 +33,30 @@ netsnmp_feature_require(sockaddr_size);
 #include <ctype.h>
 #include <errno.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_SYS_SOCKET_H
+#ifdef HAVE_SYS_SOCKET_H
 #include <sys/socket.h>
 #endif
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if HAVE_ARPA_INET_H
+#ifdef HAVE_ARPA_INET_H
 #include <arpa/inet.h>
 #endif
-#if HAVE_NETDB_H
+#ifdef HAVE_NETDB_H
 #include <netdb.h>
 #endif
-#if HAVE_SYS_UIO_H
+#ifdef HAVE_SYS_UIO_H
 #include <sys/uio.h>
 #endif
 
diff --git a/snmplib/transports/snmpIPXDomain.c b/snmplib/transports/snmpIPXDomain.c
index 9d460f47a8..5eb2887728 100644
--- a/snmplib/transports/snmpIPXDomain.c
+++ b/snmplib/transports/snmpIPXDomain.c
@@ -7,21 +7,21 @@
 #include <ctype.h>
 #include <errno.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_SYS_SOCKET_H
+#ifdef HAVE_SYS_SOCKET_H
 #include <sys/socket.h>
 #endif
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
 
diff --git a/snmplib/transports/snmpIPv4BaseDomain.c b/snmplib/transports/snmpIPv4BaseDomain.c
index 194eaea940..404c7dc9e9 100644
--- a/snmplib/transports/snmpIPv4BaseDomain.c
+++ b/snmplib/transports/snmpIPv4BaseDomain.c
@@ -12,10 +12,10 @@
 #include <stdio.h>
 #include <sys/types.h>
 #include <ctype.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/snmplib/transports/snmpIPv6BaseDomain.c b/snmplib/transports/snmpIPv6BaseDomain.c
index 730aa9c9df..01ded90f8a 100644
--- a/snmplib/transports/snmpIPv6BaseDomain.c
+++ b/snmplib/transports/snmpIPv6BaseDomain.c
@@ -24,10 +24,10 @@
 #include <stdio.h>
 #include <sys/types.h>
 #include <ctype.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
@@ -67,7 +67,7 @@ static const struct in6_addr in6addr_any; /*IN6ADDR_ANY_INIT*/
 #endif
 
 
-#if HAVE_STRUCT_SOCKADDR_IN6_SIN6_SCOPE_ID
+#ifdef HAVE_STRUCT_SOCKADDR_IN6_SIN6_SCOPE_ID
 static unsigned
 netsnmp_if_nametoindex(const char *ifname)
 {
@@ -188,7 +188,7 @@ int netsnmp_ipv6_ostring_to_sockaddr(struct sockaddr_in6 *sin6, const void *o,
 static int netsnmp_resolve_v6_hostname(struct in6_addr *addr,
                                        const char *hostname)
 {
-#if HAVE_GETADDRINFO
+#ifdef HAVE_GETADDRINFO
     struct addrinfo hint = { 0 };
     struct addrinfo *addrs;
     int             err;
@@ -207,7 +207,7 @@ static int netsnmp_resolve_v6_hostname(struct in6_addr *addr,
         DEBUGMSGTL(("netsnmp_sockaddr_in6", "Failed to resolve IPv6 hostname\n"));
     }
     return 1;
-#elif HAVE_GETIPNODEBYNAME
+#elif defined(HAVE_GETIPNODEBYNAME)
     struct hostent *hp;
     int             err;
 
@@ -220,7 +220,7 @@ static int netsnmp_resolve_v6_hostname(struct in6_addr *addr,
     DEBUGMSGTL(("netsnmp_sockaddr_in6", "hostname (resolved okay)\n"));
     memcpy(addr, hp->h_addr, hp->h_length);
     return 1;
-#elif HAVE_GETHOSTBYNAME
+#elif defined(HAVE_GETHOSTBYNAME)
     struct hostent *hp;
 
     hp = netsnmp_gethostbyname(hostname);
diff --git a/snmplib/transports/snmpSSHDomain.c b/snmplib/transports/snmpSSHDomain.c
index ac6f214352..6768ac2717 100644
--- a/snmplib/transports/snmpSSHDomain.c
+++ b/snmplib/transports/snmpSSHDomain.c
@@ -14,30 +14,30 @@
 #ifdef HAVE_SYS_PARAM_H
 #include <sys/param.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_SYS_SOCKET_H
+#ifdef HAVE_SYS_SOCKET_H
 #include <sys/socket.h>
 #endif
-#if HAVE_SYS_UN_H
+#ifdef HAVE_SYS_UN_H
 #include <sys/un.h>
 #endif
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if HAVE_ARPA_INET_H
+#ifdef HAVE_ARPA_INET_H
 #include <arpa/inet.h>
 #endif
-#if HAVE_FCNTL_H
+#ifdef HAVE_FCNTL_H
 #include <fcntl.h>
 #endif
 
diff --git a/snmplib/transports/snmpSTDDomain.c b/snmplib/transports/snmpSTDDomain.c
index 14ac6b41b0..1c77143aaa 100644
--- a/snmplib/transports/snmpSTDDomain.c
+++ b/snmplib/transports/snmpSTDDomain.c
@@ -7,15 +7,15 @@
 #include <signal.h>
 #include <errno.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/snmplib/transports/snmpSocketBaseDomain.c b/snmplib/transports/snmpSocketBaseDomain.c
index 02d39e9689..3fa9da994f 100644
--- a/snmplib/transports/snmpSocketBaseDomain.c
+++ b/snmplib/transports/snmpSocketBaseDomain.c
@@ -11,20 +11,20 @@
 
 #include <stddef.h>
 #include <stdio.h>
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include <sys/types.h>
 #include <ctype.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_FCNTL_H
+#ifdef HAVE_FCNTL_H
 #include <fcntl.h>
 #endif
 #ifdef HAVE_SYS_SOCKET_H
diff --git a/snmplib/transports/snmpTCPBaseDomain.c b/snmplib/transports/snmpTCPBaseDomain.c
index 381e025d20..88291cf62b 100644
--- a/snmplib/transports/snmpTCPBaseDomain.c
+++ b/snmplib/transports/snmpTCPBaseDomain.c
@@ -7,15 +7,15 @@
 #include <sys/types.h>
 #include <errno.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #ifdef HAVE_SYS_SOCKET_H
diff --git a/snmplib/transports/snmpTCPDomain.c b/snmplib/transports/snmpTCPDomain.c
index 523b70c384..18318e56ce 100644
--- a/snmplib/transports/snmpTCPDomain.c
+++ b/snmplib/transports/snmpTCPDomain.c
@@ -8,15 +8,15 @@
 #include <sys/types.h>
 #include <errno.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #ifdef HAVE_SYS_SOCKET_H
diff --git a/snmplib/transports/snmpTCPIPv6Domain.c b/snmplib/transports/snmpTCPIPv6Domain.c
index 41a54b6bf7..6d6fa1f249 100644
--- a/snmplib/transports/snmpTCPIPv6Domain.c
+++ b/snmplib/transports/snmpTCPIPv6Domain.c
@@ -10,15 +10,15 @@
 #include <sys/types.h>
 #include <errno.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #ifdef HAVE_SYS_SOCKET_H
@@ -33,7 +33,7 @@
 #ifdef HAVE_NETDB_H
 #include <netdb.h>
 #endif
-#if HAVE_FCNTL_H
+#ifdef HAVE_FCNTL_H
 #include <fcntl.h>
 #endif
 
diff --git a/snmplib/transports/snmpTLSBaseDomain.c b/snmplib/transports/snmpTLSBaseDomain.c
index 1a907b4c19..5afb5bef6a 100644
--- a/snmplib/transports/snmpTLSBaseDomain.c
+++ b/snmplib/transports/snmpTLSBaseDomain.c
@@ -4,21 +4,21 @@
 
 netsnmp_feature_require(cert_util);
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_SYS_SOCKET_H
+#ifdef HAVE_SYS_SOCKET_H
 #include <sys/socket.h>
 #endif
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if HAVE_ARPA_INET_H
+#ifdef HAVE_ARPA_INET_H
 #include <arpa/inet.h>
 #endif
-#if HAVE_NETDB_H
+#ifdef HAVE_NETDB_H
 #include <netdb.h>
 #endif
 #include <errno.h>
diff --git a/snmplib/transports/snmpTLSTCPDomain.c b/snmplib/transports/snmpTLSTCPDomain.c
index ea5423f79a..abb09020e6 100644
--- a/snmplib/transports/snmpTLSTCPDomain.c
+++ b/snmplib/transports/snmpTLSTCPDomain.c
@@ -18,34 +18,34 @@ netsnmp_feature_require(cert_util);
 #include <ctype.h>
 #include <errno.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_SYS_SOCKET_H
+#ifdef HAVE_SYS_SOCKET_H
 #include <sys/socket.h>
 #endif
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if HAVE_ARPA_INET_H
+#ifdef HAVE_ARPA_INET_H
 #include <arpa/inet.h>
 #endif
-#if HAVE_NETDB_H
+#ifdef HAVE_NETDB_H
 #include <netdb.h>
 #endif
-#if HAVE_SYS_UIO_H
+#ifdef HAVE_SYS_UIO_H
 #include <sys/uio.h>
 #endif
 
-#if HAVE_ARPA_INET_H
+#ifdef HAVE_ARPA_INET_H
 #include <arpa/inet.h>
 #endif
 
diff --git a/snmplib/transports/snmpUDPBaseDomain.c b/snmplib/transports/snmpUDPBaseDomain.c
index 3a9649bd44..ca8f9a5554 100644
--- a/snmplib/transports/snmpUDPBaseDomain.c
+++ b/snmplib/transports/snmpUDPBaseDomain.c
@@ -19,10 +19,10 @@
 #include <stdio.h>
 #include <sys/types.h>
 #include <ctype.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/snmplib/transports/snmpUDPDomain.c b/snmplib/transports/snmpUDPDomain.c
index d0bd4ebcf2..9f88340ea4 100644
--- a/snmplib/transports/snmpUDPDomain.c
+++ b/snmplib/transports/snmpUDPDomain.c
@@ -27,15 +27,15 @@
 #include <ctype.h>
 #include <errno.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #ifdef HAVE_SYS_SOCKET_H
diff --git a/snmplib/transports/snmpUDPIPv4BaseDomain.c b/snmplib/transports/snmpUDPIPv4BaseDomain.c
index 357de74797..1e15a2fef5 100644
--- a/snmplib/transports/snmpUDPIPv4BaseDomain.c
+++ b/snmplib/transports/snmpUDPIPv4BaseDomain.c
@@ -20,10 +20,10 @@
 #include <stdio.h>
 #include <sys/types.h>
 #include <ctype.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
diff --git a/snmplib/transports/snmpUDPIPv6Domain.c b/snmplib/transports/snmpUDPIPv6Domain.c
index c8a1ec0a6e..335fbd5464 100644
--- a/snmplib/transports/snmpUDPIPv6Domain.c
+++ b/snmplib/transports/snmpUDPIPv6Domain.c
@@ -19,16 +19,16 @@
 #include <ctype.h>
 #include <errno.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
 #include <stddef.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #ifdef HAVE_SYS_SOCKET_H
@@ -47,9 +47,9 @@
 #include <net/if.h>
 #endif
 
-#if HAVE_STRUCT_SOCKADDR_STORAGE_SS_FAMILY
+#ifdef HAVE_STRUCT_SOCKADDR_STORAGE_SS_FAMILY
 #define SS_FAMILY ss_family
-#elif HAVE_STRUCT_SOCKADDR_STORAGE___SS_FAMILY
+#elif defined(HAVE_STRUCT_SOCKADDR_STORAGE___SS_FAMILY)
 #define SS_FAMILY __ss_family
 #endif
 
@@ -751,7 +751,7 @@ netsnmp_udp6_parse_security(const char *token, char *param)
                     DEBUGMSGTL(("com2sec6", "IPv4 detected for IPv6 parser. Skipping.\n"));
                     return;
                 }
-#if HAVE_GETADDRINFO
+#ifdef HAVE_GETADDRINFO
                 int             gai_error;
 
                 hints.ai_family = AF_INET6;
@@ -801,7 +801,7 @@ netsnmp_udp6_parse_security(const char *token, char *param)
                     com2Sec6ListLast = end;
                 }
             }
-#if HAVE_GETADDRINFO
+#ifdef HAVE_GETADDRINFO
             if (res != &hints)
                 freeaddrinfo(res);
 #endif
diff --git a/snmplib/transports/snmpUDPsharedDomain.c b/snmplib/transports/snmpUDPsharedDomain.c
index 19526136f1..bc0c9fe3f2 100644
--- a/snmplib/transports/snmpUDPsharedDomain.c
+++ b/snmplib/transports/snmpUDPsharedDomain.c
@@ -16,24 +16,24 @@
 #include <stdio.h>
 #include <sys/types.h>
 #include <ctype.h>
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_SYS_SOCKET_H
+#ifdef HAVE_SYS_SOCKET_H
 #include <sys/socket.h>
 #endif
-#if HAVE_NETINET_IN_H
+#ifdef HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
-#if HAVE_ARPA_INET_H
+#ifdef HAVE_ARPA_INET_H
 #include <arpa/inet.h>
 #endif
-#if HAVE_NETDB_H
+#ifdef HAVE_NETDB_H
 #include <netdb.h>
 #endif
 #include <errno.h>
diff --git a/snmplib/transports/snmpUnixDomain.c b/snmplib/transports/snmpUnixDomain.c
index 6e1b9200c8..fb2f1af39d 100644
--- a/snmplib/transports/snmpUnixDomain.c
+++ b/snmplib/transports/snmpUnixDomain.c
@@ -9,18 +9,18 @@
 #include <ctype.h>
 #include <errno.h>
 
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
-#if HAVE_SYS_SOCKET_H
+#ifdef HAVE_SYS_SOCKET_H
 #include <sys/socket.h>
 #endif
 
diff --git a/snmplib/vacm.c b/snmplib/vacm.c
index 6b245f30ab..77aff500a2 100644
--- a/snmplib/vacm.c
+++ b/snmplib/vacm.c
@@ -22,20 +22,20 @@
 
 #include <net-snmp/net-snmp-config.h>
 
-#if HAVE_STDLIB_H
+#ifdef HAVE_STDLIB_H
 #include <stdlib.h>
 #endif
-#if HAVE_STRING_H
+#ifdef HAVE_STRING_H
 #include <string.h>
 #else
 #include <strings.h>
 #endif
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include <sys/types.h>
 #include <stdio.h>
-#if TIME_WITH_SYS_TIME
+#ifdef TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
 #else
diff --git a/testing/fulltests/snmpv3/T010scapitest_capp.c b/testing/fulltests/snmpv3/T010scapitest_capp.c
index 6ed6f49907..d42ab76716 100644
--- a/testing/fulltests/snmpv3/T010scapitest_capp.c
+++ b/testing/fulltests/snmpv3/T010scapitest_capp.c
@@ -43,7 +43,7 @@
 #include <net-snmp/library/getopt.h>
 
 #include <stdlib.h>
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/testing/fulltests/snmpv3/T040keymanagetest_capp.c b/testing/fulltests/snmpv3/T040keymanagetest_capp.c
index 15b9cf91c6..5bf64e3cde 100644
--- a/testing/fulltests/snmpv3/T040keymanagetest_capp.c
+++ b/testing/fulltests/snmpv3/T040keymanagetest_capp.c
@@ -31,7 +31,7 @@
 #include <netinet/in.h>
 #endif
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 #include <ctype.h>
diff --git a/testing/fulltests/snmpv3/T050etimetest_capp.c b/testing/fulltests/snmpv3/T050etimetest_capp.c
index 68806ba0cb..5258232dca 100644
--- a/testing/fulltests/snmpv3/T050etimetest_capp.c
+++ b/testing/fulltests/snmpv3/T050etimetest_capp.c
@@ -29,7 +29,7 @@
 #include <netinet/in.h>
 #endif
 
-#if HAVE_UNISTD_H
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
 #endif
 
diff --git a/win32/mib_module_includes.h b/win32/mib_module_includes.h
index 31f87c62d7..f4d3c1d736 100644
--- a/win32/mib_module_includes.h
+++ b/win32/mib_module_includes.h
@@ -79,7 +79,7 @@
 #include "mibgroup/ucd-snmp/proxy.h"
 #endif
 
-#if HAVE_REGEX_H
+#ifdef HAVE_REGEX_H
 #include "mibgroup/ucd-snmp/logmatch.h"
 #endif
 
diff --git a/win32/net-snmp/agent/mib_module_config.h b/win32/net-snmp/agent/mib_module_config.h
index 28f7ba7a79..2f2e97a1ad 100644
--- a/win32/net-snmp/agent/mib_module_config.h
+++ b/win32/net-snmp/agent/mib_module_config.h
@@ -160,7 +160,7 @@
 #endif /* USING_UCD_SNMP_MODULE */
 
  
-#if HAVE_REGEX_H
+#ifdef HAVE_REGEX_H
 /* Define if compiling with the ucd-snmp/logmatch module files.  */
 #define USING_UCD_SNMP_LOGMATCH_MODULE 1
 #endif
diff --git a/win32/net-snmp/net-snmp-config.h b/win32/net-snmp/net-snmp-config.h
index d8fcf2e745..1a0c5adbef 100644
--- a/win32/net-snmp/net-snmp-config.h
+++ b/win32/net-snmp/net-snmp-config.h
@@ -1845,7 +1845,7 @@ enum {
 #define NETSNMP_CAN_USE_NLIST
 #endif
 
-#if HAVE_DMALLOC_H
+#ifdef HAVE_DMALLOC_H
 #define DMALLOC_FUNC_CHECK
 #endif
 
diff --git a/win32/net-snmp/net-snmp-config.h.in b/win32/net-snmp/net-snmp-config.h.in
index 0d35cfd6f0..b9f02a7030 100644
--- a/win32/net-snmp/net-snmp-config.h.in
+++ b/win32/net-snmp/net-snmp-config.h.in
@@ -1845,7 +1845,7 @@ enum {
 #define NETSNMP_CAN_USE_NLIST
 #endif
 
-#if HAVE_DMALLOC_H
+#ifdef HAVE_DMALLOC_H
 #define DMALLOC_FUNC_CHECK
 #endif
 
